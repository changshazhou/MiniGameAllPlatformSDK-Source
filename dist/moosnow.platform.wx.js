!function(){"use strict";var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)};function t(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}var s=function(){return(s=Object.assign||function(t){for(var e,o=1,n=arguments.length;o<n;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function c(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<o;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,i++)n[i]=r[a];return n}var i,e,r=(o.randomNumBoth=function(t,e){var o=e-t,n=Math.random();return t+Math.round(n*o)},o.probabilitys=function(t){for(var e=0,o=c(t),n=0,i=0;i<o.length;i++)n+=o[i];if(100!=n)throw"所有概率值总和不等于100%";for(var r=new Array,i=0;i<o.length;i++){for(var a=o[i],s=0;s<a;s++)r.push(e);e++}return r[this.randomNumBoth(0,99)]},o);function o(){}(e=i=i||{})[e.WX=0]="WX",e[e.BYTEDANCE=1]="BYTEDANCE",e[e.OPPO=2]="OPPO",e[e.OPPO_ZS=3]="OPPO_ZS",e[e.BAIDU=4]="BAIDU",e[e.QQ=5]="QQ",e[e.PC=6]="PC",e[e.VIVO=7]="VIVO";var a="cc",l="Laya",h="",p=(u.titleCase=function(t){for(var e=t.toLowerCase().split(/\s+/),o=0;o<e.length;o++)e[o]=e[o].slice(0,1).toUpperCase()+e[o].slice(1);return e.join(" ")},u.numFixed=function(t,e){return parseFloat(parseFloat(t).toFixed(e))},u.parseMoney=function(t){return isNaN(t)?0:parseFloat(parseFloat(t).toFixed(2))},u.objKeySort=function(t){for(var e=Object.keys(t).sort(),o={},n=0;n<e.length;n++)o[e[n]]=t[e[n]];return o},u.isObject=function(t){var e=typeof t;return null!==t&&("object"==e||"function"==e)},u.object2Query=function(t){var e=[];for(var o in t)e.push(o+"="+t[o]);return e.join("&")},u.isFunction=function(t){return"function"==typeof t},u.isEmpty=function(t){if("object"!=typeof t)return null==t||"null"===t||"undefined"===t||""===t;var e;for(e in t)return!1;return!0},u.formatTime=function(t){return[t.getHours(),t.getMinutes()].map(this.formatNumber).join(":")},u.formatNumber=function(t){return(t=t.toString())[1]?t:"0"+t},u.copy=function(t,e){for(var o in t)e[o]=t[o]},u.randomNumBoth=function(t,e){var o=e-t,n=Math.random();return t+Math.round(n*o)},u.randomFloat=function(t,e){return t+Math.random()*e},u.randomToRatio=function(t,e,o){return this.randomNumBoth(t,e)<=o},u.generateUUID=function(){var o=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"==t?e:3&e|8).toString(16)})},u.isNumber=function(t){return"number"==typeof t||"[object Number]"==Object.prototype.toString.call(t)},u.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},u.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},Object.defineProperty(u,"platform",{get:function(){if(this.mPlatform)return this.mPlatform;var t,e=window.moosnowConfig;return window.tt?this.mPlatform=i.BYTEDANCE:window.swan?this.mPlatform=i.BAIDU:window.qq?this.mPlatform=i.QQ:window.qg?window.qg&&window.qg.getSystemInfoSync?(t=window.qg.getSystemInfoSync(),console.log("平台判断",JSON.stringify(t)),t&&t.brand&&-1!=t.brand.toLocaleLowerCase().indexOf("vivo")?this.mPlatform=i.VIVO:-1!=e.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=i.OPPO_ZS:this.mPlatform=i.OPPO):-1!=e.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=i.OPPO_ZS:this.mPlatform=i.OPPO:window.wx?this.mPlatform=i.WX:e.debug&&e[e.debug]?"wx"==e.debug?this.mPlatform=i.WX:"oppo"==e.debug?-1!=e.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=i.OPPO_ZS:this.mPlatform=i.OPPO:"bd"==e.debug?this.mPlatform=i.BAIDU:"byte"==e.debug?this.mPlatform=i.BYTEDANCE:"qq"==e.debug?this.mPlatform=i.QQ:"vivo"==e.debug?this.mPlatform=i.VIVO:this.mPlatform=i.PC:this.mPlatform=i.PC,this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(u,"config",{get:function(){var t=window.moosnowConfig,e=u.platform==i.WX?t.wx:u.platform==i.OPPO||u.platform==i.OPPO_ZS?t.oppo:u.platform==i.VIVO?t.vivo:u.platform==i.QQ?t.qq:u.platform==i.BAIDU?t.bd:u.platform==i.BYTEDANCE?t.byte:t.wx;return e},enumerable:!0,configurable:!0}),u.colorRGB2Hex=function(t){var e=t.split(",");return"#"+((1<<24)+(parseInt(e[0].split("(")[1])<<16)+(parseInt(e[1])<<8)+parseInt(e[2].split(")")[0])).toString(16).slice(1)},u.deepCopy=function(t){var e=Array.isArray(t)?[]:{};if(t&&"object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(t[o]&&"object"==typeof t[o]?e[o]=this.deepCopy(t[o]):e[o]=t[o]);return e},u.getEngine=function(){return window[a]?a:window[l]?l:h},u.popOpenAnim=function(t,e){if(this.getEngine()==a)return t.scale=.8,void t.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1),cc.callFunc(function(){e&&e()},this)));e()},u.popCloseAnim=function(t,e){if(this.getEngine()==a)return t.scale=1,void t.runAction(cc.sequence(cc.scaleTo(.1,0,0),cc.callFunc(function(){e&&e()},this)));e()},u.format=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];if(void 0===t||null==t||""==t||"undefined"==t)return t;for(var n=0;n<e.length;n++){var i=new RegExp("\\{"+n+"\\}","gm");t=t.replace(i,e[n])}return t},u.formatMoney=function(t){return isNaN(t)&&(t=0),t<9999?parseInt(""+t):t<9999999?parseFloat(""+t/1e3).toFixed(2)+"K":t<9999999999?parseFloat(""+t/1e6).toFixed(2)+"M":t<9999999999999?parseFloat(""+t/1e9).toFixed(2)+"G":t<1e16?parseFloat(""+t/1e12).toFixed(2)+"T":t<1e19?parseFloat(""+t/1e15).toFixed(2)+"P":t<1e22?parseFloat(""+t/1e18).toFixed(2)+"E":parseFloat(""+t/1e21).toFixed(2)+"B"},u);function u(){}var f=(m.prototype.schedule=function(t,e){var o=this,n=setInterval(function(){t&&t.apply(o)},1e3*e);console.log("BaseModule schedule ",n),this.mIntervalArr[n]=t},m.prototype.unschedule=function(t){for(var e in this.mIntervalArr)this.mIntervalArr[e]!==t&&!p.isEmpty(this.mIntervalArr[e])||clearInterval(parseInt(e))},m.prototype.scheduleOnce=function(t,e){var o=this,n=setTimeout(function(){clearTimeout(n),t&&t.apply(o)},1e3*e);this.mTimeoutArr[n]=t},m.prototype.unscheduleOnce=function(t){for(var e in this.mTimeoutArr)this.mTimeoutArr[e]!==t&&!p.isEmpty(this.mTimeoutArr[e])||clearTimeout(parseInt(e))},m.prototype.initProperty=function(t){for(var e in t)this.hasOwnProperty(e)&&(this[e]=t[e])},m.prototype.preload=function(t,e){e&&e()},m.prototype._findComponent=function(t,e){for(var o=null,n=0;n<t._components.length;n++){var i=t._components[n];if(i.willHide&&i.willShow){o=i;break}}return o},m.prototype._findComponentByName=function(t,e){return!!t&&(t.name==e||this._findComponentByName(t.$super,e))},m);function m(){this.moduleName="",this.mIntervalArr={},this.mTimeoutArr={}}var d={TOP:"__banner_top",CENTER:"__banner_center",BOTTOM:"__banner_bottom",CUSTOM:"__banner_custom"},g={END:"__video_end",NOTEND:"__video_not_end",ERR:"__video_error"},w=(y.VIBRATESWITCH_CHANGED="VIBRATESWITCH_CHANGED",y.SOUNDSWITCH_CHANGED="SOUNDSWITCH_CHANGED",y.MUSICSWITCH_CHANGED="MUSICSWITCH_CHANGED",y.ON_PLATFORM_SHOW="ON_PLATFORM_SHOW",y.ON_PLATFORM_HIDE="ON_PLATFORM_HIDE",y.ON_BANNER_ERROR="ON_BANNER_ERROR",y.ON_BANNER_HIDE="ON_BANNER_HIDE",y.ON_AD_SHOW="ON_AD_SHOW",y.AD_VIEW_CHANGE="AD_VIEW_CHANGE",y.AD_VIEW_REFRESH="AD_VIEW_REFRESH",y.COIN_CHANGED="COIN_CHANGED",y.RANDOWM_NAVIGATE="RANDOWM_NAVIGATE",y.COMPONENT_CHECKBOX_TOGGLE="COMPONENT_CHECKBOX_TOGGLE",y.PRIZE_BOX_UNLOCAK="PRIZE_BOX_UNLOCAK",y);function y(){}var v,b="隐藏banner",I="banner id 没有配置",N="显示BANNER",_="banner位置或大小被重新设置",S="跳转太频繁 >>>>>>>>>>>>>>>>>>>>>",C="跳转数据",E="设备信息",O="video id 没有配置",A="加载video成功回调",T="video关闭回调",x="video加载错误",P="插屏广告ID为空，系统不加载",B="阿拉丁文件未引入",L=(t(R,v=f),Object.defineProperty(R.prototype,"bannerId",{get:function(){var t=p.config.bannerId;if(t instanceof Array){this.mBannerIndex>t.length-1&&(this.mBannerIndex=0);var e=t[this.mBannerIndex];return this.mBannerIndex++,console.log("使用banner id ",e),e}return t},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"videoId",{get:function(){var t=p.config.videoId;if(t instanceof Array){this.mBannerIndex>t.length-1&&(this.mBannerIndex=0);var e=t[this.mBannerIndex];return this.mBannerIndex++,console.log("使用 video id ",e),e}return t},enumerable:!0,configurable:!0}),R.prototype.onEnable=function(){},R.prototype.vibrateSwitch=function(t){this.vibrateOn=t},R.prototype.initAppConfig=function(){this.moosnowConfig=p.config,this.interId=this.moosnowConfig.interId,this.boxId=this.moosnowConfig.boxId,this.nativeId=this.moosnowConfig.nativeId,console.log("moosnowConfig ",JSON.stringify(this.moosnowConfig))},R.prototype.isIphoneXModel=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone x/.test(t.model.toLowerCase())}},R.prototype.isIphone=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone/.test(t.model.toLowerCase())}},R.prototype.isIphoneX=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),e=t.screenHeight,o=t.screenWidth/e;return o<=.5||2<=o}},R.prototype.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var o=Math.max(t.length,e.length);t.length<o;)t.push("0");for(;e.length<o;)e.push("0");for(var n=0;n<o;n++){var i=parseInt(t[n]),r=parseInt(e[n]);if(r<i)return 1;if(i<r)return-1}return 0},R.prototype.supportVersion=function(t){var e=this.getSystemInfoSync().SDKVersion;return 0<=this.compareVersion(e,t)},R.prototype.supportFunction=function(t){return!!window[this.platformName]&&!!window[this.platformName][t]},R.prototype.checkVersion=function(t,e){null==this.versionRet?this._checkConfigVersion(e):e(this.versionRet)},R.prototype._checkRemoteVersion=function(e){var o=this,t=this.baseUrl+"admin/wx_list/getAppConfig",n={appid:this.moosnowConfig.moosnowAppId};moosnow.http.request(t,n,"POST",function(t){o.versionRet=o.checkLog(t.data.version),e(o.versionRet)},function(){console.log("checkVersion fail")},function(){console.log("checkVersion complete")})},R.prototype._checkConfigVersion=function(e){var o=this;moosnow.http.getAllConfig(function(t){t&&t.version?(o.versionRet=o.checkLog(t.version),e(o.versionRet)):o._checkRemoteVersion(e)})},R.prototype.checkLog=function(t){var e=moosnow.platform.moosnowConfig.version,o=t==e;return console.log("版本检查 后台版本"+t+" 配置文件版本"+e),console.log("获取广告开关：",o),o},R.prototype.isSmallWidth=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),e=t.screenHeight;return t.screenWidth,e<667&&(console.log("高度不够",e),!0)}},R.prototype.login=function(t,e){var o;p.isFunction(t)&&((o=moosnow.data.getToken())||(o=(o=p.generateUUID()).replace(/-/g,""),moosnow.data.setToken(o)),t(o))},R.prototype.postMessage=function(t){window[this.platformName]&&window[this.platformName].getOpenDataContext&&window[this.platformName].getOpenDataContext().postMessage(t)},R.prototype.navigate2Mini=function(e,o,n,i){var r,a,s,c=this;console.log(C,e),Date.now()-this.prevNavigate<300?console.log(S):(this.prevNavigate=Date.now(),window[this.platformName]?(r=e.appid,a=e.path,s=(s=e.extraData)||{},moosnow.http.navigate(r,function(t){window[c.platformName].navigateToMiniProgram({appId:r,path:a,extraData:s,success:function(){moosnow.http.point("跳转",{position:e.position,appid:r,img:e.atlas||e.img}),moosnow.http.navigateEnd(t.code),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMini fail ",t," fail callback ",!!n),n&&n()},complete:function(){i&&i()}})})):n&&n())},R.prototype.updateProgram=function(){var e,o=this;window[this.platformName]&&"function"==typeof window[this.platformName].getUpdateManager&&((e=window[this.platformName].getUpdateManager()).onCheckForUpdate(function(t){}),e.onUpdateReady(function(t){o.showModal("发现新版本","新版本已经准备好，是否更新？","取消","更新",function(t){t&&e.applyUpdate()})}),e.onUpdateFailed(function(){}))},R.prototype.vibrateShort=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateShort||window[this.platformName].vibrateShort())},R.prototype.vibrateLong=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateLong||window[this.platformName].vibrateLong())},R.prototype.showLoading=function(t){window[this.platformName]?window[this.platformName].showLoading({title:t,mask:!1,success:null,fail:null,complete:null}):console.log("showLoading",t)},R.prototype.hideLoading=function(){window[this.platformName]&&window[this.platformName].hideLoading()},R.prototype.showModal=function(t,e,o,n,i){window[this.platformName]&&window[this.platformName].showModal({title:t,content:e,cancelText:o,confirmText:n,showCancel:!0,cancelColor:"#000000",confirmColor:"#3CC51F",fail:null,complete:null,success:function(t){t.confirm?i&&i(!0):t.cancel&&i&&i(!1)}})},R.prototype.showModalWithoutCancel=function(t,e,o,n){window[this.platformName]&&window[this.platformName].showModal({title:t,content:e,showCancel:!1,confirmText:o,cancelColor:"#000000",confirmColor:"#3CC51F",cancelText:"",fail:null,complete:null,success:function(t){t.confirm?n&&n(!0):t.cancel&&n&&n(!1)}})},R.prototype.showToast=function(t,e,o){void 0===e&&(e="none"),void 0===o&&(o=!1),window[this.platformName]&&window[this.platformName].showToast({title:t,icon:e,duration:2e3,mask:o,image:null,success:null,fail:null,complete:null})},R.prototype.authOrGetUserInfo=function(e){var o;window[this.platformName]&&(o=this).getSetting(function(t){console.log("授权信息",t),t["scope.userInfo"]?o.getUserInfo(function(t){console.log("获取用户信息：",t),e(t,!1)},function(t){}):o.showUserInfoButton(function(t){e(t,!0),console.log("授权获取用户信息：",t)})},function(t){o.showUserInfoButton(function(t){e(t,!0),console.log("授权获取用户信息：",t)})})},R.prototype.showUserInfoButton=function(e){var t={type:"text",text:"",style:this._initLoginButton()},o=window[this.platformName].createUserInfoButton(t);o.onTap(function(t){t.userInfo&&t.userInfo.nickName?(e(t.userInfo),o.hide()):e(null)}),o.show()},R.prototype.getSetting=function(e,t){window[this.platformName].getSetting({success:function(t){e(t.authSetting)},fail:function(){t()},complete:null})},R.prototype.getUserInfo=function(e,t){window[this.platformName].getUserInfo({success:function(t){e(t.userInfo)},fail:function(){t()},withCredentials:!1,complete:null,lang:"en"})},R.prototype.getLaunchOption=function(){return window[this.platformName]&&window[this.platformName].getLaunchOptionsSync?window[this.platformName].getLaunchOptionsSync():{}},R.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log(E,this.systemInfo)),this.systemInfo},R.prototype.isLandscape=function(t,e){return t<e},R.prototype.initShare=function(t){var e=this;window[this.platformName]&&window[this.platformName].showShareMenu&&(this.shareInfoArr=t,window[this.platformName].showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"],success:null,fail:null,complete:null}),window[this.platformName].onShareAppMessage&&window[this.platformName].onShareAppMessage(function(){return e._buildShareInfo()}),window[this.platformName].onShareTimeline&&window[this.platformName].onShareTimeline(function(){return e._buildShareInfo()}))},R.prototype.getShareInfo=function(t,e,o){void 0===o&&(o=null),window[this.platformName]&&window[this.platformName].getShareInfo({shareTicket:t,success:function(t){e(t.encryptedData,t.iv)},fail:function(){o&&o()},complete:null})},R.prototype.share=function(t,e,o){void 0===t&&(t={}),window[this.platformName]?(this.currentShareCallback=e,this.currentShortCall=o,this.share_clickTime=Date.now(),this.shareFail=!1,this._share(t)):e&&e(!0)},R.prototype.shareWithoutCheck=function(t,e){void 0===t&&(t={}),window[this.platformName]||e&&e(!0),this.currentShareCallback=e,this.share_clickTime=1,this.shareFail=!1,this._share(t)},R.prototype._share=function(t){var e;void 0===t&&(t=null),window[this.platformName]&&window[this.platformName].shareAppMessage?(e=this._buildShareInfo(t),console.log("分享数据：",e),window[this.platformName].shareAppMessage(e)):this.currentShareCallback(!0)},R.prototype._buildShareInfo=function(t){void 0===t&&(t=null);var e,o="",n="";return 0<this.shareInfoArr.length&&(o=(e=this.shareInfoArr[r.randomNumBoth(0,this.shareInfoArr.length-1)]).title,n=e.img),{title:o,imageUrl:n,query:t}},R.prototype._onShareback=function(){var t=this;setTimeout(function(){t.share_clickTime&&t.currentShareCallback&&(!t.shareFail&&(1==t.share_clickTime||3e3<=Date.now()-t.share_clickTime)?t.currentShareCallback(!0):t.currentShareCallback(!1)),t.shareFail=!1,t.currentShareCallback=null,t.share_clickTime=null},100)},R.prototype._initLoginButton=function(){if(window[this.platformName]){var t=window[this.platformName].getSystemInfoSync();return{left:0,top:0,width:t.screenWidth,height:t.screenHeight,lineHeight:40,color:"#ffffff",type:"text",text:"获取用户信息",textAlign:"center",fontSize:28}}},R.prototype.initRecord=function(){},R.prototype.clipRecord=function(){},R.prototype.startRecord=function(t,e){void 0===t&&(t=300),void 0===e&&(e=null),this.recordObj||e&&e(!1)},R.prototype.stopRecord=function(t){void 0===t&&(t=null),this.recordObj||t&&t(!1)},R.prototype.pauseRecord=function(){},R.prototype.resumeRecord=function(){},R.prototype.showShareButton=function(t,e,o){},R.prototype.hideShareButton=function(){},R.prototype._regisiterWXCallback=function(){window[this.platformName]&&(this._regisiterOnShow(),this._regisiterOnHide())},R.prototype._regisiterOnShow=function(){var e;window[this.platformName].onShow&&window[(e=this).platformName].onShow(function(t){e._onShowCallback(t)})},R.prototype._onShowCallback=function(t){this._onShareback(),console.log("on show ",t),moosnow.event.sendEventImmediately(w.ON_PLATFORM_SHOW,t)},R.prototype._regisiterOnHide=function(){var e;window[this.platformName].onHide&&window[(e=this).platformName].onHide(function(t){e._onHideCallback(t)})},R.prototype._onHideCallback=function(t){console.log("on show ",t),moosnow.event.sendEventImmediately(w.ON_PLATFORM_HIDE,t),console.log("on hide ",t);var e=t&&(8==t.targetAction||9==t.targetAction||10==t.targetAction)&&50<t.targetPagePath.length;e&&moosnow.http.clickBanner(),this.bannerCb?this.bannerCb(e):console.log("banner callback is null ")},R.prototype.initBanner=function(){window[this.platformName]&&this._prepareBanner()},R.prototype._prepareBanner=function(){var t,e;window[this.platformName].createBannerAd&&(e=(t=this.getSystemInfoSync()).windowWidth,t.windowHeight<t.windowWidth&&!(e<this.bannerWidth)||(this.bannerWidth=e),this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.destroy(),this.banner=null),this.banner=this._createBannerAd(),this.banner&&(this.banner.onResize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this))))},R.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),e=t.windowWidth,o=t.windowHeight,n=(e-this.bannerWidth)/2,i=this.bannerId;if(!p.isEmpty(i))return this.bannerShowTime=Date.now(),window[this.platformName].createBannerAd({adUnitId:i,style:{top:o-this.bannerHeigth,left:n,width:this.bannerWidth}});console.warn(I)}},R.prototype._onBannerLoad=function(){this.bannerShowCount=0},R.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode,t.errMsg),this.banner=null,this.isBannerShow=!1,moosnow.event.sendEventImmediately(w.ON_BANNER_HIDE,null),moosnow.event.sendEventImmediately(w.ON_BANNER_ERROR,null)},R.prototype._bottomCenterBanner=function(t){var e=this.getSystemInfoSync().windowWidth;this.banner.style.left=(e-t.width)/2,this.bannerWidth=this.banner.style.realWidth,this.bannerHeigth=this.banner.style.realHeight,console.log("_bottomCenterBanner",this.banner.style)},R.prototype._resetBanenrStyle=function(t){var e,o,n;p.isEmpty(t)?console.log("设置的banner尺寸为空,不做调整"):((e=this.getSystemInfoSync()).windowWidth,o=e.windowHeight,n=0,this.bannerPosition==d.BOTTOM?n=o-this.bannerHeigth:this.bannerPosition==d.CENTER?n=(o-this.bannerHeigth)/2:this.bannerPosition==d.TOP&&(n=0),this.bannerStyle?this.banner.style=this.bannerStyle:(this.banner.style.top=n,console.log(_,this.banner.style,"set top ",n)))},R.prototype.showBanner=function(t,e,o,n){var i=this;void 0===t&&(t=!0),void 0===o&&(o=d.BOTTOM),console.log(N),this.bannerCb=e,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=n,this.mTimeoutId&&(clearTimeout(this.mTimeoutId),this.mTimeoutId=null),t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),i._showBanner()):console.log("后台关闭了banner，不执行显示")}):this._showBanner())},R.prototype._showBanner=function(){var t,e=this;this.banner&&(console.log("show banner style ",this.banner.style),this.banner.hide(),(t=this.banner.show())&&t.then(function(){e._resetBanenrStyle({width:e.banner.style.width,height:e.banner.style.realHeight})}))},R.prototype.showAutoBanner=function(o){var n=this;void 0===o&&(o=!0),console.log("执行自动显示和隐藏Banner功能"),moosnow.http.getAllConfig(function(t){var e;t&&1==t.gameBanner&&(moosnow.platform.showBanner(o),e=isNaN(t.gameBanenrHideTime)?1:parseFloat(t.gameBanenrHideTime),n.mTimeoutId=setTimeout(function(){console.log("自动隐藏时间已到，开始隐藏Banner"),n.isBannerShow,n.hideBanner()},1e3*e))})},R.prototype.exitApplication=function(){},R.prototype.showIntervalBanner=function(){var o=this;console.log("执行 showIntervalBanner"),moosnow.http.getAllConfig(function(t){var e=t&&!isNaN(t.gameBannerInterval)?parseFloat(t.gameBannerInterval):20;o.schedule(o.showAutoBanner,e)})},R.prototype.clearIntervalBanner=function(){console.log("执行 clearIntervalBanner"),this.unschedule(this.showAutoBanner)},R.prototype.hideBanner=function(){console.log(b),this.isBannerShow&&(this.isBannerShow=!1,window[this.platformName]&&(this.bannerShowCount++,this.banner?0==this.bannerLimitType?this.bannerShowCount>=this.bannerShowCountLimit?(console.log("次数满足,销毁banner"),this.banner.hide(),this.banner.destroy(),this.banner=null,this._prepareBanner()):this.banner.hide():Date.now()-this.bannerShowTime>1e3*this.bannerShowTimeLimit?(console.log("时间满足，销毁banner"),this.banner.hide(),this.banner.destroy(),this.banner=null,this._prepareBanner()):(console.log("时间太短，隐藏banner"),this.banner.hide()):this._prepareBanner()))},R.prototype.initVideo=function(){this.createRewardAD(!1)},R.prototype.createRewardAD=function(t){var e=this;if(!moosnow.platform.videoLoading)if(window[this.platformName])if(window[this.platformName].createRewardedVideoAd){var o=this.videoId;if(p.isEmpty(o))return console.warn(O),void moosnow.platform.videoCb(g.END);if(!this.video){if(this.video=window[this.platformName].createRewardedVideoAd({adUnitId:o}),!this.video)return void console.warn("创建视频广告失败");this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad)}moosnow.platform.videoLoading=!0,moosnow.platform.videoPlaying=!1,this.video.load().then(function(){t&&e.video.show().then(function(){}).catch(function(t){e._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}).catch(function(t){e._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}else moosnow.platform.videoCb(g.END);else moosnow.platform.videoCb(g.END)},R.prototype._onVideoError=function(t,e){console.log(x,t,e),moosnow.platform.videoLoading=!1,moosnow.platform.videoPlaying=!1,moosnow.platform.videoCb&&(moosnow.platform.videoCb(g.ERR),moosnow.platform.videoCb=null)},R.prototype._onVideoClose=function(t){var e;console.log(T,t.isEnded),moosnow.platform.videoLoading=!1,moosnow.platform.videoPlaying=!1,t.isEnded&&moosnow.http.clickVideo(),moosnow.platform.videoCb&&(e=t.isEnded?g.END:g.NOTEND,setTimeout(function(){moosnow.platform.videoCb(e)},50))},R.prototype._onVideoLoad=function(){console.log(A),moosnow.platform.videoLoading=!1},R.prototype.showVideo=function(t){void 0===t&&(t=null),console.log("显示video"),moosnow.platform.videoCb=t,this.createRewardAD(!0)},R.prototype.initInter=function(){this.prepareInter()},R.prototype.prepareInter=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createInterstitialAd&&this.supportVersion("2.8.0")&&(p.isEmpty(this.interId)?console.warn(P):(this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this))))},R.prototype.showInter=function(){this.inter&&this.isInterLoaded&&this.inter.show()},R.prototype._onInterLoad=function(){this.interShowCount=0,this.isInterLoaded=!0,console.log("插屏广告加载完成")},R.prototype._onInterClose=function(){this.interShowCount++,this.interShowCount>=this.interShowCountLimit&&(this.isInterLoaded=!1,this.inter.load())},R.prototype._onInterError=function(t){console.log("插屏广告出错：",t)},R.prototype._prepareNative=function(){},R.prototype._onNativeLoad=function(t){},R.prototype._onNativeError=function(t){},R.prototype._destroyNative=function(){},R.prototype.showNativeAd=function(t){p.isFunction(t)&&t()},R.prototype.clickNative=function(t){},R.prototype.showAppBox=function(t,e){void 0===e&&(e=!0),p.isFunction(t)&&t()},R.prototype.hideAppBox=function(t){p.isFunction(t)&&t()},R.prototype.reportMonitor=function(t,e){},R.prototype.showMoreGameButton=function(t,e,o){void 0===o&&(o=null),e&&e()},R.prototype.initRank=function(){this.postMessage({action:1})},R.prototype.showRank=function(){this.postMessage({action:10})},R.prototype.updateUserScore=function(t){var e={action:13,data:t};this.postMessage(e)},R.prototype.hideRank=function(){this.postMessage({action:20})},R.prototype.checkFollowAwemeSate=function(t,e){t&&t(!0)},R.prototype.openAwemeUserProile=function(t,e){t&&t(!0)},R.prototype.hasShortcutInstalled=function(t){t(!1)},R.prototype.installShortcut=function(t,e){void 0===e&&(e="方便下次快速启动")},R.prototype.onDisable=function(){},R);function R(){var t=v.call(this)||this;return t.baseUrl="https://api.liteplay.com.cn/",t.currentShareCallback=null,t.currentShortCall=null,t.shareFail=null,t.vibrateOn=!1,t.systemInfo=null,t.banner=null,t.video=null,t.inter=null,t.native=null,t.box=null,t.platformName="wx",t.mBannerId="",t.mBannerIndex=0,t.mVideoIndex=0,t.interId="",t.boxId="",t.nativeId=[],t.nativeIdIndex=0,t.bannerWidth=300,t.bannerHeigth=96,t.bannerShowCount=0,t.bannerShowCountLimit=3,t.bannerShowTime=0,t.bannerShowTimeLimit=15,t.bannerLimitType=0,t.bannerCb=null,t.bannerPosition=d.BOTTOM,t.bannerStyle=null,t.isBannerShow=!1,t.videoCb=null,t.videoLoading=!1,t.videoPlaying=!1,t.interShowCount=0,t.interShowCountLimit=3,t.isInterLoaded=!1,t.nativeAdResult=null,t.nativeCb=null,t.nativeLoading=!1,t.recordObj=null,t.shareInfoArr=[],t.versionRet=null,t.prevNavigate=Date.now(),t.initAppConfig(),t.initShare(!0),t.share_clickTime=null,t.currentShareCallback=null,t.shareFail=!1,t.updateProgram(),t.initRecord(),t}var D,k=(t(M,D=L),M.prototype.login=function(e,t){moosnow.http.getAllConfig(function(t){});var o=this,n=moosnow.data.getToken();n?o.getUserToken("",n,e):window[this.platformName]&&window[this.platformName].login?window[this.platformName].login({success:function(t){t.code?o.getUserToken(t.code,"",e):p.isFunction(e)&&e()},fail:function(){}}):D.prototype.login.call(this,e,t)},M.prototype.getUserToken=function(t,e,o){var n=this.getLaunchOption(),i=n.scene,r=n.query&&n.query.channel_id?n.query.channel_id:"0",a=n.referrerInfo&&n.referrerInfo.appId?n.referrerInfo.appId:"0";moosnow.data.setChannelAppId(a),moosnow.data.setChannelId(r);var s=n.referrerInfo?n.referrerInfo.appId:"未知";window[this.platformName]&&window[this.platformName].aldSendEvent&&window[this.platformName].aldSendEvent("来源",{origin:s,path:n.query.from||0}),moosnow.http.request(this.baseUrl+"api/channel/login.html",{appid:p.config.moosnowAppId,code:t,user_id:e,channel_id:r,channel_appid:a,scene:i,fromApp:s},"POST",function(t){0==t.code&&t.data&&t.data.user_id&&moosnow.data.setToken(t.data.user_id),p.isFunction(o)&&o(t)},function(){p.isFunction(o)&&o({})})},M.prototype.initRecord=function(){window[this.platformName]&&window[this.platformName].getGameRecorder&&(this.recordObj=window[this.platformName].getGameRecorder())},M.prototype.startRecord=function(t,e){var o=this;void 0===t&&(t=300),void 0===e&&(e=null),console.log("record startRecord"),this.recordObj?this.recordObj.start().then(function(t){o.recordObj.on("timeUpdate",function(t){console.log("视频时长: "+t.currentTime),o.writeTime=Math.min(t.currentTime,6e4)}),o.recordObj.on("start",function(){e&&e()}),o.recordObj.on("stop",function(t){console.log("对局回放时长: ",t),o.recordCb(t)})}):e&&e(!1)},M.prototype.stopRecord=function(t){var e,o=this;void 0===t&&(t=null),console.log(" stop Record  callback  ",!!t),this.recordObj?(this.recordCb=t,(e=this.recordObj.stop())&&e.then(function(t){t.error.code||o.recordObj.off("timeUpdate"),console.log(" stop Record  then  ",t)}).catch(function(t){console.log(" stop Record  catch  ",t)})):t&&t(!1)},M.prototype.pauseRecord=function(){this.recordObj&&this.recordObj.pause()},M.prototype.resumeRecord=function(){this.recordObj&&this.recordObj.resume()},M.prototype.showShareButton=function(e,o,n){var i=this;window[this.platformName]&&window[this.platformName].createGameRecorderShareButton&&(o=o||[[0,this.writeTime]],moosnow.http.getAllConfig(function(t){i.mShareButton=window[i.platformName].createGameRecorderShareButton({style:s(s({left:10,top:150,height:50},e),{color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,iconMarginRight:16,paddingLeft:1,paddingRight:30}),text:t.shareButtonText||"",image:t.shareBgImage||"",icon:t.shareIconImage||"",share:{query:"a=1&b=2",bgm:"",timeRange:o}}),i.mShareButton.show(),i.mShareButton.onTap(function(t){console.log("错误码："+t.error.code+"，错误信息："+t.error.message),n&&n(t)})}))},M.prototype.hideShareButton=function(){this.mShareButton&&this.mShareButton.hide()},M);function M(){var t=D.call(this)||this;return t.platformName="wx",t.writeTime=0,t.recordCb=null,t._regisiterWXCallback(),t.initBanner(),t.initInter(),t}var F,V="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com",H=(t(U,F=f),Object.defineProperty(U.prototype,"appLaunchOptions",{get:function(){return this.mLaunchOptions||moosnow.platform&&moosnow.platform.getLaunchOption&&(this.mLaunchOptions=moosnow.platform.getLaunchOption()),this.mLaunchOptions},enumerable:!0,configurable:!0}),U.prototype.request=function(t,e,o,n,i,r){var a=t,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState){var e=s.responseText;if(200<=s.status&&s.status<400){var t={};try{t=JSON.parse(e)}catch(t){console.error("json parse error ",e),i&&i(t)}n&&n(t)}else console.warn("error ",e),i&&i(e)}},s.timeout=1e4,s.ontimeout=function(t){console.error("error ",t),i&&i(t)},"POST"==o?(s.open("POST",a),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(this._object2Query(e))):(s.open(o,a,!0),s.send())},U.prototype._object2Query=function(t){var e=[];for(var o in t)e.push(o+"="+t[o]);return e.join("&")},U.prototype.isDisableArea=function(t){},U.prototype.finishLoading=function(){this.postData("api/channel/validUser.html")},U.prototype.clickBanner=function(){this.postData("api/channel/clickBanner.html")},U.prototype.clickVideo=function(){this.postData("api/channel/clickVideo.html")},U.prototype.exportUser=function(){this.postData("api/channel/exportUser.html")},U.prototype.navigate=function(t,e){var o=moosnow.data.getToken();this.request(this.baseUrl+"api/jump/record",{appid:p.config.moosnowAppId,uid:o,jump_appid:t},"POST",function(t){console.log("navigate",t),e&&e(t.data)})},U.prototype.navigateEnd=function(e){this.request(this.baseUrl+"api/jump/status",{code:e},"POST",function(t){console.log("navigateEnd code ",e,t)})},U.prototype.postData=function(t){var e=moosnow.data.getToken();if(!p.isEmpty(e)&&"0"!=moosnow.data.getChannelId()&&"0"!=moosnow.data.getChannelAppId())try{this.request(""+this.baseUrl+t,{appid:p.config.moosnowAppId,user_id:e,channel_id:moosnow.data.getChannelId(),channel_appid:moosnow.data.getChannelAppId()},"POST",function(t){})}catch(t){console.log("postData error ",t)}},U.prototype.point=function(t,e){void 0===e&&(e=null),p.platform==i.WX&&window.wx&&window.wx.aldSendEvent&&window.wx.aldSendEvent(t,e)},U.prototype.startGame=function(t){p.platform==i.WX&&(window.wx&&window.wx.aldStage?window.wx.aldStage.onStart({stageId:""+t,stageName:""+t,userId:moosnow.data.getToken()}):console.warn(B))},U.prototype.endGame=function(t,e){var o,n;p.platform==i.WX&&(o=e?"complete":"fail",n=e?"关卡完成":"关卡失败",window.wx&&window.wx.aldStage?window.wx.aldStage.onEnd({stageId:""+t,stageName:""+t,userId:moosnow.data.getToken(),event:o,params:{desc:n}}):console.warn(B))},U.prototype.videoPoint=function(t,e,o){var n;p.platform==i.WX&&(n=0==t?"点击视频":"观看完成视频",window.wx&&window.wx.aldSendEvent?window.wx.aldSendEvent(n,{info:e,level:o+""}):console.warn(B))},U.prototype.getAllConfig=function(n){var e=this;this.loadCfg(function(o){e.loadArea(function(t){e.disableAd(o,t,function(t){var e=0;t?(1==o.exportAutoNavigate&&(e=0),2==o.exportAutoNavigate&&(e=1),n(s(s({},o),{mistouchNum:0,mistouchPosNum:0,mistouchInterval:0,exportBtnNavigate:0,checkBoxMistouch:0,exportAutoNavigate:e,bannerShowCountLimit:1,isLimitArea:1,nativeErrorShowInter:0,bannerErrorShowInter:0}))):(1==o.exportAutoNavigate&&(e=1),2==o.exportAutoNavigate&&(e=1),n(s(s({},o),{exportAutoNavigate:e,isLimitArea:0})))})})})},U.prototype.loadCfg=function(t){var o=this;if(p.isEmpty(this.cfgData)){if(this._cfgQuene.push(t),1<this._cfgQuene.length)return;var e="",e=p.config.url?p.config.url+"?t="+Date.now():V+"/config/"+p.config.moosnowAppId+".json?t="+Date.now();this.request(e,{},"GET",function(t){var e=!(!t||1!=t.mistouchOn);e||console.log("总开关已关闭----------------"),o.cfgData=s(s({},p.deepCopy(t)),{zs_native_click_switch:t&&t.mx_native_click_switch?t.mx_native_click_switch:0,zs_jump_switch:t&&t.mx_jump_switch?t.mx_jump_switch:0,mistouchNum:e?t.mistouchNum:0,mistouchPosNum:e?t.mistouchPosNum:0,mistouchInterval:e?t.mistouchInterval:0,exportAutoNavigate:e?t.exportAutoNavigate:0,exportBtnNavigate:e?t.exportBtnNavigate:0,checkBoxMistouch:e?t.checkBoxMistouch:0,nativeErrorShowInter:e?t.nativeErrorShowInter:0,bannerErrorShowInter:e?t.bannerErrorShowInter:0,checkBoxProbabilitys:[100,0,0,0,0]}),moosnow.platform&&t&&(isNaN(t.bannerShowCountLimit)||(moosnow.platform.bannerShowCountLimit=parseInt(t.bannerShowCountLimit)),isNaN(t.bannerLimitType)||(moosnow.platform.bannerLimitType=parseInt(t.bannerLimitType)),isNaN(t.bannerShowTimeLimit)||(moosnow.platform.bannerShowTimeLimit=parseInt(t.bannerShowTimeLimit))),o._cfgQuene.forEach(function(t){t(o.cfgData)}),o._cfgQuene=[]},function(){o._cfgQuene.forEach(function(t){t({checkBoxMistouch:0,checkBoxProbabilitys:[100,0,0,0,0],mistouchNum:0,mistouchPosNum:0,bannerShowCountLimit:1,exportAutoNavigate:0})}),o._cfgQuene=[],console.log("load config json fail")})}else t(this.cfgData)},U.prototype.loadArea=function(t){var e=this;if(this.areaData)t(this.areaData);else{if(this._localQuene.push(t),1<this._localQuene.length)return;var o=this.baseUrl+"admin/wx_config/getLocation";this.request(o,{},"GET",function(t){e.areaData=t,e._localQuene.forEach(function(t){t(e.areaData)}),e._localQuene=[]},function(){e._localQuene.forEach(function(t){t(e.areaData)}),e._localQuene=[]})}},U.prototype.getForceExport=function(o){var n=this;this.loadCfg(function(e){n.loadArea(function(t){n.disabledForceExport(e,t,function(t){o(t)})})})},U.prototype.disabledForceExport=function(t,e,o){var n=p.formatTime(new Date),i=!1;if(t.disabledForceExport)for(var r=0;r<t.disabledForceExport.length;r++){var a=t.disabledForceExport[r];if(-1!=e.data.city.indexOf(a)||-1!=e.data.province.indexOf(a)||-1!=e.data.area.indexOf(a)){i=!0;break}}i&&(!t.forceExportTime||2!=t.forceExportTime.length||n>t.forceExportTime[0]&&n<t.forceExportTime[1])?o(!0):o(!1)},U.prototype.getMisTouchNum=function(o){var n=this;this.loadCfg(function(e){n.loadArea(function(t){n.disableAd(e,t,function(t){t?(o(0),console.log("getMisTouchNum",0,"disableAd",t)):(o(parseInt(e.mistouchNum)),console.log("getMisTouchNum",e.mistouchNum,"disableAd",t))})})})},U.prototype.getMistouchPosNum=function(o){var n=this;this.loadCfg(function(e){n.loadArea(function(t){n.disableAd(e,t,function(t){t?(o(0),console.log("getMistouchPosNum",0,"disableAd",t)):(o(parseInt(e.mistouchPosNum)),console.log("getMistouchPosNum",e.mistouchPosNum,"disableAd",t))})})})},U.prototype.getBannerShowCountLimit=function(e){this.loadCfg(function(t){isNaN(t.bannerShowCountLimit)?e(5):e(parseInt(t.bannerShowCountLimit))})},U.prototype.disableAd=function(t,e,o){var n=p.formatTime(new Date),i=!1;if(t&&t.disabledRegion)for(var r=0;r<t.disabledRegion.length;r++){var a=t.disabledRegion[r];if(e&&e.data&&(-1!=e.data.city.indexOf(a)||-1!=e.data.province.indexOf(a)||-1!=e.data.area.indexOf(a))){i=!0;break}}if(this.appLaunchOptions&&t&&(console.log("后台禁止场景 1 ",t.seachEntryScene),console.log("后台禁止场景 2 ",t.shareEntryScene),1==t.seachEntryOn&&t.seachEntryScene&&-1!=t.seachEntryScene.indexOf(this.appLaunchOptions.scene)||1==t.shareEntryOn&&t.shareEntryScene&&-1!=t.shareEntryScene.indexOf(this.appLaunchOptions.scene)))return o(!0),void console.log("后台禁止场景 ",this.appLaunchOptions.scene);i&&(!t.disabledTime||2!=t.disabledTime.length||n>t.disabledTime[0]&&n<t.disabledTime[1])?o(!0):o(!1)},U.prototype.getShareInfo=function(e){var t=this;this.request(V+"/share/"+p.config.moosnowAppId+".json",{appid:p.config.moosnowAppId},"GET",function(t){e(t),moosnow.platform.initShare(t)},function(){t.request(t.baseUrl+"admin/wx_share/getShare",{appid:p.config.moosnowAppId},"POST",function(t){console.log("分享数据",t.data),e(t.data),moosnow.platform.initShare(t.data)})})},U);function U(){var e=F.call(this)||this;e.appid="",e.secret="",e.versionNumber="",e.version="2.0.6",e.baseUrl="https://api.liteplay.com.cn/",e.mLaunchOptions={},e.cfgData=null,e.areaData=null,e._cfgQuene=[],e._localQuene=[];var t=V+"/SDK/version.json?t="+Date.now();return p.platform==i.PC?e.request(t,{},"GET",function(t){e.version<t.version&&(console.warn("您的SDK版本号["+e.version+"]不是最新版本，请尽快升级，最新版本["+t.version+"]  下载地址："+t.download),p.isEmpty(t.memo)||console.warn(""+t.memo))}):p.platform==i.WX&&window.wx&&e.request(t,{},"GET",function(t){var e=window.wx.aldVersion;(!e||e&&e<t.aldVersion)&&console.warn("阿拉丁文件错误，请重新下载"+t.aldUrl)}),e.getShareInfo(function(t){moosnow.platform.initShare(t)}),e.loadCfg(function(t){console.log("remote config ",t)}),e}var j,W=(t(G,j=f),G.prototype.initCoin=function(t){null==moosnow.setting._getValue(this.COIN,null)&&moosnow.setting.setValue(this.COIN,t)},G.prototype.getCoin=function(){return 0==this.mCoin&&(this.mCoin=moosnow.setting.getInt(this.COIN,0)),this.mCoin},G.prototype.subCoin=function(t){this.mCoin-=t,moosnow.event.sendEventImmediately(w.COIN_CHANGED,this.mCoin)},G.prototype.addCoin=function(t){this.mCoin+=t,moosnow.event.sendEventImmediately(w.COIN_CHANGED,this.mCoin)},G.prototype.setCoin=function(t){this.mCoin=t,moosnow.event.sendEventImmediately(w.COIN_CHANGED,this.mCoin)},G.prototype.saveCoin=function(){moosnow.setting.setValue(this.COIN,this.mCoin)},G.prototype.getToken=function(){return p.isEmpty(this.mUserToken)&&(this.mUserToken=moosnow.setting.getString(this.TOKEN,"")),this.mUserToken},G.prototype.setToken=function(t){moosnow.setting.setValue(this.TOKEN,t)},G.prototype.getCurrentMisTouchCount=function(){return this.mCurrentMisTouchCount},G.prototype.setCurrentMisTouchCount=function(t){this.mCurrentMisTouchCount=t},G.prototype.getChannelId=function(){return this.mChannel_id},G.prototype.setChannelId=function(t){this.mChannel_id=t},G.prototype.getChannelAppId=function(){return this.mChannel_appid},G.prototype.setChannelAppId=function(t){this.mChannel_appid=t},G.prototype.getVibrateSetting=function(){return moosnow.setting.getBool(this.VIBRATE_SWITCH,!0)},G.prototype.setVibrateSetting=function(t){moosnow.setting.setBool(this.VIBRATE_SWITCH,t),moosnow.event.sendEventImmediately(w.VIBRATESWITCH_CHANGED,t)},G.prototype.getPrizeBox=function(){return this.mPrizeBox||(this.mPrizeBox={}),this.mPrizeBox},G.prototype.clearPrizeBox=function(){this.mPrizeBox={}},G.prototype.lockPrizeBox=function(t,e,o){void 0===o&&(o=0);var n=this.getPrizeBox();n[t]={prizeId:t,type:0==e?0:1,coinNum:o},this.mPrizeBox=n},G.prototype.getUserPrizeBoxById=function(t){return this.getPrizeBox()[t]},G.prototype.getPrizeKey=function(){return null==this.mPrizeKey&&(this.mPrizeKey=3),this.mPrizeKey},G.prototype.addPrizeKey=function(t){this.mPrizeKey+=t},G.prototype.clearPrizeKey=function(){this.mPrizeKey=null,moosnow.setting.setValue(this.USER_PRIZE_KEY,"")},G);function G(){var t=null!==j&&j.apply(this,arguments)||this;return t.TOKEN="token",t.COIN="COIN",t.mUserToken="",t.VIBRATE_SWITCH="VIBRATE_SWITCH",t.USER_PRIZE_KEY="USER_PRIZE_KEY",t.mCoin=0,t.mCurrentMisTouchCount=0,t.mChannel_id="0",t.mChannel_appid="0",t}var q,K=(t(Q,q=f),Q.prototype.onEnable=function(){},Q.prototype.getInt=function(t,e){var o=this._getValue(t,e);return parseInt(o)},Q.prototype.getFloat=function(t,e){var o=this._getValue(t,e);return parseFloat(o)},Q.prototype.getBool=function(t,e){var o=1==e?"true":"false";return"true"==this.getString(t,o)},Q.prototype.getString=function(t,e){return this._getValue(t,e)},Q.prototype.getObject=function(t,e){var o=this._getValue(t,e);return o&&""!=o?JSON.parse(o):null},Q.prototype.setObject=function(t,e){var o="";e&&(o=JSON.stringify(e)),this.setValue(t,o)},Q.prototype.setBool=function(t,e){1==e?this.setValue(t,"true"):this.setValue(t,"false")},Q.prototype.setValue=function(t,e){window.localStorage.setItem(t,e)},Q.prototype.appendInt=function(t,e){var o=this.getInt(t,0),n=parseInt(e)+o;return this.setValue(t,n),n},Q.prototype.appendFloat=function(t,e){var o=this.getFloat(t,0),n=parseFloat(e)+o;this.setValue(t,n)},Q.prototype.removeValueOfKey=function(t){window.localStorage.removeItem(t)},Q.prototype.removeAll=function(){window.localStorage.clear()},Q.prototype._getValue=function(t,e){var o=window.localStorage.getItem(t);return null!=o&&""!=o||(o=e),o},Q);function Q(){return q.call(this)||this}var z,X=(t(Z,z=f),Z.prototype.getDistinctAd=function(t){for(var e=[],o=[],n=t.sort(function(t,e){return.5<Math.random()?1:-1}),i=0;i<n.length;i++){for(var r=n[i],a=!0,s=0;s<e.length;s++)if(e[s].appid==r.appid){a=!1;break}a?e.push(r):o.push(r)}return c(e,o)},Z.prototype.getAd=function(i){var t,e,r=this,a=this.getCache();p.isEmpty(a.indexLeft)?this.getRemoteAd(function(t){var e=r.initRetValue();t.forEach(function(t){e=r.formatRow(e,t)}),r.setCache(e);var o=r.getDistinctAd(e.indexLeft),n=s(s({},a),{indexLeft:o});i(n)}):(t=this.getDistinctAd(a.indexLeft),e=s(s({},a),{indexLeft:t}),i(e))},Z.prototype.getRemoteAd=function(t){t([])},Z.prototype.loadCacheImage=function(t){var e=this;this.cacheImage?t(this.cacheImage):wx.getStorage({key:this.cacheKey,success:function(t){this.this.cacheImage=t.data,console.log("cacheKey data  ",t.data)},fail:function(){e.cacheImage={},console.log("cacheKey error ")},complete:function(){t(this.this.cacheImage)}})},Z.prototype.initRetValue=function(){return{indexBanner:[],indexFloat:[],indexLeft:[],gameEndPage:[],gameRespawnPage:[],exportPage:[]}},Z.prototype.formatRow=function(t,e){switch(e.position){case"1":t.indexLeft.push(e);break;case"2":t.indexFloat.push(e);break;case"3":t.indexBanner.push(e);break;case"4":t.gameEndPage.push(e);break;case"5":t.gameRespawnPage.push(e);break;case"6":t.exportPage.push(e);break;default:t.indexLeft.push(e)}return t},Z.prototype.downloadImage=function(o,n){window.wx?wx.downloadFile({header:{},url:o,success:function(t){var e=this;200===t.statusCode&&wx.saveFile({tempFilePath:t.tempFilePath,success:function(t){e.cacheImage[""+o]=t.savedFilePath,n(t.savedFilePath)},fail:function(){n(o)},complete:function(){}})},fail:function(){n(o)},complete:function(){}}):n(o)},Z);function Z(){var t=z.call(this)||this;return t.baseUrl="https://api.liteplay.com.cn/admin/",t.cacheImage=null,t.cacheKey="cacheUrl",t.getResUrl=function(t){for(var e in this.this.cacheImage)if(this.this.cacheImage[e]==t)return e;return""},t.convertToCacheUrl=function(t,e){this.cacheImage[t]?e(this.cacheImage[t]):this.downloadImage(t,function(t){e(t)})},t.saveCacheUrl=function(t){var e=[],o=window.wx.getFileSystemManager();for(var n in this.cacheImage){var i=!0;for(var r in t)for(var a=0;a<t[r].length;a++)t[r][a].atlas!=this.cacheImage[n]&&t[r][a].img!=this.cacheImage[n]||(i=!1);i&&e.push(n)}for(a=0;a<e.length;a++){if(e[a]){console.log("clear file ",e[a]);try{o.removeSavedFile(e[a])}catch(t){console.log("clear file error ",e[a])}}delete this.cacheImage[e[a]]}window.wx&&window.wx.setStorage({key:this.cacheKey,data:this.cacheImage,success:function(){},fail:function(){},complete:function(){}})},t.mMemory={},t.getCache=function(){return this.mMemory},t.setCache=function(t){this.mMemory=t},t}var Y,J=(t($,Y=X),$.prototype.getRemoteAd=function(e){var o=this,t=V+"/exportConfig/"+p.config.moosnowAppId+".json?t="+Date.now();moosnow.http.request(t,{},"GET",function(t){e(t),console.log("WXAdModule getRemoteAd",t)},function(t){o.repairAd(e),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},$.prototype.repairAd=function(e){var t=this.baseUrl+"wx_export/getExport",o={appid:p.config.moosnowAppId};moosnow.http.request(t,o,"POST",function(t){t.data.sort(function(){return.5<Math.random()?1:-1}),e&&e(t.data)},function(){e([]),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},$);function $(){return null!==Y&&Y.apply(this,arguments)||this}var tt={FAIL:"请分享到群！"},et={ERR:"视频正在加载中,请稍后",NOTEND:"请完整观看完视频！"},ot={ARTICLE:"article",VIDEO:"video",TOKEN:"token",LINK:""},nt=(it.prototype.shuffle=function(t){for(var e,o,n=t.length,i=n;i--;)i!==(o=Math.floor(Math.random()*n))&&(e=t[i],t[i]=t[o],t[o]=e);return t},it.prototype.indexOf=function(t,e){for(var o=-1,n=0,i=t.length;n<i;n++)if(t[n]==e){o=n;break}return o},it.prototype.replace=function(t,e,o){var n=t[e],i=t[o];t[o]=n,t[e]=i},it.prototype.merge=function(t,e){for(var o=0,n=t.length;o<n;o++)e.push(t[o]);return e},it.clone=function(t){return new Array,t.slice(0)},it.remove=function(t,e){for(var o=0;o<t.length;o++)if(t[o]==e)return t.splice(o,1),void o--},it);function it(){}var rt,at=(t(st,rt=f),st.prototype.addListener=function(t,e,o){this._addListener(t,e,!1,o)},st.prototype.addToSendQueue=function(t,e){this._addToSendList(t,e)},st.prototype.sendEventImmediately=function(t,e){this._sendEvent(t,e),this.onUpdate()},st.prototype.removeListener=function(t,e){if(null!=t&&""!=t)for(var o=0;o<this._eventList.length;o++){var n=this._eventList[o];if(n.eventName===t){for(var i=0;i<n.listeners.length;i++){var r=n.listeners[i];if(r.target===e){nt.remove(n.listeners,r);break}}0==n.listeners.length&&nt.remove(this._eventList,n);break}}else console.error("eventName:"+t+"不合法！")},st.prototype.removeAllListener=function(){this._eventList.length=0,this._eventList=[],this._waitingForSendList.length=0,this._waitingForSendList=[]},st.prototype._addListener=function(t,e,o,n){if(null!=t&&""!=t){var i=new lt;n instanceof Function?i.callback=n:console.error("callback不是一个方法"),e?i.target=e:console.error("target为空"),i.once=o;var r=!1;if(0<this._eventList.length){for(var a,s=0;s<this._eventList.length;s++){var c=this._eventList[s];if(t===c.eventName)return c.listeners.push(i),void(r=!0)}r||((a=new ht).eventName=t,a.listeners.push(i),this._eventList.push(a))}else{var l=new ht;l.eventName=t,l.listeners.push(i),this._eventList.push(l)}}else console.error("eventName:"+t+"不合法！")},st.prototype._addToSendList=function(t,e){var o;null!=t&&""!=t?(o={eventName:t,data:e},this._waitingForSendList.push(o)):console.error("eventName:"+t+"不合法！")},st.prototype._sendEvent=function(t,e){for(var o=this._eventList,n=0;n<o.length;n++){var i=o[n];if(i.eventName===t)for(var r=i.listeners,a=r.length-1;0<=a;a--){var s=r[a],c=s.callback,l=s.target;l?(c.call(l,e),s.once&&this._eventList[n].listeners[a]&&(nt.remove(this._eventList[n].listeners,s),n--)):(nt.remove(this._eventList[n].listeners,s),a--)}}},st.prototype.onUpdate=function(){if(0!=this._waitingForSendList.length)for(var t=0;t<this._waitingForSendList.length;t++){var e=this._waitingForSendList[t];this._sendEvent(e.eventName,e.data),nt.remove(this._waitingForSendList,e),t--}},st.prototype.onDisable=function(){},st);function st(){var t=rt.call(this)||this;return t._eventList=[],t._waitingForSendList=[],t._eventList=[],t._waitingForSendList=[],t}var ct,lt=function(){this.callback=null,this.target=[],this.once=!1,this.callback=null,this.target=null,this.once=!1},ht=function(){this.eventName="",this.listeners=[],this.eventName="",this.listeners=[]},pt={NONE:0,BANNER:1,FLOAT:2,SIDE:4,CENTER:8,EXPORT:16,BACK:32,MASK:64,WAIT:128,LEFTRIGHT:256,EXPORT_FIXED:512,ROTATE:1024,EXTEND2:2048,EXTEND3:4096,EXTEND4:8192,TOP:32768,RECOVER:16384},ut=(t(ft,ct=f),ft.prototype.onEnable=function(){},ft.prototype.loadAsset=function(t,e,o){var n;if(p.getEngine()==a)cc.resources?cc.resources.load(t,e,function(t,e){t?console.log(" cc.resources.load ",t):o&&o(t,e)}):n=cc.loader.load(t,e,function(t,e){t?console.log(" cc.loader.load ",t):o&&o(null,n)});else if(p.getEngine()==l){var i=Laya.loader.getRes(t);if(i)return void(o&&o(null,i));Laya.loader.create(t,Laya.Handler.create(this,function(t){o(null,t)}),null,e)}},ft.prototype.loadAssetDir=function(t,e,i,o){p.getEngine()==a?cc.loader.loadResDir(t,e,function(t,e,o){var n=t/e*100,n=Math.ceil(n);i&&i(n)},function(t,e){o&&o(t,e)}):console.warn("不支持loadAssetDir")},ft.prototype.onDisable=function(){},ft);function ft(){return ct.call(this)||this}function mt(){this.VIDEO_STATUS=g,this.VIDEO_MSG=et,this.SHARE_MSG=tt,this.BANNER_POSITION=d,this.SHARE_CHANNEL=ot,this.APP_PLATFORM=i,this.PLATFORM_EVENT=w,this.Common=p,this.AD_POSITION=pt,this.mData=new W,this.mResource=new ut,this.mSetting=new K,this.mAudio=null,(window.moosnow=this).mData=new W,this.mSetting=new K,this.mEvent=new at,this.initPlatform(),this.initHttp(),this.initAd()}new(mt.prototype.getAppPlatform=function(){return p.platform},mt.prototype.initHttp=function(){this.mHttp=new H},mt.prototype.initPlatform=function(){this.mPlatform=new k},mt.prototype.initAd=function(){this.mAd=new J},Object.defineProperty(mt.prototype,"platform",{get:function(){return this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"ad",{get:function(){return this.mAd},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"http",{get:function(){return this.mHttp},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"data",{get:function(){return this.mData},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"resource",{get:function(){return this.mResource},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"setting",{get:function(){return this.mSetting},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"event",{get:function(){return this.mEvent},enumerable:!0,configurable:!0}),Object.defineProperty(mt.prototype,"audio",{get:function(){return this.mAudio},set:function(t){this.mAudio=t},enumerable:!0,configurable:!0}),mt)}();
