!function(){"use strict";var n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(t,o)};function t(t,o){function e(){this.constructor=t}n(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}var p=function(){return(p=Object.assign||function(t){for(var o,e=1,n=arguments.length;e<n;e++)for(var i in o=arguments[e])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};var i,o,a=(e.randomNumBoth=function(t,o){var e=o-t,n=Math.random();return t+Math.round(n*e)},e);function e(){}(o=i=i||{})[o.WX=0]="WX",o[o.BYTEDANCE=1]="BYTEDANCE",o[o.OPPO=2]="OPPO",o[o.OPPO_ZS=3]="OPPO_ZS",o[o.BAIDU=4]="BAIDU",o[o.QQ=5]="QQ",o[o.PC=6]="PC",o[o.VIVO=7]="VIVO";var r="cc",s="Laya",h="",l=(c.titleCase=function(t){for(var o=t.toLowerCase().split(/\s+/),e=0;e<o.length;e++)o[e]=o[e].slice(0,1).toUpperCase()+o[e].slice(1);return o.join(" ")},c.numFixed=function(t,o){return parseFloat(parseFloat(t).toFixed(o))},c.parseMoney=function(t){return isNaN(t)?0:parseFloat(parseFloat(t).toFixed(2))},c.objKeySort=function(t){for(var o=Object.keys(t).sort(),e={},n=0;n<o.length;n++)e[o[n]]=t[o[n]];return e},c.isObject=function(t){var o=typeof t;return null!==t&&("object"==o||"function"==o)},c.object2Query=function(t){var o=[];for(var e in t)o.push(e+"="+t[e]);return o.join("&")},c.isFunction=function(t){return"function"==typeof t},c.isEmpty=function(t){if("object"!=typeof t)return null==t||"null"===t||"undefined"===t||""===t;var o;for(o in t)return!1;return!0},c.formatTime=function(t){return[t.getHours(),t.getMinutes()].map(this.formatNumber).join(":")},c.formatNumber=function(t){return(t=t.toString())[1]?t:"0"+t},c.copy=function(t,o){for(var e in t)o[e]=t[e]},c.randomNumBoth=function(t,o){var e=o-t,n=Math.random();return t+Math.round(n*e)},c.randomFloat=function(t,o){return t+Math.random()*o},c.randomToRatio=function(t,o,e){return this.randomNumBoth(t,o)<=e},c.generateUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)})},c.isNumber=function(t){return"number"==typeof t||"[object Number]"==Object.prototype.toString.call(t)},c.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},c.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},Object.defineProperty(c,"platform",{get:function(){if(this.mPlatform)return this.mPlatform;var t,o=window.moosnowConfig;return window.tt?this.mPlatform=i.BYTEDANCE:window.swan?this.mPlatform=i.BAIDU:window.qq?this.mPlatform=i.QQ:window.qg?window.qg&&window.qg.getSystemInfoSync?(t=window.qg.getSystemInfoSync(),console.log("平台判断",JSON.stringify(t)),t&&t.brand&&-1!=t.brand.toLocaleLowerCase().indexOf("vivo")?this.mPlatform=i.VIVO:-1!=o.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=i.OPPO_ZS:this.mPlatform=i.OPPO):-1!=o.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=i.OPPO_ZS:this.mPlatform=i.OPPO:window.wx?this.mPlatform=i.WX:o.debug&&o[o.debug]?"wx"==o.debug?this.mPlatform=i.WX:"oppo"==o.debug?-1!=o.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=i.OPPO_ZS:this.mPlatform=i.OPPO:"bd"==o.debug?this.mPlatform=i.BAIDU:"byte"==o.debug?this.mPlatform=i.BYTEDANCE:"qq"==o.debug?this.mPlatform=i.QQ:"vivo"==o.debug?this.mPlatform=i.VIVO:this.mPlatform=i.PC:this.mPlatform=i.PC,this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(c,"config",{get:function(){var t=window.moosnowConfig,o=c.platform==i.WX?t.wx:c.platform==i.OPPO||c.platform==i.OPPO_ZS?t.oppo:c.platform==i.VIVO?t.vivo:c.platform==i.QQ?t.qq:c.platform==i.BAIDU?t.bd:c.platform==i.BYTEDANCE?t.byte:t.wx;return o},enumerable:!0,configurable:!0}),c.deepCopy=function(t){var o=Array.isArray(t)?[]:{};if(t&&"object"==typeof t)for(var e in t)t.hasOwnProperty(e)&&(t[e]&&"object"==typeof t[e]?o[e]=this.deepCopy(t[e]):o[e]=t[e]);return o},c.getEngine=function(){return window[r]?r:window[s]?s:h},c.popOpenAnim=function(t,o){if(this.getEngine()==r)return t.scale=.8,void t.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1),cc.callFunc(function(){o&&o()},this)));o()},c.popCloseAnim=function(t,o){if(this.getEngine()==r)return t.scale=1,void t.runAction(cc.sequence(cc.scaleTo(.1,0,0),cc.callFunc(function(){o&&o()},this)));o()},c.format=function(t){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];if(void 0===t||null==t||""==t||"undefined"==t)return t;for(var n=0;n<o.length;n++){var i=new RegExp("\\{"+n+"\\}","gm");t=t.replace(i,o[n])}return t},c.formatMoney=function(t){return isNaN(t)&&(t=0),t<9999?parseInt(""+t):t<9999999?parseFloat(""+t/1e3).toFixed(2)+"K":t<9999999999?parseFloat(""+t/1e6).toFixed(2)+"M":t<9999999999999?parseFloat(""+t/1e9).toFixed(2)+"G":t<1e16?parseFloat(""+t/1e12).toFixed(2)+"T":t<1e19?parseFloat(""+t/1e15).toFixed(2)+"P":t<1e22?parseFloat(""+t/1e18).toFixed(2)+"E":parseFloat(""+t/1e21).toFixed(2)+"B"},c);function c(){}var u=(d.prototype.schedule=function(t,o){var e=this,n=setInterval(function(){t&&t.apply(e)},1e3*o);console.log("BaseModule schedule ",n),this.mIntervalArr[n]=t},d.prototype.unschedule=function(t){for(var o in this.mIntervalArr)this.mIntervalArr[o]!==t&&!l.isEmpty(this.mIntervalArr[o])||clearInterval(parseInt(o))},d.prototype.scheduleOnce=function(t,o){var e=this,n=setTimeout(function(){clearTimeout(n),t&&t.apply(e)},1e3*o);this.mTimeoutArr[n]=t},d.prototype.unscheduleOnce=function(t){for(var o in this.mTimeoutArr)this.mTimeoutArr[o]!==t&&!l.isEmpty(this.mTimeoutArr[o])||clearTimeout(parseInt(o))},d.prototype.initProperty=function(t){for(var o in t)this.hasOwnProperty(o)&&(this[o]=t[o])},d.prototype.preload=function(t,o){o&&o()},d.prototype._findComponent=function(t,o){for(var e=null,n=0;n<t._components.length;n++){var i=t._components[n];if(i.willHide&&i.willShow){e=i;break}}return e},d.prototype._findComponentByName=function(t,o){return!!t&&(t.name==o||this._findComponentByName(t.$super,o))},d);function d(){this.moduleName="",this.mIntervalArr={},this.mTimeoutArr={}}var m={TOP:"__banner_top",CENTER:"__banner_center",BOTTOM:"__banner_bottom",CUSTOM:"__banner_custom"},f={END:"__video_end",NOTEND:"__video_not_end",ERR:"__video_error"},w=(g.VIBRATESWITCH_CHANGED="VIBRATESWITCH_CHANGED",g.SOUNDSWITCH_CHANGED="SOUNDSWITCH_CHANGED",g.MUSICSWITCH_CHANGED="MUSICSWITCH_CHANGED",g.ON_PLATFORM_SHOW="ON_PLATFORM_SHOW",g.ON_PLATFORM_HIDE="ON_PLATFORM_HIDE",g.ON_BANNER_HIDE="ON_BANNER_HIDE",g.ON_AD_SHOW="ON_AD_SHOW",g.AD_VIEW_CHANGE="AD_VIEW_CHANGE",g.AD_VIEW_REFRESH="AD_VIEW_REFRESH",g.COIN_CHANGED="COIN_CHANGED",g);function g(){}var y,v="隐藏banner",b="你的好友{0}邀请你加入",C=(t(N,y=u),N.prototype.onEnable=function(){},N.prototype.vibrateSwitch=function(t){this.vibrateOn=t},N.prototype.initAppConfig=function(){this.moosnowConfig=l.config,this.bannerId=this.moosnowConfig.bannerId,this.videoId=this.moosnowConfig.videoId,this.interId=this.moosnowConfig.interId,this.boxId=this.moosnowConfig.boxId,this.nativeId=this.moosnowConfig.nativeId,console.log("moosnowConfig ",JSON.stringify(this.moosnowConfig))},N.prototype.isIphoneXModel=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone x/.test(t.model.toLowerCase())}},N.prototype.isIphone=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone/.test(t.model.toLowerCase())}},N.prototype.isIphoneX=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),o=t.screenHeight,e=t.screenWidth/o;return e<=.5||2<=e}},N.prototype.compareVersion=function(t,o){t=t.split("."),o=o.split(".");for(var e=Math.max(t.length,o.length);t.length<e;)t.push("0");for(;o.length<e;)o.push("0");for(var n=0;n<e;n++){var i=parseInt(t[n]),r=parseInt(o[n]);if(r<i)return 1;if(i<r)return-1}return 0},N.prototype.supportVersion=function(t){var o=this.getSystemInfoSync().SDKVersion;return 0<=this.compareVersion(o,t)},N.prototype.supportFunction=function(t){return!!window[this.platformName]&&!!window[this.platformName][t]},N.prototype.checkVersion=function(t,o){null==this.versionRet?this._checkConfigVersion(o):o(this.versionRet)},N.prototype._checkRemoteVersion=function(o){var e=this,t=this.baseUrl+"admin/wx_list/getAppConfig",n={appid:this.moosnowConfig.moosnowAppId};moosnow.http.request(t,n,"POST",function(t){e.versionRet=e.checkLog(t.data.version),o(e.versionRet)},function(){console.log("checkVersion fail")},function(){console.log("checkVersion complete")})},N.prototype._checkConfigVersion=function(o){var e=this;moosnow.http.getAllConfig(function(t){t&&t.version?(e.versionRet=e.checkLog(t.version),o(e.versionRet)):e._checkRemoteVersion(o)})},N.prototype.checkLog=function(t){var o=moosnow.platform.moosnowConfig.version,e=t==o;return console.log("版本检查 后台版本"+t+" 配置文件版本"+o),console.log("获取广告开关：",e),e},N.prototype.isSmallWidth=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),o=t.screenHeight;return t.screenWidth,o<667&&(console.log("高度不够",o),!0)}},N.prototype.login=function(t,o){var e;l.isFunction(t)&&((e=moosnow.data.getToken())||(e=(e=l.generateUUID()).replace(/-/g,""),moosnow.data.setToken(e)),t(e))},N.prototype.postMessage=function(t){window[this.platformName]&&window[this.platformName].getOpenDataContext&&window[this.platformName].getOpenDataContext().postMessage(t)},N.prototype.navigate2Mini=function(o,e,n,i){var r,s,a,h=this;console.log("跳转数据：",o),Date.now()-this.prevNavigate<300?console.log(" 跳转太频繁 >>>>>>>>>>>>>>>>>>>>> "):(this.prevNavigate=Date.now(),window[this.platformName]?(r=o.appid,s=o.path,a=(a=o.extraData)||{},moosnow.http.navigate(r,function(t){window[h.platformName].navigateToMiniProgram({appId:r,path:s,extraData:a,success:function(){moosnow.http.point("跳转",{position:o.position,appid:r,img:o.atlas||o.img}),moosnow.http.navigateEnd(t.code),moosnow.http.exportUser(),e&&e()},fail:function(t){console.log("navigateToMini fail ",t," fail callback ",!!n),n&&n()},complete:function(){i&&i()}})})):n&&n())},N.prototype.updateProgram=function(){var o,e=this;window[this.platformName]&&"function"==typeof window[this.platformName].getUpdateManager&&((o=window[this.platformName].getUpdateManager()).onCheckForUpdate(function(t){}),o.onUpdateReady(function(t){e.showModal("发现新版本","新版本已经准备好，是否更新？","取消","更新",function(t){t&&o.applyUpdate()})}),o.onUpdateFailed(function(){}))},N.prototype.vibrateShort=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateShort||window[this.platformName].vibrateShort())},N.prototype.vibrateLong=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateLong||window[this.platformName].vibrateLong())},N.prototype.showLoading=function(t){window[this.platformName]?window[this.platformName].showLoading({title:t,mask:!1,success:null,fail:null,complete:null}):console.log("showLoading",t)},N.prototype.hideLoading=function(){window[this.platformName]&&window[this.platformName].hideLoading()},N.prototype.showModal=function(t,o,e,n,i){window[this.platformName]&&window[this.platformName].showModal({title:t,content:o,cancelText:e,confirmText:n,showCancel:!0,cancelColor:"#000000",confirmColor:"#3CC51F",fail:null,complete:null,success:function(t){t.confirm?i&&i(!0):t.cancel&&i&&i(!1)}})},N.prototype.showModalWithoutCancel=function(t,o,e,n){window[this.platformName]&&window[this.platformName].showModal({title:t,content:o,showCancel:!1,confirmText:e,cancelColor:"#000000",confirmColor:"#3CC51F",cancelText:"",fail:null,complete:null,success:function(t){t.confirm?n&&n(!0):t.cancel&&n&&n(!1)}})},N.prototype.showToast=function(t,o,e){void 0===o&&(o="none"),void 0===e&&(e=!1),window[this.platformName]&&window[this.platformName].showToast({title:t,icon:o,duration:2e3,mask:e,image:null,success:null,fail:null,complete:null})},N.prototype.authOrGetUserInfo=function(o){var e;window[this.platformName]&&(e=this).getSetting(function(t){console.log("授权信息",t),t["scope.userInfo"]?e.getUserInfo(function(t){console.log("获取用户信息：",t),o(t,!1)},function(t){}):e.showUserInfoButton(function(t){o(t,!0),console.log("授权获取用户信息：",t)})},function(t){e.showUserInfoButton(function(t){o(t,!0),console.log("授权获取用户信息：",t)})})},N.prototype.showUserInfoButton=function(o){var t={type:"text",text:"",style:this._initLoginButton()},e=window[this.platformName].createUserInfoButton(t);e.onTap(function(t){t.userInfo&&t.userInfo.nickName?(o(t.userInfo),e.hide()):o(null)}),e.show()},N.prototype.getSetting=function(o,t){window[this.platformName].getSetting({success:function(t){o(t.authSetting)},fail:function(){t()},complete:null})},N.prototype.getUserInfo=function(o,t){window[this.platformName].getUserInfo({success:function(t){o(t.userInfo)},fail:function(){t()},withCredentials:!1,complete:null,lang:"en"})},N.prototype.getLaunchOption=function(){return window[this.platformName]&&window[this.platformName].getLaunchOptionsSync?window[this.platformName].getLaunchOptionsSync():{}},N.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log("设备信息",this.systemInfo)),this.systemInfo},N.prototype.isLandscape=function(t,o){return t<o},N.prototype.initShare=function(t){var o=this;window[this.platformName]&&window[this.platformName].showShareMenu&&(this.shareInfoArr=t,window[this.platformName].showShareMenu({withShareTicket:!0,success:null,fail:null,complete:null}),window[this.platformName].onShareAppMessage&&window[this.platformName].onShareAppMessage(function(){return o._buildShareInfo()}))},N.prototype.getShareInfo=function(t,o,e){void 0===e&&(e=null),window[this.platformName]&&window[this.platformName].getShareInfo({shareTicket:t,success:function(t){o(t.encryptedData,t.iv)},fail:function(){e&&e()},complete:null})},N.prototype.share=function(t,o){void 0===t&&(t={}),window[this.platformName]||o&&o(!0),this.currentShareCallback=o,this.share_clickTime=Date.now(),this.shareFail=!1,this._share(t)},N.prototype.shareWithoutCheck=function(t,o){void 0===t&&(t={}),window[this.platformName]||o&&o(!0),this.currentShareCallback=o,this.share_clickTime=1,this.shareFail=!1,this._share(t)},N.prototype._share=function(t){var o;void 0===t&&(t=null),window[this.platformName]&&window[this.platformName].shareAppMessage?(o=this._buildShareInfo(t),console.log("分享数据：",o),window[this.platformName].shareAppMessage(o)):this.currentShareCallback(!0)},N.prototype._buildShareInfo=function(t){void 0===t&&(t=null);var o,e="",n="";return 0<this.shareInfoArr.length&&(e=(o=this.shareInfoArr[a.randomNumBoth(0,this.shareInfoArr.length-1)]).title,n=o.img),{title:e,imageUrl:n,query:t}},N.prototype._onShareback=function(){var t=this;setTimeout(function(){t.share_clickTime&&t.currentShareCallback&&(!t.shareFail&&(1==t.share_clickTime||3e3<=Date.now()-t.share_clickTime)?t.currentShareCallback(!0):t.currentShareCallback(!1)),t.shareFail=!1,t.currentShareCallback=null,t.share_clickTime=null},100)},N.prototype._initLoginButton=function(){if(window[this.platformName]){var t=window[this.platformName].getSystemInfoSync();return{left:0,top:0,width:t.screenWidth,height:t.screenHeight,lineHeight:40,color:"#ffffff",type:"text",text:"获取用户信息",textAlign:"center",fontSize:28}}},N.prototype.initRecord=function(){},N.prototype.clipRecord=function(){},N.prototype.startRecord=function(t,o){void 0===t&&(t=300),void 0===o&&(o=null),this.record||o&&o(!1)},N.prototype.stopRecord=function(t){void 0===t&&(t=null),this.record||t&&t(!1)},N.prototype.pauseRecord=function(){},N.prototype.resumeRecord=function(){},N.prototype._regisiterWXCallback=function(){window[this.platformName]&&(this._regisiterOnShow(),this._regisiterOnHide())},N.prototype._regisiterOnShow=function(){var o;window[this.platformName].onShow&&window[(o=this).platformName].onShow(function(t){o._onShowCallback(t)})},N.prototype._onShowCallback=function(t){this._onShareback(),console.log("on show ",t),moosnow.event.sendEventImmediately(w.ON_PLATFORM_SHOW,t)},N.prototype._regisiterOnHide=function(){var o;window[this.platformName].onHide&&window[(o=this).platformName].onHide(function(t){o._onHideCallback(t)})},N.prototype._onHideCallback=function(t){console.log("on show ",t),moosnow.event.sendEventImmediately(w.ON_PLATFORM_HIDE,t),console.log("on hide ",t);var o=t&&(8==t.targetAction||9==t.targetAction||10==t.targetAction)&&50<t.targetPagePath.length;o&&moosnow.http.clickBanner(),this.bannerCb?this.bannerCb(o):console.log("banner callback is null ")},N.prototype.initBanner=function(){window[this.platformName]&&this._prepareBanner()},N.prototype._prepareBanner=function(){var t,o;window[this.platformName].createBannerAd&&(o=(t=this.getSystemInfoSync()).windowWidth,t.windowHeight<t.windowWidth&&!(o<this.bannerWidth)||(this.bannerWidth=o),this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad)),this.banner=this._createBannerAd(),this.banner&&(this.banner.onResize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this))))},N.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=(this.getSystemInfoSync().windowWidth-this.bannerWidth)/2;if(!l.isEmpty(this.bannerId))return window[this.platformName].createBannerAd({adUnitId:this.bannerId,style:{top:0,left:t,width:this.bannerWidth}});console.warn("banner id is null")}},N.prototype._onBannerLoad=function(){this.bannerShowCount=0},N.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode,t.errMsg),this.banner=null,this.isBannerShow=!1,moosnow.event.sendEventImmediately(w.ON_BANNER_HIDE,null)},N.prototype._bottomCenterBanner=function(t){var o=this.getSystemInfoSync().windowWidth;this.banner.style.left=(o-t.width)/2,this.bannerWidth=this.banner.style.realWidth,this.bannerHeigth=this.banner.style.realHeight,console.log("_bottomCenterBanner",this.banner.style)},N.prototype._resetBanenrStyle=function(t){var o,e,n;l.isEmpty(t)?console.log("设置的banner尺寸为空,不做调整"):((o=this.getSystemInfoSync()).windowWidth,e=o.windowHeight,n=0,this.bannerPosition==m.BOTTOM?n=e-this.bannerHeigth:this.bannerPosition==m.CENTER?n=(e-this.bannerHeigth)/2:this.bannerPosition==m.TOP&&(n=0),this.bannerStyle?this.banner.style=this.bannerStyle:(this.banner.style.top=n,console.log("banner位置或大小被重新设置 ",this.banner.style,"set top ",n)))},N.prototype.showBanner=function(t,o,e){var n=this;void 0===o&&(o=m.BOTTOM),console.log("显示banner"),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=e,this.mTimeoutId&&(clearTimeout(this.mTimeoutId),this.mTimeoutId=null),this.banner&&(console.log("show banner style ",this.banner.style),this.banner.hide(),this._resetBanenrStyle({width:this.banner.style.width,height:this.banner.style.realHeight}),this.banner.show().then(function(){n._resetBanenrStyle({width:n.banner.style.width,height:n.banner.style.realHeight})})))},N.prototype.showAutoBanner=function(){var e=this;console.log("执行自动显示和隐藏Banner功能"),moosnow.http.getAllConfig(function(t){var o;t&&1==t.gameBanner&&(moosnow.platform.showBanner(),o=isNaN(t.gameBanenrHideTime)?1:parseFloat(t.gameBanenrHideTime),e.mTimeoutId=setTimeout(function(){console.log("自动隐藏时间已到，开始隐藏Banner"),e.isBannerShow,e.hideBanner()},1e3*o))})},N.prototype.showIntervalBanner=function(){var e=this;console.log("执行 showIntervalBanner"),moosnow.http.getAllConfig(function(t){var o=t&&!isNaN(t.gameBannerInterval)?parseFloat(t.gameBannerInterval):20;t&&t.gameBanner,e.schedule(e.showAutoBanner,o)})},N.prototype.clearIntervalBanner=function(){console.log("执行 clearIntervalBanner"),this.unschedule(this.showAutoBanner)},N.prototype.hideBanner=function(){console.log(v),this.isBannerShow&&(this.isBannerShow=!1,window[this.platformName]&&(this.bannerShowCount++,this.banner?this.bannerShowCount>=this.bannerShowCountLimit?(console.log("banner destroy"),this.banner.hide(),this.banner.destroy(),this.banner=null,this._prepareBanner()):this.banner.hide():this._prepareBanner()))},N.prototype.initVideo=function(){this.createRewardAD(!1)},N.prototype.createRewardAD=function(t){var o=this;if(!moosnow.platform.videoLoading)if(window[this.platformName])if(window[this.platformName].createRewardedVideoAd){if(l.isEmpty(this.videoId))return console.warn(" video id is null"),void moosnow.platform.videoCb(f.END);if(this.video)this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad);else if(this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.videoId}),!this.video)return void console.warn("创建视频广告失败");this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad),moosnow.platform.videoLoading=!0,this.videoPlaying=!1,this.video.load().then(function(){t&&o.video.show().then(function(){}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}else moosnow.platform.videoCb(f.END);else moosnow.platform.videoCb(f.END)},N.prototype._onVideoError=function(t,o){console.log("加载video失败回调",t,o),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,moosnow.platform.videoCb&&(moosnow.platform.videoCb(f.ERR),moosnow.platform.videoCb=null)},N.prototype._onVideoClose=function(t){var o;console.log("video结束回调",t.isEnded),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,t.isEnded&&moosnow.http.clickVideo(),moosnow.platform.videoCb&&(o=t.isEnded?f.END:f.NOTEND,setTimeout(function(){moosnow.platform.videoCb(o)},50))},N.prototype._onVideoLoad=function(){console.log("加载video成功回调"),moosnow.platform.videoLoading=!1},N.prototype.showVideo=function(t){void 0===t&&(t=null),console.log("显示video"),moosnow.platform.videoCb=t,this.createRewardAD(!0)},N.prototype.initInter=function(){this.prepareInter()},N.prototype.prepareInter=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createInterstitialAd&&this.supportVersion("2.8.0")&&(l.isEmpty(this.interId)?console.warn("插屏广告ID为空，系统不加载"):(this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this))))},N.prototype.showInter=function(){this.inter&&this.isInterLoaded&&this.inter.show()},N.prototype._onInterLoad=function(){this.interShowCount=0,this.isInterLoaded=!0,console.log("插屏广告加载完成")},N.prototype._onInterClose=function(){this.interShowCount++,this.interShowCount>=this.interShowCountLimit&&(this.isInterLoaded=!1,this.inter.load())},N.prototype._onInterError=function(t){console.log("插屏广告出错：",t)},N.prototype._prepareNative=function(){},N.prototype._onNativeLoad=function(t){},N.prototype._onNativeError=function(t){},N.prototype._destroyNative=function(){},N.prototype.showNativeAd=function(t){l.isFunction(t)&&t()},N.prototype.clickNative=function(t){},N.prototype.showAppBox=function(t,o){void 0===o&&(o=!0),l.isFunction(t)&&t()},N.prototype.hideAppBox=function(t){l.isFunction(t)&&t()},N.prototype.reportMonitor=function(t,o){},N.prototype.showMoreGameButton=function(t,o,e){void 0===e&&(e=null),o&&o()},N.prototype.initRank=function(){this.postMessage({action:1})},N.prototype.showRank=function(){this.postMessage({action:10})},N.prototype.updateUserScore=function(t){var o={action:13,data:t};this.postMessage(o)},N.prototype.hideRank=function(){this.postMessage({action:20})},N.prototype.onDisable=function(){},N);function N(){var t=y.call(this)||this;return t.baseUrl="https://api.liteplay.com.cn/",t.currentShareCallback=null,t.shareFail=null,t.vibrateOn=!1,t.systemInfo=null,t.banner=null,t.video=null,t.inter=null,t.native=null,t.box=null,t.platformName="wx",t.bannerId="",t.videoId="",t.interId="",t.boxId="",t.nativeId=[],t.nativeIdIndex=0,t.bannerWidth=300,t.bannerHeigth=96,t.bannerShowCount=0,t.bannerShowCountLimit=3,t.bannerCb=null,t.bannerPosition=m.BOTTOM,t.bannerStyle=null,t.isBannerShow=!1,t.videoCb=null,t.videoLoading=!1,t.videoPlaying=!1,t.interShowCount=0,t.interShowCountLimit=3,t.isInterLoaded=!1,t.nativeAdResult=null,t.nativeCb=null,t.nativeLoading=!1,t.record=null,t.shareInfoArr=[],t.versionRet=null,t.prevNavigate=Date.now(),t.initAppConfig(),t.initShare(!0),t.share_clickTime=null,t.currentShareCallback=null,t.shareFail=!1,t.updateProgram(),t.initRecord(),t}var I,_=(t(S,I=C),S.prototype.login=function(o,t){moosnow.http.getAllConfig(function(t){});var e=this,n=moosnow.data.getToken();n?e.getUserToken("",n,o):window[this.platformName]&&window[this.platformName].login?window[this.platformName].login({success:function(t){t.code?e.getUserToken(t.code,"",o):l.isFunction(o)&&o()},fail:function(){}}):I.prototype.login.call(this,o,t)},S.prototype.getUserToken=function(t,o,e){var n=this.getLaunchOption(),i=n.scene,r=n.query&&n.query.channel_id?n.query.channel_id:"0",s=n.referrerInfo&&n.referrerInfo.appId?n.referrerInfo.appId:"0";moosnow.data.setChannelAppId(s),moosnow.data.setChannelId(r);var a=n.referrerInfo?n.referrerInfo.appId:"未知";window[this.platformName]&&window[this.platformName].aldSendEvent&&window[this.platformName].aldSendEvent("来源",{origin:a,path:n.query.from||0}),moosnow.http.request(this.baseUrl+"api/channel/login.html",{appid:moosnow.platform.moosnowConfig.moosnowAppId,code:t,user_id:o,channel_id:r,channel_appid:s,scene:i,fromApp:a},"POST",function(t){0==t.code&&t.data&&t.data.user_id&&moosnow.data.setToken(t.data.user_id),l.isFunction(e)&&e(t)},function(){l.isFunction(e)&&e({})})},S);function S(){var t=I.call(this)||this;return t.platformName="wx",t._regisiterWXCallback(),t.initBanner(),t.initInter(),t}var A,P=(t(O,A=u),O.prototype.getDistinctAd=function(t){for(var o=[],e=[],n=t.sort(function(t,o){return.5<Math.random()?1:-1}),i=0;i<n.length;i++){for(var r=n[i],s=!0,a=0;a<o.length;a++)if(o[a].appid==r.appid){s=!1;break}s?o.push(r):e.push(r)}return function(){for(var t=0,o=0,e=arguments.length;o<e;o++)t+=arguments[o].length;for(var n=Array(t),i=0,o=0;o<e;o++)for(var r=arguments[o],s=0,a=r.length;s<a;s++,i++)n[i]=r[s];return n}(o,e)},O.prototype.getAd=function(i){var t,o,r=this,s=this.getCache();l.isEmpty(s.indexLeft)?this.getRemoteAd(function(t){var o=r.initRetValue();t.forEach(function(t){o=r.formatRow(o,t)}),r.setCache(o);var e=r.getDistinctAd(o.indexLeft),n=p(p({},s),{indexLeft:e});i(n)}):(t=this.getDistinctAd(s.indexLeft),o=p(p({},s),{indexLeft:t}),i(o))},O.prototype.getRemoteAd=function(t){t([])},O.prototype.loadCacheImage=function(t){var o=this;this.cacheImage?t(this.cacheImage):wx.getStorage({key:this.cacheKey,success:function(t){this.this.cacheImage=t.data,console.log("cacheKey data  ",t.data)},fail:function(){o.cacheImage={},console.log("cacheKey error ")},complete:function(){t(this.this.cacheImage)}})},O.prototype.initRetValue=function(){return{indexBanner:[],indexFloat:[],indexLeft:[],gameEndPage:[],gameRespawnPage:[],exportPage:[]}},O.prototype.formatRow=function(t,o){switch(o.position){case"1":t.indexLeft.push(o);break;case"2":t.indexFloat.push(o);break;case"3":t.indexBanner.push(o);break;case"4":t.gameEndPage.push(o);break;case"5":t.gameRespawnPage.push(o);break;case"6":t.exportPage.push(o);break;default:t.indexLeft.push(o)}return t},O.prototype.downloadImage=function(e,n){window.wx?wx.downloadFile({header:{},url:e,success:function(t){var o=this;200===t.statusCode&&wx.saveFile({tempFilePath:t.tempFilePath,success:function(t){o.cacheImage[""+e]=t.savedFilePath,n(t.savedFilePath)},fail:function(){n(e)},complete:function(){}})},fail:function(){n(e)},complete:function(){}}):n(e)},O);function O(){var t=A.call(this)||this;return t.baseUrl="https://api.liteplay.com.cn/admin/",t.cacheImage=null,t.cacheKey="cacheUrl",t.getResUrl=function(t){for(var o in this.this.cacheImage)if(this.this.cacheImage[o]==t)return o;return""},t.convertToCacheUrl=function(t,o){this.cacheImage[t]?o(this.cacheImage[t]):this.downloadImage(t,function(t){o(t)})},t.saveCacheUrl=function(t){var o=[],e=window.wx.getFileSystemManager();for(var n in this.cacheImage){var i=!0;for(var r in t)for(var s=0;s<t[r].length;s++)t[r][s].atlas!=this.cacheImage[n]&&t[r][s].img!=this.cacheImage[n]||(i=!1);i&&o.push(n)}for(s=0;s<o.length;s++){if(o[s]){console.log("clear file ",o[s]);try{e.removeSavedFile(o[s])}catch(t){console.log("clear file error ",o[s])}}delete this.cacheImage[o[s]]}window.wx&&window.wx.setStorage({key:this.cacheKey,data:this.cacheImage,success:function(){},fail:function(){},complete:function(){}})},t.mMemory={},t.getCache=function(){return this.mMemory},t.setCache=function(t){this.mMemory=t},t}var F,T=(t(E,F=u),Object.defineProperty(E.prototype,"appLaunchOptions",{get:function(){return this.mLaunchOptions||moosnow.platform&&moosnow.platform.getLaunchOption&&(this.mLaunchOptions=moosnow.platform.getLaunchOption()),this.mLaunchOptions},enumerable:!0,configurable:!0}),E.prototype.request=function(t,o,e,n,i,r){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState){var o=s.responseText;if(200<=s.status&&s.status<400){var t={};try{t=JSON.parse(o)}catch(t){console.error("json parse error ",o),i&&i(t)}n&&n(t)}else console.warn("error ",o),i&&i(o)}},s.timeout=1e4,s.ontimeout=function(t){console.error("error ",t),i&&i(t)},s.open(e,t,!0),"POST"==e?(s.open("POST",t),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(this._object2Query(o))):s.send()},E.prototype._object2Query=function(t){var o=[];for(var e in t)o.push(e+"="+t[e]);return o.join("&")},E.prototype.isDisableArea=function(t){},E.prototype.finishLoading=function(){this.postData("api/channel/validUser.html")},E.prototype.clickBanner=function(){this.postData("api/channel/clickBanner.html")},E.prototype.clickVideo=function(){this.postData("api/channel/clickVideo.html")},E.prototype.exportUser=function(){this.postData("api/channel/exportUser.html")},E.prototype.navigate=function(t,o){var e=moosnow.data.getToken();this.request(this.baseUrl+"api/jump/record",{appid:l.config.moosnowAppId,uid:e,jump_appid:t},"POST",function(t){console.log("navigate",t),o&&o(t.data)})},E.prototype.navigateEnd=function(o){this.request(this.baseUrl+"api/jump/status",{code:o},"POST",function(t){console.log("navigateEnd code ",o,t)})},E.prototype.postData=function(t){var o=moosnow.data.getToken();if(!l.isEmpty(o)&&"0"!=moosnow.data.getChannelId()&&"0"!=moosnow.data.getChannelAppId())try{this.request(""+this.baseUrl+t,{appid:l.config.moosnowAppId,user_id:o,channel_id:moosnow.data.getChannelId(),channel_appid:moosnow.data.getChannelAppId()},"POST",function(t){})}catch(t){console.log("postData error ",t)}},E.prototype.point=function(t,o){void 0===o&&(o=null),l.platform==i.WX&&window.wx&&window.wx.aldSendEvent&&window.wx.aldSendEvent(t,o)},E.prototype.startGame=function(t){l.platform==i.WX&&(window.wx&&window.wx.aldStage?window.wx.aldStage.onStart({stageId:t,stageName:t,userId:moosnow.data.getToken()}):console.warn("阿拉丁文件未引入"))},E.prototype.endGame=function(t,o){var e,n;l.platform==i.WX&&(e=o?"complete":"fail",n=o?"关卡完成":"关卡失败",window.wx&&window.wx.aldStage?window.wx.aldStage.onEnd({stageId:t,stageName:t,userId:moosnow.data.getToken(),event:e,params:{desc:n}}):console.warn("阿拉丁文件未引入"))},E.prototype.videoPoint=function(t,o,e){var n;l.platform==i.WX&&(n=0==t?"点击视频":"观看完成视频",window.wx&&window.wx.aldSendEvent?window.wx.aldSendEvent(n,{info:o,level:e+""}):console.warn("阿拉丁文件未引入"))},E.prototype.getAllConfig=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disableAd(o,t,function(t){e(t?p(p({},o),{mistouchNum:0,mistouchPosNum:0,bannerShowCountLimit:1}):o)})})})},E.prototype.loadCfg=function(t){var o=this;if(l.isEmpty(this.cfgData)){if(this._cfgQuene.push(t),1<this._cfgQuene.length)return;var e="",e=l.config.url?l.config.url+"?t="+Date.now():this._cdnUrl+"/config/"+l.config.moosnowAppId+".json";this.request(e,{},"GET",function(t){o.cfgData=p(p({},l.deepCopy(t)),{zs_native_click_switch:t&&t.mx_native_click_switch?t.mx_native_click_switch:0,zs_jump_switch:t&&t.mx_jump_switch?t.mx_jump_switch:0}),moosnow.platform&&(moosnow.platform.bannerShowCountLimit=parseInt(t.bannerShowCountLimit)),o._cfgQuene.forEach(function(t){t(o.cfgData)}),o._cfgQuene=[]},function(){o._cfgQuene.forEach(function(t){t({mistouchNum:0,mistouchPosNum:0,bannerShowCountLimit:1})}),o._cfgQuene=[],console.log("load config json fail")})}else t(this.cfgData)},E.prototype.loadArea=function(t){var o=this;if(this.areaData)t(this.areaData);else{if(this._localQuene.push(t),1<this._localQuene.length)return;var e=this.baseUrl+"admin/wx_config/getLocation";this.request(e,{},"GET",function(t){o.areaData=t,o._localQuene.forEach(function(t){t(o.areaData)}),o._localQuene=[]},function(){o._localQuene.forEach(function(t){t(o.areaData)}),o._localQuene=[]})}},E.prototype.getForceExport=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disabledForceExport(o,t,function(t){e(t)})})})},E.prototype.disabledForceExport=function(t,o,e){var n=l.formatTime(new Date),i=!1;if(t.disabledForceExport)for(var r=0;r<t.disabledForceExport.length;r++){var s=t.disabledForceExport[r];if(-1!=o.data.city.indexOf(s)||-1!=o.data.province.indexOf(s)||-1!=o.data.area.indexOf(s)){i=!0;break}}i&&(!t.forceExportTime||2!=t.forceExportTime.length||n>t.forceExportTime[0]&&n<t.forceExportTime[1])?e(!0):e(!1)},E.prototype.getMisTouchNum=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disableAd(o,t,function(t){t?(e(0),console.log("getMisTouchNum",0,"disableAd",t)):(e(parseInt(o.mistouchNum)),console.log("getMisTouchNum",o.mistouchNum,"disableAd",t))})})})},E.prototype.getMistouchPosNum=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disableAd(o,t,function(t){t?(e(0),console.log("getMistouchPosNum",0,"disableAd",t)):(e(parseInt(o.mistouchPosNum)),console.log("getMistouchPosNum",o.mistouchPosNum,"disableAd",t))})})})},E.prototype.getBannerShowCountLimit=function(o){this.loadCfg(function(t){isNaN(t.bannerShowCountLimit)?o(5):o(parseInt(t.bannerShowCountLimit))})},E.prototype.disableAd=function(t,o,e){var n=l.formatTime(new Date),i=!1;if(t&&t.disabledRegion)for(var r=0;r<t.disabledRegion.length;r++){var s=t.disabledRegion[r];if(o&&o.data&&(-1!=o.data.city.indexOf(s)||-1!=o.data.province.indexOf(s)||-1!=o.data.area.indexOf(s))){i=!0;break}}if(this.appLaunchOptions&&-1!=[1005,1007,1008,1044].indexOf(this.appLaunchOptions.scene))return e(!0),void console.log("appLaunchOptions",this.appLaunchOptions);i&&(!t.disabledTime||2!=t.disabledTime.length||n>t.disabledTime[0]&&n<t.disabledTime[1])?e(!0):e(!1)},E.prototype.getShareInfo=function(o){this.request(this.baseUrl+"admin/wx_share/getShare",{appid:l.config.moosnowAppId},"POST",function(t){console.log("分享数据",t.data),o(t.data),moosnow.platform.initShare(t.data)})},E);function E(){var o=F.call(this)||this;o.appid="",o.secret="",o.versionNumber="",o.version="2.0.1",o.baseUrl="https://api.liteplay.com.cn/",o._cdnUrl="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com",o.mLaunchOptions={},o.cfgData=null,o.areaData=null,o._cfgQuene=[],o._localQuene=[];var t=o._cdnUrl+"/SDK/version.json?t="+Date.now();return l.platform==i.PC?o.request(t,{},"GET",function(t){o.version<t.version&&(console.warn("您的SDK版本号["+o.version+"]不是最新版本，请尽快升级，最新版本["+t.version+"]  下载地址："+t.download),l.isEmpty(t.memo)||console.warn(""+t.memo))}):l.platform==i.WX&&window.wx&&o.request(t,{},"GET",function(t){(!window.wx.aldVersion||window.wx.aldVersion&&window.wx.aldVersion<t.aldVersion)&&console.error("阿拉丁文件错误，请重新下载"+t.aldUrl)}),o.getShareInfo(function(t){moosnow.platform.initShare(t)}),o.loadCfg(function(t){console.log("remote config ",t)}),o}var L,B=(t(x,L=C),x.prototype.initAdService=function(){var o;window[this.platformName]&&(o=this,window[this.platformName].initAdService?window[this.platformName].initAdService({isDebug:!0,appId:this.moosnowConfig.moosnowAppId,success:function(t){console.log("初始化广告"),o.initBanner(),o.initInter(),o._prepareNative()},fail:function(t){console.warn("初始化广告错误 "+t.code+"  "+t.msg)},complete:function(t){console.log("initAdService  complete")}}):(console.log("初始化广告"),o.initBanner(),o.initInter(),o._prepareNative()),moosnow.event.addListener(w.ON_PLATFORM_SHOW,this,this.onAppShow))},x.prototype.navigate2Mini=function(t,o,e,n){var i,r,s,a,h=this;console.log("跳转数据：",t),Date.now()-this.prevNavigate<300?console.log(" 跳转太频繁 >>>>>>>>>>>>>>>>>>>>> "):(this.prevNavigate=Date.now(),window[this.platformName]?(i=t.appid,r=t.path,a=t.extraData,s=t.pkgName,a=a||{},this.supportVersion(1044)?window[this.platformName].navigateToMiniGame({appId:i,path:r,pkgName:s||i,extraData:a,success:function(){window[h.platformName]&&window[h.platformName].aldSendEvent&&window[h.platformName].aldSendEvent("跳转",{position:t.position,appid:i,img:t.atlas||t.img}),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMiniProgram error ",t),e&&e()},complete:function(){n&&n()}}):console.log("版本过低 平台不支持跳转")):o&&o())},x.prototype.supportVersion=function(t){return this.getSystemInfoSync().platformVersion>=t},x.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode," msg ",t.errMsg),this.banner&&(this.banner.hide(),this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null)},x.prototype._prepareBanner=function(){var t,o;window[this.platformName].createBannerAd&&(o=(t=this.getSystemInfoSync()).windowWidth,(!this.isLandscape(t.windowHeight,t.windowWidth)||o<this.bannerWidth)&&(this.bannerWidth=o),this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide()),this.banner=this._createBannerAd(),this.banner.onResize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)),this.banner.onHide(this._onBannerHide.bind(this)))},x.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.windowWidth,e=t.windowHeight,n=(o-this.bannerWidth)/2;if(!l.isEmpty(this.bannerId)){var i=e-this.bannerHeigth;return window[this.platformName].createBannerAd({adUnitId:this.bannerId,style:{top:i,left:n,width:this.bannerWidth}})}console.warn("banner id is null")}},x.prototype._bottomCenterBanner=function(t){var o=this.getSystemInfoSync(),e=o.windowWidth,n=o.windowHeight,i=o.statusBarHeight,r=o.notchHeight||0;this.bannerWidth=t.width,this.bannerHeigth=t.height,this.banner.style.left=(e-t.width)/2;var s=n-this.bannerHeigth,s=this.bannerPosition==m.BOTTOM?n-this.bannerHeigth:this.bannerPosition==m.CENTER?(n-this.bannerHeigth)/2:this.bannerPosition==m.TOP?this.isLandscape(o.windowHeight,o.windowWidth)?0:i+r:this.bannerStyle.top;this.banner.style.top=s,console.log("_bottomCenterBanner  ",this.banner.style)},x.prototype._resetBanenrStyle=function(t){var o=this.getSystemInfoSync(),e=(o.windowWidth,o.windowHeight),n=o.statusBarHeight,i=o.notchHeight||0;isNaN(this.bannerWidth)||(this.banner.style.width=this.bannerWidth),isNaN(this.bannerHeight)||(this.banner.style.height=this.bannerHeight);var r=e-this.bannerHeigth,r=this.bannerPosition==m.BOTTOM?e-this.bannerHeigth:this.bannerPosition==m.CENTER?(e-this.bannerHeigth)/2:this.bannerPosition==m.TOP?this.isLandscape(o.windowHeight,o.windowWidth)?0:n+i:this.bannerStyle.top;this.banner.style.top=r,console.log("_resetBanenrStyle ",this.banner.style,"set styleTop ",r)},x.prototype._onBannerHide=function(){console.log("banner 已隐藏 ")},x.prototype.destroyBanner=function(){this.banner&&(this.banner.hide(),this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null)},x.prototype.showBanner=function(t,o,e){var n=this;void 0===o&&(o=m.BOTTOM),console.log("显示banner"),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.banner?(this._resetBanenrStyle({width:this.banner.style.width,height:this.banner.style.height}),this.banner.show(),setTimeout(function(){n._resetBanenrStyle({width:n.banner.style.width,height:n.banner.style.height})},500)):this.initBanner())},x.prototype.hideBanner=function(){console.log(v),this.isBannerShow&&window[this.platformName]&&(this.bannerShowCount++,this.banner?this.bannerShowCount>=this.bannerShowCountLimit?(console.log("banner destroy"),this.banner.hide(),this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null,console.log("重新创建banner"),this._prepareBanner()):this.banner.hide():this._prepareBanner(),this.isBannerShow=!1)},x.prototype.createRewardAD=function(t){if(!moosnow.platform.videoLoading)if(window[this.platformName]){if(window[this.platformName].createRewardedVideoAd){if(this.video)this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad);else{if(l.isEmpty(this.videoId))return void console.warn(" video id is null");this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.videoId})}this.video.onError(this._onVideoError.bind(this)),this.video.onClose(this._onVideoClose.bind(this)),this.video.onLoad(this._onVideoLoad.bind(this)),moosnow.platform.videoLoading=!0,this.video.load()}}else moosnow.platform.videoCb(f.END)},x.prototype._onVideoLoad=function(){console.log("加载video成功回调"),moosnow.platform.videoLoading=!1,this.video&&this.video.show()},x.prototype.prepareInter=function(){if(l.isEmpty(this.interId))console.warn("插屏广告ID为空，系统不加载");else if(window[this.platformName])if(this.supportVersion("1061")){if("function"!=typeof window[this.platformName].createInterstitialAd)return;this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()}else{if("function"!=typeof window[this.platformName].createInsertAd)return;this.inter=window[this.platformName].createInsertAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onShow(this._onInterOnShow.bind(this)),this.inter.load()}},x.prototype.showInter=function(){this.inter?this.inter.show():this.interLoadedShow=!0},x.prototype._onInterLoad=function(){this.interLoadedShow&&(this.inter?this.inter.show():this.interLoadedShow=!1)},x.prototype._onInterOnShow=function(){this.inter&&this.inter.load()},x.prototype.showAutoBanner=function(){console.log(" oppo 不支持自动")},x.prototype.reportMonitor=function(t,o){window[this.platformName]&&window[this.platformName].reportMonitor&&window[this.platformName].reportMonitor("game_scene",0)},x.prototype._prepareNative=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createNativeAd&&(this.native=window[this.platformName].createNativeAd({adUnitId:parseInt(""+this.nativeId[this.nativeIdIndex])}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this)),this.nativeLoading=!0)},x.prototype._onNativeLoad=function(t){this.nativeLoading=!1,console.log("加载原生广告成功",t),t&&t.adList&&0<t.adList.length?(this.nativeAdResult=t.adList[0],l.isEmpty(this.nativeAdResult.adId)||(console.log("上报原生广告"),this.native.reportAdShow({adId:this.nativeAdResult.adId})),l.isFunction(this.nativeCb)&&this.nativeCb(l.deepCopy(this.nativeAdResult))):(console.log("原生广告数据没有，回调Null"),l.isFunction(this.nativeCb)&&this.nativeCb(null))},x.prototype._onNativeError=function(t){this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log("原生广告加载出错 ",t,"使用新ID加载原生广告"),this.nativeIdIndex+=1,this._destroyNative(),this._prepareNative()):(console.log("原生广告ID已经用完，本次没有广告"),this.nativeIdIndex=0,l.isFunction(this.nativeCb)&&this.nativeCb(null)):(console.log("原生广告加载出错，本次没有广告",t),l.isFunction(this.nativeCb)&&this.nativeCb(null))},x.prototype._destroyNative=function(){this.nativeLoading=!1,this.native.offLoad(),this.native.offError(),this.native.destroy(),console.log("原生广告销毁")},x.prototype.showNativeAd=function(t){this.nativeCb=t,this.native&&this.native.load()},x.prototype.clickNative=function(t){this.nativeAdResult&&!l.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log("点击了原生广告",this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},x.prototype.onAppShow=function(){this.mIsClickedNative&&(this.mIsClickedNative=!1,l.isFunction(this.mClickedNativeCallback)&&this.mClickedNativeCallback())},x);function x(){var t=L.call(this)||this;return t.platformName="qg",t.appSid="",t.bannerWidth=760,t.bannerHeight=96,t.interLoadedShow=!1,t.prevNavigate=Date.now(),t.mIsClickedNative=!1,t._regisiterWXCallback(),t.initAdService(),t}var D,k=(t(R,D=u),R.prototype.initCoin=function(t){null==moosnow.setting._getValue(this.COIN,null)&&moosnow.setting.setValue(this.COIN,t)},R.prototype.getCoin=function(){return 0==this.mCoin&&(this.mCoin=moosnow.setting.getInt(this.COIN,0)),this.mCoin},R.prototype.subCoin=function(t){this.mCoin-=t,moosnow.event.sendEventImmediately(w.COIN_CHANGED,this.mCoin)},R.prototype.addCoin=function(t){this.mCoin+=t,moosnow.event.sendEventImmediately(w.COIN_CHANGED,this.mCoin)},R.prototype.setCoin=function(t){this.mCoin=t,moosnow.event.sendEventImmediately(w.COIN_CHANGED,this.mCoin)},R.prototype.saveCoin=function(){moosnow.setting.setValue(this.COIN,this.mCoin)},R.prototype.getToken=function(){return l.isEmpty(this.mUserToken)&&(this.mUserToken=moosnow.setting.getString(this.TOKEN,"")),this.mUserToken},R.prototype.setToken=function(t){moosnow.setting.setValue(this.TOKEN,t)},R.prototype.getCurrentMisTouchCount=function(){return this.mCurrentMisTouchCount},R.prototype.setCurrentMisTouchCount=function(t){this.mCurrentMisTouchCount=t},R.prototype.getChannelId=function(){return this.mChannel_id},R.prototype.setChannelId=function(t){this.mChannel_id=t},R.prototype.getChannelAppId=function(){return this.mChannel_appid},R.prototype.setChannelAppId=function(t){this.mChannel_appid=t},R.prototype.getVibrateSetting=function(){return moosnow.setting.getBool(this.VIBRATE_SWITCH,!0)},R.prototype.setVibrateSetting=function(t){moosnow.setting.setBool(this.VIBRATE_SWITCH,t),moosnow.event.sendEventImmediately(w.VIBRATESWITCH_CHANGED,t)},R);function R(){var t=null!==D&&D.apply(this,arguments)||this;return t.TOKEN="token",t.COIN="COIN",t.mUserToken="",t.VIBRATE_SWITCH="VIBRATE_SWITCH",t.mCoin=0,t.mCurrentMisTouchCount=0,t.mChannel_id="0",t.mChannel_appid="0",t}var U,M=(t(H,U=u),H.prototype.onEnable=function(){},H.prototype.getInt=function(t,o){var e=this._getValue(t,o);return parseInt(e)},H.prototype.getFloat=function(t,o){var e=this._getValue(t,o);return parseFloat(e)},H.prototype.getBool=function(t,o){var e=1==o?"true":"false";return"true"==this.getString(t,e)},H.prototype.getString=function(t,o){return this._getValue(t,o)},H.prototype.getObject=function(t,o){var e=this._getValue(t,o);return e&&""!=e?JSON.parse(e):null},H.prototype.setObject=function(t,o){var e="";o&&(e=JSON.stringify(o)),this.setValue(t,e)},H.prototype.setBool=function(t,o){1==o?this.setValue(t,"true"):this.setValue(t,"false")},H.prototype.setValue=function(t,o){window.localStorage.setItem(t,o)},H.prototype.appendInt=function(t,o){var e=this.getInt(t,0),n=parseInt(o)+e;return this.setValue(t,n),n},H.prototype.appendFloat=function(t,o){var e=this.getFloat(t,0),n=parseFloat(o)+e;this.setValue(t,n)},H.prototype.removeValueOfKey=function(t){window.localStorage.removeItem(t)},H.prototype.removeAll=function(){window.localStorage.clear()},H.prototype._getValue=function(t,o){var e=window.localStorage.getItem(t);return null!=e&&""!=e||(e=o),e},H);function H(){return U.call(this)||this}var V,W=(t(j,V=P),j.prototype.getRemoteAd=function(o){var t=this,e="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/exportConfig/"+moosnow.platform.moosnowConfig.moosnowAppId+".json?t="+Date.now();moosnow.http.request(e,{},"GET",function(t){o(t),console.log("WXAdModule getRemoteAd",t)},function(){V.prototype.getRemoteAd.call(t,o),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},j);function j(){return null!==V&&V.apply(this,arguments)||this}var z,G=(t(Q,z=P),Q.prototype.getRemoteAd=function(o){var e=this,t="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/exportConfig/"+moosnow.platform.moosnowConfig.moosnowAppId+".json?t="+Date.now();moosnow.http.request(t,{},"GET",function(t){o(t),console.log("WXAdModule getRemoteAd",t)},function(t){e.repairAd(o),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},Q.prototype.repairAd=function(o){var t=this.baseUrl+"wx_export/getExport",e={appid:moosnow.platform.moosnowConfig.moosnowAppId};moosnow.http.request(t,e,"POST",function(t){t.data.sort(function(){return.5<Math.random()?1:-1}),o&&o(t.data)},function(){o([]),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},Q);function Q(){return null!==z&&z.apply(this,arguments)||this}var q,X={ARTICLE:"article",VIDEO:"video",TOKEN:"token",LINK:""},K=function(){},Y=(t(Z,q=C),Z.prototype._registerTTCallback=function(){var o=this;window[this.platformName]&&(window[this.platformName].onMoreGamesModalClose&&window[this.platformName].onMoreGamesModalClose(function(t){console.log("modal closed",t),o.moreGameCb&&o.moreGameCb(t)}),window[this.platformName].onNavigateToMiniGameBox?window[this.platformName].onNavigateToMiniGameBox(function(t){console.log("onNavigateToMiniGameBox",t)}):window[this.platformName].onNavigateToMiniProgram&&window[this.platformName].onNavigateToMiniProgram(function(t){console.log("onNavigateToMiniProgram",t)}))},Z.prototype.prepareInter=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createInterstitialAd&&(l.isEmpty(this.interId)?console.warn("插屏广告ID为空，系统不加载"):(this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()))},Z.prototype._bottomCenterBanner=function(t){var o,e,n,i;this.bannerWidth!=t.width&&(e=(o=this.getSystemInfoSync()).windowWidth,n=o.windowHeight,this.bannerWidth=t.width,this.bannerHeigth=this.bannerWidth/16*9,i=n-this.bannerHeigth-30,console.log("bannerWidth ",this.bannerWidth,"bannerHeigth",this.bannerHeigth,"top",i),this.banner&&(this.banner.style.top=i,this.banner.style.left=(e-t.width)/2))},Z.prototype.initRecord=function(){window[this.platformName]&&window[this.platformName].getGameRecorderManager&&(this.record=window[this.platformName].getGameRecorderManager())},Z.prototype.clipRecord=function(){this.record&&(this.recordNumber++,console.log("clipRecord",this.recordNumber),this.record.recordClip({timeRange:[2,2],success:function(t){console.log("clipRecord 成功 ",t)}}))},Z.prototype.startRecord=function(t,o){var e=this;void 0===t&&(t=300),void 0===o&&(o=null),console.log("record startRecord"),this.record?(this.recordNumber=0,this.recordCb=null,this.recordRes=null,this.record.onStart(function(t){console.log("record onStart"),o&&o(t)}),this.recordRes,this.record.onStop(function(t){console.log("on stop ",t),4<=e.recordNumber?e.record.clipVideo({path:t.videoPath,success:function(t){console.log("record clip succes:",t),e.recordRes=t,console.log("record clip recordRes :",e.recordRes),e.recordCb&&e.recordCb(t)},fail:function(){console.log("record clip fail:",t),e.recordRes=t,e.recordCb&&e.recordCb(t)}}):(e.recordRes=t,e.recordCb&&e.recordCb(t))}),this.record.start({duration:t})):o&&o(!1)},Z.prototype.stopRecord=function(t){void 0===t&&(t=null),console.log(" stop Record  callback  ",!!t),this.record?(console.log("record stop recordRes ",this.recordRes),this.recordRes?l.isFunction(t)&&t(this.recordRes):(this.recordCb=t,this.record.stop(),console.log("record stop  ",this.recordRes))):t&&t(!1)},Z.prototype.pauseRecord=function(){this.record&&this.record.pause()},Z.prototype.resumeRecord=function(){this.record&&this.record.resume()},Z.prototype.share=function(t,o){void 0===t&&(t={}),this.currentShareCallback=o;var e=this._buildShareInfo(t);console.log("shareInfo:",e),window[this.platformName]&&window[this.platformName].shareAppMessage?window[this.platformName].shareAppMessage(e):this.currentShareCallback(!0)},Z.prototype._buildShareInfo=function(t){var o,e=this,n="",i="";0<this.shareInfoArr.length&&(n=(o=this.shareInfoArr[a.randomNumBoth(0,this.shareInfoArr.length-1)]).title,i=o.img);var r=X.LINK;t&&-1!=[X.LINK,X.ARTICLE,X.TOKEN,X.VIDEO].indexOf(t.channel)&&(r=t.channel);var s=this.recordRes&&this.recordRes.videoPath?this.recordRes.videoPath:"";return console.log("video path ",s),{channel:r,title:n,imageUrl:i,query:moosnow.http._object2Query(t),extra:{videoPath:s,videoTopics:[n]},success:function(){console.log("share video success "),e.currentShareCallback&&e.currentShareCallback(!0)},fail:function(t){console.log("share video success ",t),e.currentShareCallback&&e.currentShareCallback(!1)}}},Z.prototype._onBannerLoad=function(){this.bannerShowCount=0,this.mBannerLoaded=!0,this.isBannerShow&&this.showBanner()},Z.prototype._prepareBanner=function(){this.mBannerLoaded=!1,q.prototype._prepareBanner.call(this)},Z.prototype._resetBanenrStyle=function(t){var o,e,n;l.isEmpty(t)?console.log("设置的banner尺寸为空,不做调整"):((o=this.getSystemInfoSync()).windowWidth,e=o.windowHeight,n=0,this.bannerPosition==m.BOTTOM?n=e-this.bannerHeigth-30:this.bannerPosition==m.CENTER?n=(e-this.bannerHeigth)/2:this.bannerPosition==m.TOP&&(n=0),this.bannerStyle?this.banner.style=this.bannerStyle:(this.banner.style.top=n,console.log("banner位置或大小被重新设置 ",this.banner.style,"set top ",n)))},Z.prototype.showBanner=function(t,o,e){var n=this;void 0===o&&(o=m.BOTTOM),console.log("显示banner"),this.bannerCb=t,this.isBannerShow=!0,this.mBannerLoaded&&window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=e,this.banner&&(console.log("show banner style ",this.banner.style),this.banner.hide(),this._resetBanenrStyle({width:this.banner.style.width,height:this.banner.style.realHeight}),this.banner.show().then(function(){n._resetBanenrStyle({width:n.banner.style.width,height:n.banner.style.realHeight})})))},Z.prototype.showAppBox=function(t,o){var e=this;void 0===o&&(o=!0),this.moreGameCb=t,window[this.platformName]&&window[this.platformName].showMoreGamesModal&&moosnow.http.getAllConfig(function(t){(!o||t&&1==t.showAppBox)&&e._showMoreGamesModal()})},Z.prototype._getAppLaunchOptions=function(o){var e=[];moosnow.ad.getAd(function(t){0!=t.indexLeft.length&&(t.indexLeft.forEach(function(t){var o=new K;o.appId=t.appid,o.query=t.path||"1=1",o.extraData=t.extraData||{},e.push(o)}),console.log("appLaunchOptions",e),o(e))})},Z.prototype._showMoreGamesModal=function(){var o=this;"ios"!=this.getSystemInfoSync().platform&&this._getAppLaunchOptions(function(t){console.log("_showMoreGamesModal appLaunchOption",t),window[o.platformName].showMoreGamesModal({appLaunchOptions:t,success:function(t){console.log("show app box success",t)},fail:function(t){console.log("show app box fail",t)}})})},Z.prototype.showMoreGameBanner=function(){var t,e,o;window[this.platformName]&&(!window[this.platformName].createMoreGamesBanner||"ios"!=(t=this.getSystemInfoSync()).platform&&"ios"!==t.platform&&(e=[],moosnow.ad.getAd(function(t){0!=t.indexLeft.length&&t.indexLeft.forEach(function(t){var o=new K;o.appId=t.appid,o.query=t.path||"1=1",o.extraData=t.extraData||{},e.push(o)})}),(o=window[this.platformName].createMoreGamesBanner({style:{left:20,top:0,width:150,height:40},appLaunchOptions:e,success:function(t){console.log("show app box success",t.errMsg)},fail:function(t){console.log("show app box fail",t.errMsg)}})).show(),o.onTap(function(){console.log("点击跳转游戏盒子")})))},Z.prototype.showMoreGameButton=function(t,n,o){var e,i,r=this;void 0===o&&(o=null),window[this.platformName]&&window[this.platformName].createMoreGamesButton&&(e={left:this.getSystemInfoSync().windowWidth-80-30,top:40,width:80,height:80,lineHeight:80,backgroundColor:"#ff0000",textColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:0,borderWidth:1,borderColor:"#ff0000"},i=p(p({},e),o),this._moreGameBotton?this._moreGameBotton.show():this._getAppLaunchOptions(function(e){cc.loader.loadRes("texture/game/more.png",cc.Texture2D,function(t,o){t||(r._moreGameBotton=window[r.platformName].createMoreGamesButton({type:"image",image:o.url,actionType:"box",style:i,appLaunchOptions:e,onNavigateToMiniGame:function(t){console.log("跳转其他小游戏",t),n&&n(1,t)}}),r._moreGameBotton.show(),r._moreGameBotton.onTap(function(){console.log("点击更多游戏"),n&&n(2,null)}))})}))},Z.prototype.hideMoreGameButton=function(){this._moreGameBotton&&this._moreGameBotton.hide()},Z.prototype.isIphone=function(){return!!window[this.platformName]&&"ios"==this.getSystemInfoSync().platform},Z.prototype.navigate2Mini=function(t,o,e,n){console.log("tt navigate2Mini "),this.showAppBox(function(){console.log("tt showAppBox close ")},!1)},Z);function Z(){var t=q.call(this)||this;return t.platformName="tt",t.recordRes=null,t.recordCb=null,t.recordNumber=0,t.bannerWidth=208,t.moreGameCb=null,t.mBannerLoaded=!1,t._regisiterWXCallback(),t._registerTTCallback(),t.initBanner(),t.initRecord(),t.initInter(),t}var J,$=(t(tt,J=C),tt.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.bannerHeigth=Math.round(this.bannerWidth/300*72.8071),o=this.getSystemInfoSync(),e=o.screenWidth,n=o.screenHeight,i=(e-this.bannerWidth)/2,r=n-t/2;if(!l.isEmpty(this.bannerId)){console.log("create banner by banner id ",this.bannerId);var s={top:r,left:i,width:this.bannerWidth,height:t};return console.log("create banner style ",s),window[this.platformName].createBannerAd({adUnitId:this.bannerId,style:s})}console.warn("banner id is null")}},tt.prototype.showBanner=function(t,o,e){var n,i=this;void 0===o&&(o=m.BOTTOM),console.log("显示banner"),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=e,this._resetBanenrStyle({}),!this.banner||(n=this.banner.show())&&n.then(function(){i._resetBanenrStyle({})}))},tt.prototype._bottomCenterBanner=function(t){console.log("Resize后正式宽高:",t.width,t.height)},tt.prototype._resetBanenrStyle=function(t){var o=this.getSystemInfoSync(),e=(o.windowWidth,o.windowHeight),n=0,n=this.bannerPosition==m.BOTTOM?e-this.bannerHeigth:this.bannerPosition==m.CENTER?(e-this.bannerHeigth)/2:this.bannerPosition==m.TOP?0:this.bannerStyle.top;this.banner&&this.banner.style&&(this.banner.style.top=n)},tt.prototype.showAppBox=function(t,o){var e=this;void 0===o&&(o=!0),window[this.platformName]&&window[this.platformName].createAppBox&&(this.mOnBoxCallback=t,console.log("showAppBox"),moosnow.http.getAllConfig(function(t){!o||t&&1==t.showAppBox?(e.box||(e.box=window[e.platformName].createAppBox({adUnitId:e.moosnowConfig.boxId}),e.box.onClose(e.onBoxClose.bind(e))),e.box.load().then(function(){e.box.show()})):(l.isFunction(e.mOnBoxCallback)&&e.mOnBoxCallback(-1),console.log("后台不允许显示Box，如有需要请联系运营"))}))},tt.prototype.hideAppBox=function(t){var o,e=this;this.box&&(this.box.offClose(this.onBoxClose),o=this.box.destroy(),console.log("box destroy ",o),o&&o.then(function(){console.log("destroy successfully ",o),e.box=null,l.isFunction(t)&&t(!0)}).catch(function(){console.log("destroy fail ",o),e.box=null,l.isFunction(t)&&t(!1)}))},tt.prototype.onBoxClose=function(){l.isFunction(this.mOnBoxCallback)&&this.mOnBoxCallback(0)},tt);function tt(){var t=J.call(this)||this;return t.platformName="qq",t._regisiterWXCallback(),t.initBanner(),t}var ot,et=function(){this.appid="",this.boxAppid="",this.desc="",this.img="",this.path="",this.title="",this.atlas="",this.pkgName="",this.extraData="",this.position="",this.onCancel=null,this.index=0,this.refresh=!1},nt=(t(it,ot=P),it.prototype.getRemoteAd=function(s){var t={apk_id:moosnow.platform.moosnowConfig.moosnowAppId};moosnow.http.request("https://platform.qwpo2018.com/api/apk_ad/index",t,"POST",function(t){var o=t.data;if(o.sort(function(){return.5<Math.random()?1:-1}),console.log("接口数据",t.data),s){for(var e=[],n=0;n<o.length;n++){var i=o[n],r=new et;r.appid=i.link_appid,r.img=i.link_img,r.path=i.link_path,r.title=i.link_name,r.pkgName=i.link_page,r.desc=i.link_des,e.push(r)}s(e)}},function(){s([]),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},it);function it(){return null!==ot&&ot.apply(this,arguments)||this}var rt,st=(t(at,rt=B),at.prototype.checkVersion=function(t,e){var n=this;moosnow.http.loadCfg(function(t){var o=rt.prototype.checkLog.call(n,t.zs_version);e(o)})},at.prototype.login=function(o,e){window[this.platformName]?window[this.platformName].login({success:function(t){moosnow.http.request("https://platform.qwpo2018.com/api/oppo_login/index",{apk_id:moosnow.platform.moosnowConfig.moosnowAppId,code:t.data.token},"POST",function(t){moosnow.data.setToken(t.data.user_id),o&&o(t.data),console.log("platformLogin success ",t)},function(t){o&&o(null),console.log("platformLogin fail ",t)})},fail:function(t){e&&e(t)}}):o&&o()},at.prototype.navigate2Mini=function(t,o,e,n){var i=this;rt.prototype.navigate2Mini.call(this,t,function(){i.navigateCallback(t.appid),l.isFunction(o)&&o()},e,n)},at.prototype.navigateCallback=function(t){var o={user_id:moosnow.data.getToken(),apk_id:moosnow.platform.moosnowConfig.moosnowAppId,appid:t,link_id:t};console.log("跳转数据上报",o),moosnow.http.request("https://platform.qwpo2018.com/api/apk_ad/click_log",o,"POST",function(t){console.log("跳转数据上报成功",t)},function(t){console.log("跳转数据上报失败",t)},function(){console.log("upload navigate complete")})},at);function at(){return null!==rt&&rt.apply(this,arguments)||this}var ht,lt=(t(ct,ht=C),ct.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.screenWidth,e=t.screenHeight;if(!l.isEmpty(this.bannerId))return window[this.platformName].createBannerAd({adUnitId:this.bannerId,appSid:this.appSid,style:{top:e,width:o}});console.warn("banner id is null")}},ct.prototype.createRewardAD=function(t){var o=this;this.videoLoading||window[this.platformName].createRewardedVideoAd&&(this.video?(this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad)):this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.videoId,appSid:this.appSid}),this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad),this.videoLoading=!0,this.video.load().then(function(){t&&o.video.show().then(function(){}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))},ct.prototype.initRecord=function(){var t;window[this.platformName]&&(t=this.getSystemInfoSync().brand.toLowerCase(),/huawei/.test(t)||/honor/.test(t)||(this.record=window[this.platformName].getVideoRecorderManager()))},ct.prototype.startRecord=function(t,o){var e=this;void 0===t&&(t=120),void 0===o&&(o=null),console.log("record startRecord"),this.recordRes=null,this.recordCb=null,this.record?(this.record.onStart(function(t){console.log("record onStart"),o&&o(t)}),this.record.onStop(function(t){e.recordRes=t,e.recordCb&&(console.log("stop 2"),e.recordCb(t))}),this.record.start({duration:t})):o&&o(!1)},ct.prototype.stopRecord=function(t){void 0===t&&(t=null),console.log("record stopRecord"),this.record?this.recordRes?(console.log("stop 1"),t(this.recordRes)):(this.recordCb=t,this.record.stop()):t&&t(!1)},ct);function ct(){var t=ht.call(this)||this;return t.platformName="swan",t.bannerId="",t.videoId="",t.appSid="",t.recordRes=null,t.recordCb=null,t}var pt,ut=(t(dt,pt=T),dt.prototype.getMisTouchNum=function(o){this.loadCfg(function(t){o(parseInt(t.mistouchNum))})},dt.prototype.getMistouchPosNum=function(o){this.loadCfg(function(t){o(parseInt(t.mistouchPosNum))})},dt.prototype.getBannerShowCountLimit=function(o){this.loadCfg(function(t){isNaN(t.bannerShowCountLimit)?o(5):o(parseInt(t.bannerShowCountLimit))})},dt.prototype.getAllConfig=function(o){this.loadCfg(function(t){o(t)})},dt.prototype.loadCfg=function(e){var t,n=this;this.cfgData?e(this.cfgData):(t=moosnow.platform.moosnowConfig.url+"?t="+Date.now(),console.log("appid ",moosnow.platform.moosnowConfig.moosnowAppId),this.request(t,{apk_id:moosnow.platform.moosnowConfig.moosnowAppId},"POST",function(t){var o=t.data.zs_version==moosnow.platform.moosnowConfig.version;n.cfgData=p(p({},l.deepCopy(t.data)),{mistouchNum:t.data.zs_switch,mistouchPosNum:t.data.zs_switch,showNative:o,showInter:o,showExportAd:o,mx_native_click_switch:1==t.zs_native_click_switch,mx_jump_switch:1==t.zs_jump_switch,bannerShowCountLimit:isNaN(t.data.bannerShowCountLimit)?1:t.data.bannerShowCountLimit}),moosnow.platform&&(moosnow.platform.bannerShowCountLimit=parseInt(t.data.bannerShowCountLimit)),e(n.cfgData)},function(){e({}),console.log("load config json fail")}))},dt);function dt(){return null!==pt&&pt.apply(this,arguments)||this}var mt={FAIL:"请分享到群！"},ft={ERR:"视频正在加载中,请稍后",NOTEND:"请完整观看完视频！"},wt=(gt.prototype.shuffle=function(t){for(var o,e,n=t.length,i=n;i--;)i!==(e=Math.floor(Math.random()*n))&&(o=t[i],t[i]=t[e],t[e]=o);return t},gt.prototype.indexOf=function(t,o){for(var e=-1,n=0,i=t.length;n<i;n++)if(t[n]==o){e=n;break}return e},gt.prototype.replace=function(t,o,e){var n=t[o],i=t[e];t[e]=n,t[o]=i},gt.prototype.merge=function(t,o){for(var e=0,n=t.length;e<n;e++)o.push(t[e]);return o},gt.clone=function(t){return new Array,t.slice(0)},gt.remove=function(t,o){for(var e=0;e<t.length;e++)if(t[e]==o)return t.splice(e,1),void e--},gt);function gt(){}var yt,vt=(t(bt,yt=u),bt.prototype.addListener=function(t,o,e){this._addListener(t,o,!1,e)},bt.prototype.addToSendQueue=function(t,o){this._addToSendList(t,o)},bt.prototype.sendEventImmediately=function(t,o){this._sendEvent(t,o),this.onUpdate()},bt.prototype.removeListener=function(t,o){if(null!=t&&""!=t)for(var e=0;e<this._eventList.length;e++){var n=this._eventList[e];if(n.eventName===t){for(var i=0;i<n.listeners.length;i++){var r=n.listeners[i];if(r.target===o){wt.remove(n.listeners,r);break}}0==n.listeners.length&&wt.remove(this._eventList,n);break}}else console.error("eventName:"+t+"不合法！")},bt.prototype.removeAllListener=function(){this._eventList.length=0,this._eventList=[],this._waitingForSendList.length=0,this._waitingForSendList=[]},bt.prototype._addListener=function(t,o,e,n){if(null!=t&&""!=t){var i=new Nt;n instanceof Function?i.callback=n:console.error("callback不是一个方法"),o?i.target=o:console.error("target为空"),i.once=e;var r=!1;if(0<this._eventList.length){for(var s,a=0;a<this._eventList.length;a++){var h=this._eventList[a];if(t===h.eventName)return h.listeners.push(i),void(r=!0)}r||((s=new It).eventName=t,s.listeners.push(i),this._eventList.push(s))}else{var l=new It;l.eventName=t,l.listeners.push(i),this._eventList.push(l)}}else console.error("eventName:"+t+"不合法！")},bt.prototype._addToSendList=function(t,o){var e;null!=t&&""!=t?(e={eventName:t,data:o},this._waitingForSendList.push(e)):console.error("eventName:"+t+"不合法！")},bt.prototype._sendEvent=function(t,o){for(var e=this._eventList,n=0;n<e.length;n++){var i=e[n];if(i.eventName===t)for(var r=i.listeners,s=r.length-1;0<=s;s--){var a=r[s],h=a.callback,l=a.target;l?(h.call(l,o),a.once&&this._eventList[n].listeners[s]&&(wt.remove(this._eventList[n].listeners,a),n--)):(wt.remove(this._eventList[n].listeners,a),s--)}}},bt.prototype.onUpdate=function(){if(0!=this._waitingForSendList.length)for(var t=0;t<this._waitingForSendList.length;t++){var o=this._waitingForSendList[t];this._sendEvent(o.eventName,o.data),wt.remove(this._waitingForSendList,o),t--}},bt.prototype.onDisable=function(){},bt);function bt(){var t=yt.call(this)||this;return t._eventList=[],t._waitingForSendList=[],t._eventList=[],t._waitingForSendList=[],t}var Ct,Nt=function(){this.callback=null,this.target=[],this.once=!1,this.callback=null,this.target=null,this.once=!1},It=function(){this.eventName="",this.listeners=[],this.eventName="",this.listeners=[]},_t=(t(St,Ct=C),St.prototype.initAdService=function(){moosnow.event.addListener(w.ON_PLATFORM_SHOW,this,this.onAppShow)},St.prototype.navigate2Mini=function(t,o,e,n){var i,r,s,a,h=this;console.log("跳转数据：",t),Date.now()-this.prevNavigate<300?console.log(" 跳转太频繁 >>>>>>>>>>>>>>>>>>>>> "):(this.prevNavigate=Date.now(),window[this.platformName]?(i=t.appid,r=t.path,a=t.extraData,s=t.pkgName,a=a||{},this.supportVersion(1044)?window[this.platformName].navigateToMiniGame({appId:i,path:r,pkgName:s||i,extraData:a,success:function(){window[h.platformName]&&window[h.platformName].aldSendEvent&&window[h.platformName].aldSendEvent("跳转",{position:t.position,appid:i,img:t.atlas||t.img}),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMiniProgram error ",t),e&&e()},complete:function(){n&&n()}}):console.log("版本过低 平台不支持跳转")):o&&o())},St.prototype.supportVersion=function(t){return this.getSystemInfoSync().platformVersion>=t},St.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode," msg ",t.errMsg),this.destroyBanner()},St.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log("设备信息",this.systemInfo)),this.systemInfo},St.prototype._prepareBanner=function(){window[this.platformName].createBannerAd&&(this.banner&&(this.banner.offSize(),this.banner.offError(),this.banner.offLoad(),this.banner.offClose(),this.banner.destroy(),this.banner=null),this.banner=this._createBannerAd(),this.banner&&(this.banner.onSize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)),this.banner.onClose(this._onBannerClose.bind(this))))},St.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=Date.now();if(this.mShowTime||(this.mShowTime=t),!this.mShowTime||this.mShowTime&&t-this.mShowTime<=1e3*this.mMinInterval)console.log("banner创建太频繁了 "+this.mMinInterval+"秒内只能显示一次");else{this.mShowTime=Date.now();var o=this.getSystemInfoSync(),e=o.screenWidth,n=o.screenHeight,i=o.statusBarHeight,r=o.pixelRatio,s=this.getNotchHeight(),a=(e-this.bannerWidth)/r/2;if(!l.isEmpty(this.bannerId)){var h={top:this.bannerPosition==m.BOTTOM?(n-this.bannerHeight)/r:this.bannerPosition==m.CENTER?(n-this.bannerHeight)/r/2:this.bannerPosition==m.TOP?this.isLandscape(o.screenHeight,o.screenWidth)?0:i+s:this.bannerStyle.top,left:a,width:this.bannerWidth,height:this.bannerHeight};return console.log("_createBannerAd style",h,"screenHeight",n,"bannerHeigth",this.bannerHeigth),window[this.platformName].createBannerAd({posId:this.bannerId,style:h})}console.warn("banner id is null")}}},St.prototype.getNotchHeight=function(){var t=0;return window[this.platformName].getNotchHeightSync&&(t=window[this.platformName].getNotchHeightSync().height),t},St.prototype._bottomCenterBanner=function(t){console.log("onSize callback  ",t)},St.prototype._onBannerClose=function(){console.log("banner 已关闭 ")},St.prototype._onBannerHide=function(){console.log("banner 已隐藏 ")},St.prototype.destroyBanner=function(){this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offClose(this._onBannerClose),this.banner.destroy(),this.banner=null)},St.prototype.showBanner=function(t,o,e){var n;void 0===o&&(o=m.BOTTOM),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=e,this.banner||this.initBanner(),this.banner&&(n=this.banner.show(),console.log("显示banner style ",this.banner),n&&n.then(function(){console.log("banner广告展示成功")}).catch(function(t){switch(t.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log("加载广告失败，重新加载广告");break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(t))}})))},St.prototype.hideBanner=function(){console.log(v),this.isBannerShow&&window[this.platformName]&&(this.bannerShowCount++,this.banner&&(this.banner.hide(),this.destroyBanner()),this.isBannerShow=!1)},St.prototype.createRewardAD=function(t){moosnow.platform.videoLoading||(window[this.platformName]?window[this.platformName].createRewardedVideoAd&&(l.isEmpty(this.videoId)?console.warn(" video id is null"):this.video?this.video.load():(moosnow.platform.videoLoading=!0,this.video=window[this.platformName].createRewardedVideoAd({posId:this.videoId}),this.video.onError(this._onVideoError.bind(this)),this.video.onClose(this._onVideoClose.bind(this)),this.video.onLoad(this._onVideoLoad.bind(this)))):moosnow.platform.videoCb(f.END))},St.prototype._onVideoLoad=function(){var t=this;console.log("加载video成功回调"),moosnow.platform.videoLoading=!1,this.video&&this.video.show().then(function(){t.videoPlaying=!0,moosnow.event.sendEventImmediately(w.ON_PLATFORM_HIDE,{}),console.log("激励视频广告展示完成")}).catch(function(t){console.log("激励视频广告展示失败",JSON.stringify(t))})},St.prototype._onVideoClose=function(t){var o;console.log("video结束回调",t.isEnded),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,t.isEnded&&moosnow.http.clickVideo(),moosnow.event.sendEventImmediately(w.ON_PLATFORM_SHOW,{}),moosnow.platform.videoCb&&(o=t.isEnded?f.END:f.NOTEND,setTimeout(function(){moosnow.platform.videoCb(o)},50))},St.prototype.prepareInter=function(){if(l.isEmpty(this.interId))console.warn("插屏广告ID为空，系统不加载");else if(window[this.platformName])if(this.supportVersion("1061")){if("function"!=typeof window[this.platformName].createInterstitialAd)return;this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()}else{if("function"!=typeof window[this.platformName].createInsertAd)return;this.inter=window[this.platformName].createInsertAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onShow(this._onInterOnShow.bind(this)),this.inter.load()}},St.prototype.showInter=function(){this.inter?this.inter.show():this.interLoadedShow=!0},St.prototype._onInterLoad=function(){this.interLoadedShow&&(this.inter?this.inter.show():this.interLoadedShow=!1)},St.prototype._onInterOnShow=function(){this.inter&&this.inter.load()},St.prototype.showAutoBanner=function(){console.log(" vivo 不支持自动")},St.prototype.reportMonitor=function(t,o){window[this.platformName]&&window[this.platformName].reportMonitor&&window[this.platformName].reportMonitor("game_scene",0)},St.prototype._prepareNative=function(t){void 0===t&&(t=!1),window[this.platformName]&&"function"==typeof window[this.platformName].createNativeAd&&(this.native=window[this.platformName].createNativeAd({posId:this.nativeId[this.nativeIdIndex]}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this)),this.nativeLoading=!0,t&&this.native.load())},St.prototype._onNativeLoad=function(t){this.nativeLoading=!1,console.log("加载原生广告成功",t),t&&t.adList&&0<t.adList.length?(this.nativeAdResult=t.adList[0],l.isEmpty(this.nativeAdResult.adId)||(console.log("上报原生广告"),this.native.reportAdShow({adId:this.nativeAdResult.adId})),l.isFunction(this.nativeCb)&&this.nativeCb(l.deepCopy(this.nativeAdResult))):(console.log("原生广告数据没有，回调Null"),l.isFunction(this.nativeCb)&&this.nativeCb(null))},St.prototype._onNativeError=function(t){this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log("原生广告加载出错 ",t,"使用新ID加载原生广告"),this.nativeIdIndex+=1,this._destroyNative(),this._prepareNative()):(console.log("原生广告ID已经用完，本次没有广告"),this.nativeIdIndex=0,l.isFunction(this.nativeCb)&&this.nativeCb(null)):(console.log("原生广告加载出错，本次没有广告",t),l.isFunction(this.nativeCb)&&this.nativeCb(null))},St.prototype._destroyNative=function(){this.nativeLoading=!1,this.native.offLoad(),this.native.offError(),this.native.destroy(),console.log("原生广告销毁")},St.prototype.showNativeAd=function(t){this.nativeCb=t,this.native?this.native.load():this._prepareNative(!0)},St.prototype.clickNative=function(t){this.nativeAdResult&&!l.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log("点击了原生广告",this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},St.prototype.onAppShow=function(){this.mIsClickedNative&&(this.mIsClickedNative=!1,l.isFunction(this.mClickedNativeCallback)&&this.mClickedNativeCallback())},St);function St(){var t=Ct.call(this)||this;return t.platformName="qg",t.appSid="",t.bannerWidth=720,t.bannerHeight=113,t.interLoadedShow=!1,t.prevNavigate=Date.now(),t.mMinInterval=10,t.mIsClickedNative=!1,t._regisiterWXCallback(),t.initAdService(),t}var At,Pt={NONE:0,BANNER:1,FLOAT:2,SIDE:4,CENTER:8,EXPORT:16,BACK:32,MASK:64,WAIT:128,LEFTRIGHT:256,EXPORT_FIXED:512,EXTEND1:1024,EXTEND2:2048,EXTEND3:4096,EXTEND4:8192,TOP:32768,RECOVER:16384},Ot=(t(Ft,At=u),Ft.prototype.update=function(t){if(!this.paused)for(var o=0;o<this.entityLogics.length;o++)this.entityLogics[o].onFwUpdate(t)},Ft.prototype.pause=function(){this.paused=!0},Ft.prototype.resume=function(){this.paused=!1},Ft.prototype.getAllEntity=function(o){return this.entityLogics.filter(function(t){return t.poolName==o})},Ft.prototype.showEntity=function(t,o,e){},Ft.prototype.hideEntity=function(t,o,e){void 0===e&&(e=!1)},Ft.prototype.hideAllEntity=function(t,o){void 0===o&&(o=!1)},Ft);function Ft(){var t=At.call(this)||this;return t.entityLogics=[],t._serializeId=0,t.paused=!0,t.prefabPath="prefab/entity/",t.mEntity3DPools=[],t.mEntity3DLogics=[],t.entityPools=[],t.mIsSlow=!0,t.entityLogics=[],t.mEntity3DPools=[],t.mEntity3DLogics=[],t._serializeId=0,t}var Tt,Et=(t(Lt,Tt=Ot),Lt.prototype.preload=function(t,e){cc.loader.loadRes(this.prefabPath+""+t,cc.Prefab,function(t,o){e&&e(t,o)})},Lt.prototype.showEntity=function(t,o,e){var n=this._showEntity(t);return n.id=this._serializeId--,n.node.parent=o,n.willShow(e),n.node.active=!0,n.node.zIndex=n.id,n.onShow(e),this.entityLogics.push(n),n},Lt.prototype._createEntity=function(t){var o=l.isString(t)?this._getPrefabByName(t):t;return cc.instantiate(o)},Lt.prototype._showEntity=function(t){var o=this._getOrNewEntityPool(t),e=o.get();null==e&&(e=this._createEntity(t));var n=this._findComponent(e,"EntityLogic");return n.poolName=o.name,n},Lt.prototype._getPrefabByName=function(t){return cc.loader.getRes(this.prefabPath+""+t,cc.Prefab)},Lt.prototype._getOrNewEntityPool=function(t){var o=this._getPoolName(t),e=this._getEntityPool(o);return null==e&&(e=this._newEntityPool(o)),e},Lt.prototype._getPoolName=function(t){var o=l.getEngine();return o==r&&l.isObject(t)?t.name:o==s&&l.isObject(t)?t.json.name:""+t},Lt.prototype._getEntityPool=function(t){for(var o=0;o<this.entityPools.length;o++){var e=this.entityPools[o];if(e.name===t)return e}return null},Lt.prototype._newEntityPool=function(t){var o=new cc.NodePool(t);return o.name=t,this.entityPools.push(o),o},Lt.prototype.hideEntity=function(t,o,e){void 0===e&&(e=!1),this._hideEntity(t,o,e)},Lt.prototype.hideAllEntity=function(t,o){void 0===o&&(o=!1);for(var e=0;e<this.entityLogics.length;e++){var n=this.entityLogics[e];n.poolName==t&&(this.hideEntity(n,null,o),e--)}},Lt.prototype._hideEntity=function(t,o,e){var n;void 0===e&&(e=!1),e?(t.willHide(o),t.node.active=!1,t.onHide(o),t.destroy()):(n=this._getOrNewEntityPool(t.poolName),t.willHide(o),n.put(t.node),t.node.active=!1,t.onHide(o)),cc.js.array.remove(this.entityLogics,t)},Lt);function Lt(){var t=null!==Tt&&Tt.apply(this,arguments)||this;return t.prefabPath="moosnow/prefab/entity/",t}var Bt,xt=function(){this.name="",this.node=null,this.UIForm=null,this.zIndex=0,this.name="",this.node=null,this.UIForm=null,this.zIndex=0},Dt=(t(kt,Bt=u),kt.prototype.showToast=function(e){var n=this,i=this;null==i.toastForm?this._createUINode("toastForm",1e3,function(t,o){cc.Canvas.instance.node.addChild(t),i.toastForm=n._findComponent(t,"toastForm"),t.zIndex=o,i.toastForm.show(e)}):i.toastForm.show(e)},kt.prototype.pushUIForm=function(t,o,e){var n=this,i=this._getUINodeFromCacheByName(t);null==i?this._createUIFormModel(t,function(t){n._showUIForm(t,o),e&&e(t,o)}):(i.zIndex=this.layerIndex++,this.UIFormStack.push(i),this._showUIForm(i,o),e&&e(i,o))},kt.prototype.pop=function(t,o){var e;void 0===t&&(t=!1),0!=this.UIFormStack.length&&(e=this.UIFormStack.pop(),t?this._destroyUIForm(e,null):this._hideUIForm(e,null,o))},kt.prototype.getUIFrom=function(t){for(var o=0;o<this.UIFormStack.length;o++){var e=this.UIFormStack[o];if(e.name==t)return e.UIForm}},kt.prototype.hideUIForm=function(t,o,e){if("string"==typeof t)for(var n=0;n<this.UIFormStack.length;n++)(i=this.UIFormStack[n]).name==t&&this._hideUIForm(i,o,e);else for(var i,n=0;n<this.UIFormStack.length;n++)(i=this.UIFormStack[n])==t&&this._hideUIForm(i,o,e)},kt.prototype.hideAllUIForm=function(){for(var t=this.UIFormStack.length-1;0<=t;t--){var o=this.UIFormStack[t];this._hideUIForm(o,null)}},kt.prototype.destroyUIForm=function(t,o){for(var e=0;e<this.UIFormStack.length;e++){var n=this.UIFormStack[e];n.name==t&&this._destroyUIForm(n,o)}},kt.prototype._formatUIFormName=function(t){return t.replace(/\//g,"_")},kt.prototype._createUINode=function(t,n,i){var o=this.UIRoot+t;cc.loader.loadRes(o,cc.Prefab,function(t,o){var e=cc.instantiate(o);i&&i(e,n)})},kt.prototype._createUIFormModel=function(r,s){var a=this,h=this,l=new xt;l.name=r;var t=this.layerIndex++;l.zIndex=t,this.UIFormStack.push(l),this._createUINode(r,t,function(t,o){for(var e=0;e<h.UIFormStack.length;e++){var n=h.UIFormStack[e];if(n.zIndex==o&&n.name==t.name){if(null==t)return void a._removeStack(e);var i=a._findComponent(t,"UIForm");return i.formName=r,n.UIForm=i,n.node=t,void(s&&s(l))}}})},kt.prototype._getUINodeFromCacheByName=function(t){for(var o=0;o<this.cachedUIForms.length;o++){var e=this.cachedUIForms[o];if(null!=e.node&&e.name==t)return this.cachedUIForms.splice(o,1),e}return null},kt.prototype._showUIForm=function(t,o){var e;cc.Canvas.instance.node.addChild(t.node),t.UIForm.willShow(o),t.node.active=!0,o&&!isNaN(o.zIndex)?t.node.zIndex=o.zIndex:t.node.zIndex=t.zIndex,t.UIForm.onShow(o),t.UIForm.isPopEffect&&(e=t.node,l.popOpenAnim(e))},kt.prototype._hideUIForm=function(t,o,e){var n;t.UIForm.willHide(o),t.UIForm.onHide(o),this._removeStack(t),this.cachedUIForms.push(t),t.UIForm.isPopEffect?(n=t.node,l.popCloseAnim(n,function(){t.node.active=!1,t.node.removeFromParent(!1),e&&e()})):t.UIForm.hideAnim(function(){t.node.active=!1,t.node.removeFromParent(!1),e&&e()})},kt.prototype._destroyUIForm=function(t,o){t.UIForm.willHide(o),t.node.removeFromParent(),t.UIForm.onHide(o),t.node.active=!1,this._removeStack(t),t.node.destroy()},kt.prototype._removeStack=function(e){var n=this;isNaN(e)?this.UIFormStack.forEach(function(t,o){t==e&&n.UIFormStack.splice(o,1)}):this.UIFormStack.splice(e,1)},kt);function kt(){var t=Bt.call(this)||this;return t.rootCanvas=null,t.layerIndex=0,t.UIRoot="",t.UIFormStack=[],t.cachedUIForms=[],t.toastForm=null,t.layerIndex=0,t.UIRoot="moosnow/prefab/ui/",t.UIFormStack=[],t.cachedUIForms=[],t.toastForm=null,t}var Rt,Ut=(t(Mt,Rt=Dt),Mt);function Mt(){return null!==Rt&&Rt.apply(this,arguments)||this}var Ht,Vt=(t(Wt,Ht=u),Object.defineProperty(Wt.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Wt.prototype.initForm=function(t){this.initProperty(t)},Wt.prototype.willShow=function(t){this.mFormData=t},Wt.prototype.onShow=function(t){},Wt.prototype.willHide=function(t){},Wt.prototype.onHide=function(t){},Wt);function Wt(){return null!==Ht&&Ht.apply(this,arguments)||this}var jt,zt=(t(Gt,jt=Vt),Gt.prototype.setPosition=function(t,o,e,n){void 0===o&&(o=""),void 0===n&&(n=!1);var i=l.deepCopy(t);return i.forEach(function(t){t.position=o,t.onCancel=e,t.refresh=n}),i},Gt.prototype.loadAd=function(t,o){var e=this;moosnow.entity.preload(t,function(){moosnow.ad.getAd(function(t){0!=(e.mAdData=t).indexLeft.length&&o&&o(t)})})},Gt.prototype.initView=function(t,o,n,e,i,r){var s=this;i?this.loadAd(i,function(t){s.setPosition(t.indexLeft,e,r).forEach(function(t,o){var e=moosnow.entity.showEntity(i,n.node,t);s.mAdItemList.push(e)}),s.pushScroll(o,n)}):console.warn("entityName is null 无法初始化 ")},Gt.prototype.pushScroll=function(t,o){},Gt.prototype.addEvent=function(){moosnow.event.addListener(w.AD_VIEW_CHANGE,this,this.onAdChange)},Gt.prototype.removeEvent=function(){moosnow.event.removeListener(w.AD_VIEW_CHANGE,this)},Gt.prototype.onAdChange=function(t){this.mChangeLen++,1<this.mChangeLen&&t.showAd!=Pt.RECOVER&&(this.mPrevShowAd=this.mShowAd),t.showAd==Pt.RECOVER&&(t.showAd=this.mPrevShowAd),this.displayChange(t.showAd,t.callback),this.onAfterShow(this.mIndex)},Gt.prototype.onAfterShow=function(t){},Gt.prototype.willShow=function(t){jt.prototype.willShow.call(this,t),this.mAdItemList=[],this.mScrollVec=[],this.addEvent(),t?this.displayChange(t.showAd,t.callback):this.displayChange(Pt.NONE,null)},Gt.prototype.displayChange=function(t,o){void 0===o&&(o=null);var e=moosnow.getAppPlatform();moosnow.APP_PLATFORM.WX==e||e==moosnow.APP_PLATFORM.OPPO||e==moosnow.APP_PLATFORM.BYTEDANCE?(this.mShowAd=t,this.displayAd(!0),this.mBackCall=o):this.onBack()},Gt.prototype.onBack=function(){this.mBackCall&&this.mBackCall()},Gt.prototype.sideOut=function(){var t=this,o=moosnow.platform.getSystemInfoSync(),e=0,n=0;o&&(e=o.statusBarHeight||0,n=o.notchHeight||0),this.sideView.node.runAction(cc.sequence(cc.moveTo(1,e+n+this.sideView.node.width+20,0),cc.callFunc(function(){t.btnSideShow.active=!1,t.btnSideHide.active=!0})))},Gt.prototype.sideIn=function(){var t=this;this.sideView.node.runAction(cc.sequence(cc.moveTo(1,0,0),cc.callFunc(function(){t.btnSideShow.active=!0,t.btnSideHide.active=!1})))},Gt.prototype.initFiexdView=function(t,s,a,h,l){var c=this;this.loadAd(h,function(t){if(c.mEndLogic){for(var o=0;o<c.mEndLogic.length;o++)moosnow.entity.hideEntity(c.mEndLogic[o],{});c.mEndLogic=[]}for(var n=c.setPosition(t.indexLeft,a,l,!0),e=[],i=[],o=0;o<6;o++){var r=n.length>o?n[o]:n[0];i.push({appid:r.appid,position:r.position,index:o}),e.push(r)}e.forEach(function(t){var o=p(p({},t),{showIds:i,source:n}),e=moosnow.entity.showEntity(h,s,o);return c.mEndLogic.push(e),!1})})},Gt.prototype.willHide=function(){this.removeEvent(),this.mAdItemList.forEach(function(t){moosnow.entity.hideEntity(t,null)}),this.mAdItemList=[],this.mScrollVec=[]},Gt.prototype.initFloatAd=function(h,o,l,e,n){var c=this;cc.loader.loadResDir(moosnow.entity.prefabPath,cc.Prefab,function(){moosnow.ad.getAd(function(t){var s,a;0!=(c.mAdData=t).indexLeft.length&&(s=c.setPosition(t.indexLeft,e,n,!0),a=[],o.forEach(function(t,o){var e=o;e>s.length-1&&(e=0);var n=s[e];a.push({appid:n.appid,position:n.position,index:o});var i=l[o];n.x=i.x,n.y=i.y,n.source=s,n.showIds=a;var r=moosnow.entity.showEntity(t,h,n);c.mFloatCache[o]={index:e,logic:r},c.floatAnim(r.node)}),c.updateFloat(s),c.schedule(function(){c.updateFloat(s)},c.mFloatRefresh))})})},Gt.prototype.floatAnim=function(t){},Gt.prototype.updateFloat=function(t){for(var o in this.mFloatCache){var e=this.mFloatCache[o].index,n=this.mFloatCache[o].logic;e<t.length-1?e++:e=0,this.mFloatCache[o].index=e,n.refreshImg(t[e])}},Gt.prototype.hasAd=function(t){return(this.mShowAd&t)==t},Gt.prototype.showExportClose=function(){--this.mSecond,this.exportCloseTxt.active=!0;var t=this.exportCloseTxt.getComponent(cc.Label);if(this.mSecond<=0)return this.exportClose.active=!0,this.exportCloseTxt.active=!1,void this.unschedule(this.showExportClose);t.string="剩余"+this.mSecond+"秒可关闭"},Gt.prototype.displayAd=function(t){this.floatContainer.active=t&&this.hasAd(Pt.FLOAT),this.bannerContainer.active=t&&this.hasAd(Pt.BANNER),this.centerContainer.active=t&&this.hasAd(Pt.CENTER),this.leftContainer.active=t&&this.hasAd(Pt.LEFTRIGHT),this.exportMask.active=t&&this.hasAd(Pt.MASK),this.sideContainer.active=t&&this.hasAd(Pt.SIDE),this.endContainer.active=t&&this.hasAd(Pt.EXPORT_FIXED),this.topContainer.active=t&&this.hasAd(Pt.TOP),this.extend1Container.active=t&&this.hasAd(Pt.EXTEND1),this.extend2Container.active=t&&this.hasAd(Pt.EXTEND2),this.extend3Container.active=t&&this.hasAd(Pt.EXTEND3),this.extend4Container.active=t&&this.hasAd(Pt.EXTEND4),this.exportContainer.active=t&&this.hasAd(Pt.EXPORT),this.showClose(t),this.showInviteBox(t)},Gt.prototype.showClose=function(t){this.exportClose.active=!1,this.exportCloseTxt.active=!1,this.unschedule(this.showExportClose),t&&this.hasAd(Pt.BACK)?this.hasAd(Pt.WAIT)?(this.mSecond=3,this.showExportClose(),this.schedule(this.showExportClose,1)):(this.exportClose.active=!0,this.exportCloseTxt.active=!1):(this.exportClose.active=!1,this.exportCloseTxt.active=!1)},Gt.prototype.showInviteBox=function(t){var o=this;t&&this.hasAd(Pt.EXPORT)&&moosnow.http.getAllConfig(function(t){t&&(1==t.exportAutoNavigate&&moosnow.platform.navigate2Mini(o.mAdData.indexLeft[l.randomNumBoth(0,o.mAdData.indexLeft.length-1)]),t.exportAutoInvite&&o._createInviteBox())}),t&&this.hasAd(Pt.BANNER)&&moosnow.http.getAllConfig(function(t){o._createInviteBox(),t&&t.bannerAutoInvite&&o._createInviteBox()}),t&&this.hasAd(Pt.SIDE)&&moosnow.http.getAllConfig(function(t){t&&t.sideAutoInvite&&o._createInviteBox()})},Gt.prototype._createInviteBox=function(){var e=this;moosnow.http.getAllConfig(function(t){var o;t&&0<(o=isNaN(t.inviteDelay)?0:parseFloat(t.inviteDelay))?e.scheduleOnce(function(){moosnow.entity.showEntity("inviteBox",cc.Canvas.instance.node,{})},o):moosnow.entity.showEntity("inviteBox",cc.Canvas.instance.node,{})})},Gt.prototype.onFwUpdate=function(){},Gt);function Gt(){var t=null!==jt&&jt.apply(this,arguments)||this;return t.pauseContainer=null,t.pauseView=null,t.pauseLayout=null,t.centerContainer=null,t.centerView=null,t.centerLayout=null,t.exportContainer=null,t.exportView=null,t.exportLayout=null,t.exportClose=null,t.exportMask=null,t.exportCloseTxt=null,t.floatContainer=null,t.floatFull=null,t.bannerContainer=null,t.bannerView=null,t.bannerLayout=null,t.endContainer=null,t.endView=null,t.endLayout=null,t.failContainer=null,t.failView=null,t.failLayout=null,t.gameOverContainer=null,t.gameOverView=null,t.gameOverLayout=null,t.respawnContainer=null,t.respawnScrollView=null,t.respawnLayout=null,t.playerDiedContainer=null,t.playerDiedScrollView=null,t.playerDiedLayout=null,t.leftContainer=null,t.leftView=null,t.leftLayout=null,t.rightView=null,t.rightLayout=null,t.sideContainer=null,t.sideView=null,t.sideLayout=null,t.btnSideShow=null,t.btnSideHide=null,t.extend1Container=null,t.extend1View=null,t.extend1Layout=null,t.extend2Container=null,t.extend2View=null,t.extend2Layout=null,t.extend3Container=null,t.extend3View=null,t.extend3Layout=null,t.extend4Container=null,t.extend4View=null,t.extend4Layout=null,t.topContainer=null,t.topView=null,t.topLayout=null,t.mAdItemList=[],t.mScrollVec=[],t.mChangeLen=0,t.mIndex=999,t.mShowAd=moosnow.AD_POSITION.NONE,t.mPrevShowAd=moosnow.AD_POSITION.NONE,t.mEndLogic=[],t.mFloatIndex=0,t.mFloatRefresh=3,t.mFloatCache={},t.mSecond=3,t}var Qt,qt=(t(Xt,Qt=Vt),Object.defineProperty(Xt,"TOUCH_START",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(Xt,"TOUCH_END",{get:function(){return""},enumerable:!0,configurable:!0}),Xt);function Xt(){return null!==Qt&&Qt.apply(this,arguments)||this}var Kt,Yt=(t(Zt,Kt=qt),Object.defineProperty(Zt,"TOUCH_START",{get:function(){return cc.Node.EventType.TOUCH_START},enumerable:!0,configurable:!0}),Object.defineProperty(Zt,"TOUCH_END",{get:function(){return cc.Node.EventType.TOUCH_END},enumerable:!0,configurable:!0}),Zt);function Zt(){return null!==Kt&&Kt.apply(this,arguments)||this}var Jt,$t,to,oo=(t(eo,Jt=zt),eo.prototype.addEvent=function(){this.exportClose&&this.exportClose.on(Yt.TOUCH_END,this.onBack,this),this.btnSideShow&&this.btnSideShow.on(Yt.TOUCH_START,this.sideOut,this),this.btnSideHide&&this.btnSideHide.on(Yt.TOUCH_START,this.sideIn,this),Jt.prototype.addEvent.call(this)},eo.prototype.removeEvent=function(){this.exportClose&&this.exportClose.off(Yt.TOUCH_END,this.onBack,this),this.btnSideShow&&this.btnSideShow.off(Yt.TOUCH_START,this.sideOut,this),this.btnSideHide&&this.btnSideHide.off(Yt.TOUCH_START,this.sideIn,this),Jt.prototype.removeEvent.call(this)},eo.prototype.floatAnim=function(t){t.runAction(cc.sequence(cc.rotateTo(.3,10),cc.rotateTo(.6,-10),cc.rotateTo(.3,0),cc.scaleTo(.3,.8),cc.scaleTo(.3,1)).repeatForever())},eo.prototype.pushScroll=function(t,o){o.type==cc.Layout.Type.GRID?t.vertical?this.mScrollVec.push({scrollView:t,move2Up:!1}):this.mScrollVec.push({scrollView:t,move2Left:!1}):o.type==cc.Layout.Type.HORIZONTAL?this.mScrollVec.push({scrollView:t,move2Left:!1}):o.type==cc.Layout.Type.VERTICAL&&this.mScrollVec.push({scrollView:t,move2Up:!1})},eo.prototype.onFwUpdate=function(){for(var t=0;t<this.mScrollVec.length;t++){var o,e,n,i,r=this.mScrollVec[t],s=r.scrollView;s.isScrolling()||(e=(o=s.getMaxScrollOffset()).y/2+20,n=o.x/2+20,i=s.getContentPosition(),1==r.move2Up?(i.y>e&&(r.move2Up=!1),r.scrollView.setContentPosition(new cc.Vec2(i.x,i.y+this.mMoveSpeed))):0==r.move2Up&&(i.y<-e&&(r.move2Up=!0),r.scrollView.setContentPosition(new cc.Vec2(i.x,i.y-this.mMoveSpeed))),1==r.move2Left?(i.x>n&&(r.move2Left=!1),r.scrollView.setContentPosition(new cc.Vec2(i.x+this.mMoveSpeed,i.y))):0==r.move2Left&&(i.x<-n&&(r.move2Left=!0),r.scrollView.setContentPosition(new cc.Vec2(i.x-this.mMoveSpeed,i.y))))}},eo);function eo(){var t=null!==Jt&&Jt.apply(this,arguments)||this;return t.mMoveSpeed=2,t}(to=$t=$t||{})[to.AUTO_HIDE=1]="AUTO_HIDE",to[to.MAST=2]="MAST";var no=(Object.defineProperty(io,"mapping",{get:function(){var t,o,e,n,i,r,s,a,h,l,c,p;return{adForm:((t={})[moosnow.APP_PLATFORM.WX]="adForm",t),pauseForm:((o={})[moosnow.APP_PLATFORM.WX]="pauseForm",o[moosnow.APP_PLATFORM.BYTEDANCE]="pauseFormTT",o[moosnow.APP_PLATFORM.OPPO]="pauseFormOPPO",o[moosnow.APP_PLATFORM.OPPO_ZS]="pauseFormOPPO",o[moosnow.APP_PLATFORM.VIVO]="pauseFormOPPO",o[moosnow.APP_PLATFORM.QQ]="pauseFormTT",o),respawnForm:((e={})[moosnow.APP_PLATFORM.WX]="respawnForm",e[moosnow.APP_PLATFORM.BYTEDANCE]="respawnFormTT",e[moosnow.APP_PLATFORM.OPPO]="respawnFormOPPO",e[moosnow.APP_PLATFORM.OPPO_ZS]="respawnFormOPPO",e[moosnow.APP_PLATFORM.VIVO]="respawnFormOPPO",e[moosnow.APP_PLATFORM.QQ]="respawnFormQQ",e),endForm:((n={})[moosnow.APP_PLATFORM.WX]="endForm",n[moosnow.APP_PLATFORM.BYTEDANCE]="endFormTT",n[moosnow.APP_PLATFORM.OPPO]="endFormOPPO",n[moosnow.APP_PLATFORM.OPPO_ZS]="endFormOPPO",n[moosnow.APP_PLATFORM.VIVO]="endFormOPPO",n),totalForm:((i={})[moosnow.APP_PLATFORM.WX]="totalForm",i[moosnow.APP_PLATFORM.BYTEDANCE]="totalFormTT",i[moosnow.APP_PLATFORM.QQ]="totalFormQQ",i),tryForm:((r={})[moosnow.APP_PLATFORM.WX]="tryForm",r[moosnow.APP_PLATFORM.BYTEDANCE]="tryFormTT",r[moosnow.APP_PLATFORM.QQ]="tryFormTT",r),mistouchForm:((s={})[moosnow.APP_PLATFORM.WX]="mistouchForm",s[moosnow.APP_PLATFORM.QQ]="mistouchFormQQ",s[moosnow.APP_PLATFORM.BYTEDANCE]="mistouchFormTT",s),prizeForm:((a={})[moosnow.APP_PLATFORM.BYTEDANCE]="prizeFormTT",a[moosnow.APP_PLATFORM.QQ]="prizeForm",a),shareForm:((h={})[moosnow.APP_PLATFORM.WX]="shareFormTT",h[moosnow.APP_PLATFORM.BYTEDANCE]="shareFormTT",h),setForm:((l={})[moosnow.APP_PLATFORM.WX]="setForm",l),toastForm:((c={})[moosnow.APP_PLATFORM.WX]="toastForm",c),coinForm:((p={})[moosnow.APP_PLATFORM.WX]="coinForm",p)}},enumerable:!0,configurable:!0}),io.convertUIName=function(t){if(!t)return console.warn("convertUIName fail  mappingForm is null "),null;var o=moosnow.getAppPlatform();return t[o]?t[o]:t[moosnow.APP_PLATFORM.WX]?t[moosnow.APP_PLATFORM.WX]:(console.warn("convertUIName fail ",t),null)},Object.defineProperty(io,"AdForm",{get:function(){return this.convertUIName(this.mapping.adForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"CoinForm",{get:function(){return this.convertUIName(this.mapping.coinForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"ShareForm",{get:function(){return this.convertUIName(this.mapping.shareForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"TotalForm",{get:function(){return this.convertUIName(this.mapping.totalForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"EndForm",{get:function(){return this.convertUIName(this.mapping.endForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"ToastForm",{get:function(){return this.convertUIName(this.mapping.toastForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"PauseForm",{get:function(){return this.convertUIName(this.mapping.pauseForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"RespawnForm",{get:function(){return this.convertUIName(this.mapping.respawnForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"SetForm",{get:function(){return this.convertUIName(this.mapping.setForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"PrizeForm",{get:function(){return this.convertUIName(this.mapping.prizeForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"MistouchForm",{get:function(){return this.convertUIName(this.mapping.mistouchForm)},enumerable:!0,configurable:!0}),Object.defineProperty(io,"TryForm",{get:function(){return this.convertUIName(this.mapping.tryForm)},enumerable:!0,configurable:!0}),io);function io(){}var ro,so=(t(ao,ro=Vt),Object.defineProperty(ao.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),ao.prototype.initPos=function(){},ao.prototype.willShow=function(t){var o=this;ro.prototype.willShow.call(this,t),this.btnBanner.active=!0,this.initPos(),this.mCurrentNum=0,this.mNavigateIndex=l.randomNumBoth(3,this.mMaxNum-2),this.addEvent(),this.schedule(this.subProgress,.1),moosnow.form.showAd(moosnow.AD_POSITION.NONE,null),this.mBannerShow=!1,moosnow.http.getAllConfig(function(t){o.mBannerClickType=$t.MAST})},ao.prototype.willHide=function(){this.unschedule(this.subProgress),this.unschedule(this.resetProgress),this.removeEvent()},ao.prototype.subProgress=function(){0<this.mCurrentNum&&(this.mCurrentNum-=.1)},ao.prototype.addEvent=function(){},ao.prototype.removeEvent=function(){},ao.prototype.bannerClickCallback=function(t){t&&(this.unschedule(this.onHideBanner),this.unschedule(this.resetProgress),moosnow.platform.hideBanner(),this.mBannerShow=!1,this.FormData&&this.FormData.callback&&this.FormData.callback())},ao.prototype.onLogoUp=function(){this.logo.position=this.mEndPos},ao.prototype.onLogoDown=function(){this.logo.position=this.mBeginPos},ao.prototype.onBannerClick=function(){var o=this;this.onLogoDown(),this.mCurrentNum+=1,this.mCurrentNum>=this.mNavigateIndex&&(this.mBannerShow||(this.mShowTime=Date.now(),this.mBannerShow=!0,moosnow.platform.showBanner(function(t){console.log("banner click callback ",t),o.bannerClickCallback(t)}),this.mBannerClickType==$t.AUTO_HIDE?(this.unschedule(this.onHideBanner),this.scheduleOnce(this.onHideBanner,2)):this.mBannerClickType==$t.MAST&&(this.unschedule(this.resetProgress),this.scheduleOnce(this.resetProgress,2)))),this.mCurrentNum>=this.mMaxNum&&(moosnow.platform.hideBanner(),this.mBannerShow=!1,moosnow.ui.destroyUIForm(no.MistouchForm,null),this.FormData&&this.FormData.callback&&this.FormData.callback(!0))},ao.prototype.resetProgress=function(){this.mCurrentNum=0,moosnow.platform.hideBanner(),this.mBannerShow=!1},ao.prototype.onHideBanner=function(){moosnow.platform.hideBanner()},ao.prototype.update=function(){this.clickProgress.progress=this.mCurrentNum/this.mMaxNum},ao);function ao(){var t=null!==ro&&ro.apply(this,arguments)||this;return t.clickProgress=null,t.btnBanner=null,t.logo=null,t.mMaxNum=10,t.mCurrentNum=0,t.mNavigateIndex=0,t.mBannerShow=!1,t.mShowTime=0,t.mBannerClickType=$t.AUTO_HIDE,t}var ho,lo=(t(co,ho=so),co.prototype.addEvent=function(){this.btnBanner.on(Yt.TOUCH_START,this.onLogoUp,this),this.btnBanner.on(Yt.TOUCH_END,this.onBannerClick,this)},co.prototype.removeEvent=function(){this.btnBanner.off(Yt.TOUCH_START,this.onLogoUp,this),this.btnBanner.off(Yt.TOUCH_END,this.onBannerClick,this),moosnow.event.removeListener(w.ON_PLATFORM_SHOW,this)},co.prototype.onLogoUp=function(){this.logo.position=this.mEndPos},co.prototype.onLogoDown=function(){this.logo.position=this.mBeginPos},co.prototype.initPos=function(){this.mBeginPos=this.logo.position.clone(),this.mEndPos=this.mBeginPos.add(new cc.Vec2(0,50))},co);function co(){var t=null!==ho&&ho.apply(this,arguments)||this;return t.clickProgress=null,t.btnBanner=null,t.logo=null,t}var po,uo=(t(mo,po=so),mo.prototype.willShow=function(t){po.prototype.willShow.call(this,t),this.step1.active=!0,this.step2.active=!1,this.btnConfirm.active=!0,this.mCurrentNum=0,this.mOpenVideo=!0,this.showCheckbox(),this.addEvent(),this.schedule(this.subProgress,.1),moosnow.form.showAd(moosnow.AD_POSITION.NONE,null)},mo.prototype.willHide=function(){this.unschedule(this.subProgress),this.unschedule(this.resetProgress),this.removeEvent()},mo.prototype.subProgress=function(){0<this.mCurrentNum&&(this.mCurrentNum-=.1)},mo.prototype.addEvent=function(){},mo.prototype.removeEvent=function(){},mo.prototype.openBox=function(){var o=this;this.mOpenVideo?(this.btnConfirm.active=!1,moosnow.platform.showVideo(function(t){t!=moosnow.VIDEO_STATUS.END?(t==moosnow.VIDEO_STATUS.NOTEND?moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND):moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR),o.btnConfirm.active=!0):o.FormData&&o.FormData.callback&&o.FormData.callback(!0)})):moosnow.ui.hideUIForm(no.MistouchForm,null)},mo.prototype.checkboxChange=function(){this.mOpenVideo=!this.mOpenVideo,this.showCheckbox()},mo.prototype.showCheckbox=function(){this.mOpenVideo?this.checked.node.active=!0:this.checked.node.active=!1},mo.prototype.playBoxAnim=function(t){},mo.prototype.onLogoUp=function(){this.playBoxAnim("prizeBox2")},mo.prototype.onBannerClick=function(){this.mCurrentNum>this.mMaxNum+1||(this.mCurrentNum+=1,this.mCurrentNum>=this.mMaxNum&&(this.step1.active=!1,this.step2.active=!0,this.playBoxAnim("prizeBox1")))},mo.prototype.resetProgress=function(){this.mCurrentNum=0},mo.prototype.update=function(){var t=this.mCurrentNum/this.mMaxNum;this.clickProgress.progress=1<t?1:t},mo);function mo(){var t=null!==po&&po.apply(this,arguments)||this;return t.clickProgress=null,t.btnReceive=null,t.btnConfirm=null,t.checked=null,t.unchecked=null,t.step1=null,t.step2=null,t.logo=null,t.mMaxNum=10,t.mCurrentNum=0,t.mOpenVideo=!0,t}var fo,wo=(t(go,fo=uo),go.prototype.playBoxAnim=function(t){var o=this.logo.getComponent(cc.Animation);o.getAnimationState(t).isPlaying||o.play(t)},go.prototype.addEvent=function(){this.unchecked.node.on(Yt.TOUCH_END,this.checkboxChange,this),this.btnReceive.on(Yt.TOUCH_START,this.onLogoUp,this),this.btnReceive.on(Yt.TOUCH_END,this.onBannerClick,this),this.btnConfirm.on(Yt.TOUCH_END,this.openBox,this)},go.prototype.removeEvent=function(){this.unchecked.node.off(Yt.TOUCH_END,this.checkboxChange,this),this.btnReceive.off(Yt.TOUCH_START,this.onLogoUp,this),this.btnReceive.off(Yt.TOUCH_END,this.onBannerClick,this),this.btnConfirm.off(Yt.TOUCH_END,this.openBox,this)},go);function go(){var t=null!==fo&&fo.apply(this,arguments)||this;return t.clickProgress=null,t.btnReceive=null,t.btnConfirm=null,t.checked=null,t.unchecked=null,t.step1=null,t.step2=null,t.logo=null,t}var yo,vo=(t(bo,yo=so),bo.prototype.willShow=function(t){yo.prototype.willShow.call(this,t),this.mCurrentNum=0,this.mNavigateIndex=l.randomNumBoth(3,this.mMaxNum-2),this.addEvent(),this.schedule(this.subProgress,.016),moosnow.form.showAd(moosnow.AD_POSITION.NONE,null),this.mBannerShow=!1,this.mistouchAppBox()?(this.showHand(!0),this.showButton(!1),this.playHandAnim()):(this.showHand(!1),this.showButton(!0)),moosnow.platform.hideBanner()},bo.prototype.playHandAnim=function(){},bo.prototype.mistouchAppBox=function(){return this.FormData&&2==this.FormData.type},bo.prototype.subProgress=function(){0<this.mCurrentNum&&(this.mCurrentNum-=.02)},bo.prototype.initPos=function(){},bo.prototype.onHideBanner=function(){this.mistouchAppBox()?moosnow.platform.hideAppBox():moosnow.platform.hideBanner()},bo.prototype.showButton=function(t){},bo.prototype.showHand=function(t){},bo.prototype.onBannerClick=function(){var o=this;this.mCurrentNum+=1,this.onLogoDown(),this.showHand(!1),this.mCurrentNum>=this.mNavigateIndex&&(this.mBannerShow||(this.mShowTime=Date.now(),this.mBannerShow=!0,this.mistouchAppBox()?moosnow.platform.showAppBox(function(){o.bannerClickCallback(!0)}):moosnow.platform.showBanner(function(t){console.log("banner click callback ",t),o.bannerClickCallback(t)}),this.mBannerClickType==$t.AUTO_HIDE?(this.unschedule(this.onHideBanner),this.scheduleOnce(this.onHideBanner,2)):this.mBannerClickType==$t.MAST&&(this.unschedule(this.resetProgress),this.scheduleOnce(this.resetProgress,2)))),this.mCurrentNum>=this.mMaxNum&&(moosnow.platform.hideBanner(),this.mBannerShow=!1,this.scheduleOnce(function(){moosnow.ui.destroyUIForm(no.MistouchForm,null),o.FormData&&o.FormData.callback&&o.FormData.callback()},.2))},bo);function bo(){var t=null!==yo&&yo.apply(this,arguments)||this;return t.clickProgress=null,t.btnBanner=null,t.logo=null,t.hand=null,t.pinch1=null,t.pinch2=null,t.pinch3=null,t.pinch4=null,t.pinch5=null,t.pinch6=null,t}var Co,No=(t(Io,Co=vo),Io.prototype.onLogoUp=function(){},Io.prototype.onLogoDown=function(){var t=this.logo.getComponent(cc.Sprite);this.mCurrentNum<this.mMaxNum?t.spriteFrame=this["pinch"+(parseInt(""+this.mCurrentNum)%4+1)]:t.spriteFrame=this.pinch6},Io.prototype.addEvent=function(){var t=this;this.mistouchAppBox()?(this.btnBanner.active=!1,this.logo.on(Yt.TOUCH_START,this.onLogoUp,this),this.logo.on(Yt.TOUCH_END,this.onBannerClick,this)):(this.btnBanner.active=!0,this.btnBanner.on(Yt.TOUCH_START,this.onLogoUp,this),this.btnBanner.on(Yt.TOUCH_END,this.onBannerClick,this)),moosnow.event.addListener(w.ON_PLATFORM_SHOW,this,function(){t.mBannerShow&&t.bannerClickCallback(!0)})},Io.prototype.removeEvent=function(){this.btnBanner.off(Yt.TOUCH_END,this.onBannerClick,this),moosnow.event.removeListener(w.ON_PLATFORM_SHOW,this)},Io.prototype.playHandAnim=function(){this.hand.getComponent(cc.Animation).play()},Io.prototype.showButton=function(t){this.btnBanner.active=t},Io.prototype.showHand=function(t){this.hand.active=t},Io);function Io(){var t=null!==Co&&Co.apply(this,arguments)||this;return t.clickProgress=null,t.btnBanner=null,t.logo=null,t.hand=null,t.pinch1=null,t.pinch2=null,t.pinch3=null,t.pinch4=null,t.pinch5=null,t.pinch6=null,t}var _o,So=(t(Ao,_o=u),Ao.prototype.initForm=function(t){this.initProperty(t)},Object.defineProperty(Ao.prototype,"LogicData",{get:function(){return this.mLogicData},enumerable:!0,configurable:!0}),Ao.prototype.willShow=function(t){this.mLogicData=t,this.initPosition(t)},Ao.prototype.initPosition=function(t){},Ao.prototype.onShow=function(t){},Ao.prototype.willHide=function(t){},Ao.prototype.onHide=function(t){},Ao);function Ao(){return null!==_o&&_o.apply(this,arguments)||this}var Po,Oo=(t(Fo,Po=So),Fo.prototype.onClickAd=function(){var t,o=this,e=this.mAdItem;this.LogicData.refresh&&((t=this.findNextAd()).refresh&&moosnow.event.sendEventImmediately(w.AD_VIEW_REFRESH,{current:e,next:t}),this.refreshImg(t)),moosnow.platform.navigate2Mini(e,function(){},function(){o.mAdItem.onCancel&&o.mAdItem.onCancel(e)})},Fo.prototype.findNextAd=function(){if(!this.LogicData.source)return null;if(!this.LogicData.showIds)return null;for(var t=0;t<this.LogicData.source.length;t++){for(var o=!1,e=0;e<this.LogicData.showIds.length;e++)this.LogicData.showIds[e].appid==this.LogicData.source[t].appid&&this.LogicData.showIds[e].position==this.LogicData.source[t].position&&(o=!0);if(!o)return this.LogicData.source[t]}return null},Fo.prototype.onAdViewChange=function(t){if(this.LogicData.showIds&&this.LogicData.source){for(var o=t.current,e=t.next,n=this.LogicData.showIds,i=this.LogicData.source,r=0;r<n.length;r++)o.appid==n[r].appid&&o.position==n[r].position&&(this.LogicData.showIds[r]=e.appid);for(r=0;r<i.length;r++)if(e.appid==i[r].appid){this.LogicData.source.splice(r,1),this.LogicData.source.push(o);break}}},Fo.prototype.onShow=function(){this.LogicData&&this.LogicData.refresh&&moosnow.event.addListener(w.AD_VIEW_REFRESH,this,this.onAdViewChange)},Fo.prototype.onHide=function(){this.mAdItem&&(this.mAdItem.onCancel=null),this.removeListener(),moosnow.event.removeListener(w.AD_VIEW_REFRESH,this)},Fo.prototype.addListener=function(){},Fo.prototype.removeListener=function(){},Fo.prototype.willShow=function(t){Po.prototype.willShow.call(this,t),this.addListener()},Fo.prototype.refreshImg=function(t){},Fo);function Fo(){var t=null!==Po&&Po.apply(this,arguments)||this;return t.logo=null,t.title=null,t.animLogo=null,t.nameBg=null,t.changeView=!1,t}var To,Eo=(t(Lo,To=Oo),Lo.prototype.addListener=function(){this.logo.node.on(Yt.TOUCH_END,this.onClickAd,this)},Lo.prototype.removeListener=function(){this.logo.node.off(Yt.TOUCH_END,this.onClickAd,this)},Lo.prototype.initPosition=function(t){},Lo.prototype.willShow=function(t){var n=this;To.prototype.willShow.call(this,t),this.mAdItem=t,cc.loader.load(t.img,function(t,o){var e=new cc.SpriteFrame(o);n.logo.spriteFrame=e}),this.title&&(this.title.string=t.title)},Lo.prototype.refreshImg=function(t){var n=this;this.mAdItem=t,cc.loader.load(t.img,function(t,o){var e=new cc.SpriteFrame(o);n.logo.spriteFrame=e}),this.title&&(this.title.string=t.title)},Lo);function Lo(){return null!==To&&To.apply(this,arguments)||this}var Bo,xo=(t(Do,Bo=Vt),Object.defineProperty(Do.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Do.prototype.initForm=function(t){this.initProperty(t)},Do.prototype.willHide=function(){},Do.prototype.willShow=function(t){Bo.prototype.willShow.call(this,t),this.coinNum.string=""+l.formatMoney(t.coinNum),moosnow.platform.hideBanner()},Do.prototype.closeForm=function(){var t=this;moosnow.ui.destroyUIForm(no.PrizeForm,null),moosnow.ui.destroyUIForm(no.MistouchForm,null),1==this.FormData.showCoinAnim?moosnow.ui.pushUIForm(no.CoinForm,p(p({},l.deepCopy(this.FormData)),{callback:function(){t.FormData.callback&&t.FormData.callback()}})):this.FormData.callback&&this.FormData.callback()},Do);function Do(){var t=null!==Bo&&Bo.apply(this,arguments)||this;return t.coinNum=null,t.btnConfirm=null,t}var ko,Ro=(t(Uo,ko=xo),Uo.prototype.initForm=function(t){this.initProperty(t),this.btnConfirm.on(Yt.TOUCH_END,this.closeForm,this)},Uo.prototype.willHide=function(){this.btnConfirm.off(Yt.TOUCH_END,this.closeForm,this)},Uo);function Uo(){var t=null!==ko&&ko.apply(this,arguments)||this;return t.coinNum=null,t.btnConfirm=null,t}var Mo,Ho=(t(Vo,Mo=Vt),Object.defineProperty(Vo.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Vo.prototype.initForm=function(t){this.initProperty(t)},Vo.prototype.willShow=function(t){var e=this;Mo.prototype.willShow.call(this,t),this.addListener(),this.mChecked=!1,this.onChecked(),this.prizeBg1.active=!1,this.prizeBg2.active=!1,moosnow.http.getAllConfig(function(t){var o;t?1==t.prizeFormVideo?e.showVideo():2==t.prizeFormVideo?e.showShare():(o=t&&t.prizeFormVideosPrecent?parseFloat(t.prizeFormVideosPrecent):.5,l.randomNumBoth(0,100)/100<o?e.showVideo():e.showShare()):e.showShare()}),this.mTotalSecond=10,this.mCurrentSecond=0,this.resumeCountdown(),moosnow.platform.showBanner()},Vo.prototype.onHide=function(){this.removeListener()},Vo.prototype.showVideo=function(){this.prizeBg1.active=!0,this.prizeBg2.active=!1},Vo.prototype.showShare=function(){this.prizeBg1.active=!1,this.prizeBg2.active=!0},Vo.prototype.onCountdown=function(){this.mCurrentSecond+=1;var t=this.mTotalSecond-this.mCurrentSecond;if(t<0)return this.unschedule(this.onCountdown),void moosnow.ui.hideUIForm(no.PrizeForm,null);this.txtCoutdown.string=t+"秒"},Vo.prototype.stopCountdown=function(){this.unschedule(this.onCountdown)},Vo.prototype.resumeCountdown=function(){this.schedule(this.onCountdown,1)},Vo.prototype.addListener=function(){},Vo.prototype.removeListener=function(){},Vo.prototype.closeForm=function(){moosnow.ui.hideUIForm(no.PrizeForm,null)},Vo.prototype.onChecked=function(){},Vo.prototype.onShare=function(){var o=this;this.stopCountdown(),moosnow.platform.share({channel:""},function(t){o.resumeCountdown(),o.FormData&&(o.FormData.hideForm&&moosnow.ui.hideUIForm(no.PrizeForm,null),o.FormData.shareCallback&&o.FormData.shareCallback(t))})},Vo.prototype.onReceive=function(){this.mChecked?this.onVideo():this.FormData&&(this.FormData.hideForm&&moosnow.ui.hideUIForm(no.PrizeForm,null),this.FormData.callback&&this.FormData.callback())},Vo.prototype.onVideo=function(){var o=this;this.stopCountdown(),moosnow.platform.showVideo(function(t){t!=moosnow.VIDEO_STATUS.END?(t==moosnow.VIDEO_STATUS.ERR?moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR):moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND),o.resumeCountdown()):o.FormData&&(o.FormData.hideForm&&moosnow.ui.hideUIForm(no.PrizeForm,null),o.FormData.videoCallback&&o.FormData.videoCallback())})},Vo);function Vo(){var t=null!==Mo&&Mo.apply(this,arguments)||this;return t.prizeBg1=null,t.prizeBg2=null,t.btnCancel=null,t.txtCoutdown=null,t.btnVideo=null,t.btnShare=null,t.btnReceive=null,t.checked=null,t.unchecked=null,t.isMask=!0,t.mChecked=!1,t.mTotalSecond=10,t.mCurrentSecond=0,t}var Wo,jo=(t(zo,Wo=Ho),zo.prototype.onChecked=function(){this.mChecked=!this.mChecked,this.checked.active=this.mChecked},zo.prototype.initForm=function(t){this.initProperty(t),this.btnConfirm.on(Yt.TOUCH_END,this.closeForm,this)},zo.prototype.willHide=function(){this.btnConfirm.off(Yt.TOUCH_END,this.closeForm,this)},zo.prototype.addListener=function(){this.btnCancel.on(Yt.TOUCH_END,this.closeForm,this),this.btnVideo.on(Yt.TOUCH_END,this.onVideo,this),this.btnReceive.on(Yt.TOUCH_END,this.onReceive,this),this.btnShare.on(Yt.TOUCH_END,this.onShare,this),this.unchecked.on(Yt.TOUCH_END,this.onChecked,this)},zo.prototype.removeListener=function(){this.btnCancel.off(Yt.TOUCH_END,this.closeForm,this),this.btnVideo.off(Yt.TOUCH_END,this.onVideo,this),this.btnReceive.off(Yt.TOUCH_END,this.onReceive,this),this.btnShare.off(Yt.TOUCH_END,this.onShare,this),this.unchecked.off(Yt.TOUCH_END,this.onChecked,this)},zo);function zo(){var t=null!==Wo&&Wo.apply(this,arguments)||this;return t.coinNum=null,t.btnConfirm=null,t}var Go,Qo=(t(qo,Go=Vt),Object.defineProperty(qo.prototype,"rootNode",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(qo.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),qo.prototype.flyAnim=function(t,o,e){},qo.prototype.onShow=function(e){var n=this,t=this.FormData,i=t.imgNum,r=(t.coinNum,t.starVec),s=t.endVec,a=t.callback;console.log("showCoin",e),cc.loader.loadRes(moosnow.entity.prefabPath+"coin",cc.Prefab,function(){for(var t=0;t<i;t++){var o=moosnow.entity.showEntity("coin",n.rootNode,{x:l.randomNumBoth(r.x-e.randomX,r.x+e.randomX),y:l.randomNumBoth(r.y-e.randomY,r.y+e.randomY)});n.flyAnim(o,s,a)}n.scheduleOnce(function(){n.FormData.hideForm&&moosnow.ui.hideUIForm(no.CoinForm,null),l.isFunction(a)&&a()},2.1)})},qo);function qo(){return null!==Go&&Go.apply(this,arguments)||this}var Xo,Ko=(t(Yo,Xo=Qo),Object.defineProperty(Yo.prototype,"rootNode",{get:function(){return cc.Canvas.instance.node},enumerable:!0,configurable:!0}),Yo.prototype.flyAnim=function(t,o,e){var n=t.node,i=l.randomNumBoth(0,100)/200;n.active=!0,n.runAction(cc.sequence(cc.delayTime(i),cc.spawn(cc.moveTo(1,o.x,o.y),cc.fadeOut(1),cc.sequence(cc.scaleTo(.8,1.2,1.2),cc.scaleTo(.8,.8,9.8))),cc.callFunc(function(){moosnow.entity.hideEntity(t,null,!0)})))},Yo);function Yo(){return null!==Xo&&Xo.apply(this,arguments)||this}var Zo,Jo=(t($o,Zo=Vt),$o.prototype.initForm=function(t){this.initProperty(t)},$o.prototype.addEvent=function(){},$o.prototype.removeEvent=function(){},$o.prototype.onReceive=function(){var o=this;this.mCheckedVideo?moosnow.platform.showVideo(function(t){t==moosnow.VIDEO_STATUS.END?o.openEndForm(5*o.mLevelCoinNum):t==moosnow.VIDEO_STATUS.ERR?moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR):moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND)}):this.openEndForm(this.mLevelCoinNum)},$o.prototype.openEndForm=function(t){moosnow.ui.hideUIForm(no.TotalForm,null),moosnow.ui.pushUIForm(no.EndForm,p({coin:t,level:this.FormData.level,levelShareCoinNum:this.mLevelShareCoinNum},this.FormData))},$o.prototype.onShareChange=function(){this.mCheckedVideo=!this.mCheckedVideo,this.changeUI()},$o.prototype.changeUI=function(){},$o.prototype.onShow=function(t){var o=t.coin,e=t.shareCoin;this.mLevelCoinNum=o,this.mLevelShareCoinNum=e,this.levelCoin.string=""+l.formatMoney(this.mLevelCoinNum),this.addEvent(),this.mCheckedVideo=!0,this.changeUI(),moosnow.platform.stopRecord(),moosnow.platform.showBanner()},$o.prototype.willHide=function(){this.removeEvent(),moosnow.platform.hideBanner()},$o);function $o(){var t=null!==Zo&&Zo.apply(this,arguments)||this;return t.checked=null,t.unchecked=null,t.btnReceive=null,t.levelCoin=null,t.mCheckedVideo=!0,t.mLevelCoinNum=0,t.mLevelShareCoinNum=0,t}var te,oe=(t(ee,te=Jo),ee.prototype.addEvent=function(){this.unchecked.node.on(Yt.TOUCH_END,this.onShareChange,this),this.btnReceive.node.on(Yt.TOUCH_END,this.onReceive,this)},ee.prototype.removeEvent=function(){this.unchecked.node.off(Yt.TOUCH_END,this.onShareChange,this),this.btnReceive.node.off(Yt.TOUCH_END,this.onReceive,this)},ee.prototype.changeUI=function(){this.mCheckedVideo?this.checked.node.active=!0:this.checked.node.active=!1},ee);function ee(){return null!==te&&te.apply(this,arguments)||this}var ne,ie=(t(re,ne=Vt),Object.defineProperty(re.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),re.prototype.initForm=function(t){this.initProperty(t),this.addListener()},re.prototype.addListener=function(){},re.prototype.removeListener=function(){},re.prototype.onBack=function(){this.FormData.hideForm&&moosnow.ui.hideUIForm(no.ShareForm,null),this.FormData&&this.FormData.callback&&this.FormData.callback()},re.prototype.onShow=function(){this.btnShare.active=!0,this.mLevelShareCoinNum=this.FormData.shareCoinNum,this.txtCoinNum.string=""+l.formatMoney(this.mLevelShareCoinNum),moosnow.platform.stopRecord()},re.prototype.onShareVideo=function(){var e=this;this.mShareing||(this.mShareing=!0,moosnow.http.getAllConfig(function(t){var o;t&&1!=t.shareFormVideo?2==t.shareFormVideo?e.onShare():(o=t&&t.shareFormVideoPrecent?parseFloat(t.shareFormVideoPrecent):.5,l.randomNumBoth(0,100)/100<o?e.onVideo():e.onShare()):e.onVideo()}))},re.prototype.onVideo=function(){var o=this;moosnow.platform.showVideo(function(t){o.mShareing=!1,t==moosnow.VIDEO_STATUS.END?(o.FormData.hideForm&&moosnow.ui.hideUIForm(no.ShareForm,null),o.FormData&&o.FormData.videoCallback&&o.FormData.videoCallback()):t==moosnow.VIDEO_STATUS.NOTEND?moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND):moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR)})},re.prototype.onShare=function(){var o=this;moosnow.platform.share({channel:moosnow.SHARE_CHANNEL.VIDEO},function(t){o.mShareing=!1,t?(o.FormData.hideForm&&moosnow.ui.hideUIForm(no.ShareForm,null),o.FormData&&o.FormData.shareCallback&&o.FormData.shareCallback(t)):moosnow.ui.showToast("分享未完成"),console.log("分享结束",t)})},re);function re(){var t=null!==ne&&ne.apply(this,arguments)||this;return t.btnShare=null,t.btnBack=null,t.txtCoinNum=null,t.isMask=!0,t.mLevelShareCoinNum=0,t.mShareing=!1,t}var se,ae=(t(he,se=ie),he.prototype.addListener=function(){this.btnBack.on(Yt.TOUCH_END,this.onBack,this),this.btnShare.on(Yt.TOUCH_END,this.onShareVideo,this)},he.prototype.removeListener=function(){this.btnBack.off(Yt.TOUCH_END,this.onBack,this),this.btnShare.off(Yt.TOUCH_END,this.onShareVideo,this)},he);function he(){return null!==se&&se.apply(this,arguments)||this}var le,ce=(t(pe,le=So),pe.prototype.willShow=function(t){var r=this;le.prototype.willShow.call(this,t),this.addListener(),moosnow.http.request(this.url+"/avatar.json",{},"GET",function(t){var n=t.name[l.randomNumBoth(0,t.name.length-1)],i=t.name[l.randomNumBoth(t.logo[0],t.logo[1])];moosnow.ad.getAd(function(t){var o=l.randomNumBoth(0,t.indexLeft.length-1),e=t.indexLeft[o];r.initBox(n,i,e.title),r.mCurrentAdRow=e})}),moosnow.http.getAllConfig(function(t){var o;!t||0<(o=isNaN(t.inviteDelayClose)?0:parseFloat(t.inviteDelayClose))&&(r.unscheduleOnce(r.cancel),r.scheduleOnce(r.cancel,o))})},pe.prototype.willHide=function(){this.unscheduleOnce(this.cancel),this.removeListener()},pe.prototype.initBox=function(t,o,e){},pe.prototype.addListener=function(){},pe.prototype.removeListener=function(){},pe.prototype.onConfirm=function(){moosnow.platform.navigate2Mini(this.mCurrentAdRow)},pe.prototype.onCancel=function(){moosnow.entity.hideEntity("inviteBox",null)},pe);function pe(){var t=null!==le&&le.apply(this,arguments)||this;return t.logo=null,t.gameName=null,t.userName=null,t.confirm=null,t.cancel=null,t.url="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/Avatar",t}var ue,de=(t(me,ue=ce),me.prototype.addListener=function(){this.confirm.on(Yt.TOUCH_END,this,this.onConfirm),this.cancel.on(Yt.TOUCH_END,this,this.onCancel)},me.prototype.removeListener=function(){this.confirm.off(Yt.TOUCH_END,this,this.onConfirm),this.cancel.on(Yt.TOUCH_END,this,this.onCancel)},me.prototype.initBox=function(t,o,e){var n=this;cc.loader.load(o,function(t,o){var e;t||(e=new cc.SpriteFrame(o),n.logo.getComponent(cc.Sprite).spriteFrame=e)}),this.userName.string=l.format(b,t),this.gameName.string=e},me);function me(){return null!==ue&&ue.apply(this,arguments)||this}var fe=(we.prototype.newViewItem=function(){return new Eo},Object.defineProperty(we.prototype,"inviteBox",{get:function(){return this.mAdInviteBox||(this.mAdInviteBox=new de),this.mAdInviteBox},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"adForm",{get:function(){return this.mAdForm||(this.mAdForm=new oo),this.mAdForm},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"adFormQQ",{get:function(){return this.mAdForm||(this.mAdForm=new oo),this.mAdFormQQ},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"mistouchForm",{get:function(){return this.mMistouchForm||(this.mMistouchForm=new lo),this.mMistouchForm},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"mistouchFormTT",{get:function(){return this.mMistouchFormTT||(this.mMistouchFormTT=new wo),this.mMistouchFormTT},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"mistouchFormQQ",{get:function(){return this.mMistouchFormQQ||(this.mMistouchFormQQ=new No),this.mMistouchFormQQ},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"prizeForm",{get:function(){return this.mPrizeForm||(this.mPrizeForm=new Ro),this.mPrizeForm},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"prizeFormTT",{get:function(){return this.mPrizeFormTT||(this.mPrizeFormTT=new jo),this.mPrizeFormTT},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"coinForm",{get:function(){return this.mCoinForm||(this.mCoinForm=new Ko),this.mCoinForm},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"totalForm",{get:function(){return this.mTotalForm||(this.mTotalForm=new oe),this.mTotalForm},enumerable:!0,configurable:!0}),Object.defineProperty(we.prototype,"shareFormTT",{get:function(){return this.mShareForm||(this.mShareForm=new ae),this.mShareForm},enumerable:!0,configurable:!0}),we);function we(){}var ge=(ye.prototype.showToast=function(t){moosnow.ui.showToast(t)},ye.prototype.preloadAd=function(){moosnow.ui.pushUIForm(no.AdForm,{showAd:moosnow.AD_POSITION.NONE},null)},ye.prototype.showAd=function(t,o,e){var n;void 0===t&&(t=Pt.NONE),void 0===e&&(e=999),moosnow.getAppPlatform()==moosnow.APP_PLATFORM.BYTEDANCE&&moosnow.platform.isIphone()?console.log("头条iphone 不显示广告"):(n=moosnow.ui.getUIFrom(no.AdForm))?(moosnow.event.sendEventImmediately(w.AD_VIEW_CHANGE,{showAd:t,callback:o,zIndex:e}),n.node.zIndex=e):moosnow.ui.pushUIForm(no.AdForm,{showAd:moosnow.AD_POSITION.NONE},function(){moosnow.ui.getUIFrom(no.AdForm).node.zIndex=e,moosnow.event.sendEventImmediately(w.AD_VIEW_CHANGE,{showAd:t,callback:o,zIndex:e})})},ye.prototype.showCoin=function(t){moosnow.ui.pushUIForm(no.CoinForm,t)},ye.prototype.showMistouch=function(t){moosnow.ui.pushUIForm(no.MistouchForm,t,function(){})},ye.prototype.showPrize=function(t){moosnow.ui.pushUIForm(no.PrizeForm,t,function(){})},ye.prototype.showTotal=function(t){moosnow.ui.pushUIForm(no.TotalForm,t)},ye.prototype.showEnd=function(t){moosnow.ui.pushUIForm(no.EndForm,t)},ye.prototype.showShare=function(t){moosnow.ui.pushUIForm(no.ShareForm,t)},ye);function ye(){}var ve,be=(t(Ce,ve=u),Ce.prototype.initPos=function(){},Ce.prototype.move=function(t,o,e){var n=this;this.moveNode=t,this.distince=o,this.showBanner=e,this.initPos();var i=moosnow.data.getCurrentMisTouchCount();moosnow.data.setCurrentMisTouchCount(i+1),moosnow.http.getAllConfig(function(t){isNaN(t.mistouchPosSecond)||(n.mMistouchPosSecond=parseFloat(t.mistouchPosSecond)),moosnow.http.getMistouchPosNum(function(t){n.mMistouchPosNum=t,n.movePosition()})})},Ce.prototype.setPosition=function(t,o,e,n){},Ce.prototype.movePosition=function(){var t,o=this;0==this.mMistouchPosNum?(this.setPosition(this.moveNode,!0,this.pos1.x,this.pos1.y),this.showBanner&&moosnow.platform.showBanner()):moosnow.data.getCurrentMisTouchCount()%this.mMistouchPosNum==0&&(t=this.copyNode(),this.scheduleOnce(function(){o.onPosCallback(t)},this.mMistouchPosSecond))},Ce.prototype.copyNode=function(){},Ce.prototype.onPosCallback=function(t){this.showBanner&&moosnow.platform.showBanner(),this.removeTemp(t),this.setPosition(this.moveNode,!0,this.pos1.x,this.pos1.y),this.unscheduleOnce(this.onPosCallback)},Ce.prototype.removeTemp=function(t){},Ce);function Ce(){var t=null!==ve&&ve.apply(this,arguments)||this;return t.moveNode=null,t.distince=-100,t.showBanner=!0,t.pos1=cc.Vec2.ZERO,t.pos2=cc.Vec2.ZERO,t.mMistouchPosNum=0,t.mMistouchPosSecond=2,t}var Ne,Ie=(t(_e,Ne=be),_e.prototype.initPos=function(){0==this.pos1.x&&0==this.pos1.y&&(this.pos1=this.moveNode.position.clone(),this.pos2=this.pos1.add(new cc.Vec2(0,this.distince))),this.moveNode.active=!1},_e.prototype.setPosition=function(t,o,e,n){t.active=o,t.x=e,t.y=n},_e.prototype.copyNode=function(){var t=cc.instantiate(this.moveNode);return t.active=!0,this.moveNode.parent.addChild(t),t.x=this.pos2.x,t.y=this.pos2.y,t},_e.prototype.removeTemp=function(t){t.active=!1,t.removeFromParent(),t.destroy()},_e);function _e(){var t=null!==Ne&&Ne.apply(this,arguments)||this;return t.moveNode=null,t.distince=-100,t.showBanner=!0,t.pos1=cc.Vec2.ZERO,t.pos2=cc.Vec2.ZERO,t}var Se,Ae=(t(Pe,Se=u),Pe.prototype.show=function(t,o){void 0===o&&(o=3),t&&(this.mNode=t,this.hideNode(),this.schedule(this.showNode,o))},Pe.prototype.hide=function(t,o){void 0===o&&(o=3),this.mNode=t,this.schedule(this.hideNode,o)},Pe.prototype.clear=function(){this.unschedule(this.showNode),this.unschedule(this.hideNode)},Pe.prototype.hideNode=function(){this.mNode.active=!1},Pe.prototype.showNode=function(){this.mNode.active=!0,this.unschedule(this.showNode)},Pe);function Pe(){var t=null!==Se&&Se.apply(this,arguments)||this;return t.mNode=null,t}var Oe,Fe=(t(Te,Oe=u),Object.defineProperty(Te.prototype,"DelayMove",{get:function(){return this.mDelayMove||(this.mDelayMove=new Ie),this.mDelayMove},enumerable:!0,configurable:!0}),Object.defineProperty(Te.prototype,"DelayShow",{get:function(){return this.mDelayShow||(this.mDelayShow=new Ae),this.mDelayShow},enumerable:!0,configurable:!0}),Te);function Te(){return Oe.call(this)||this}var Ee,Le=(t(Be,Ee=u),Be.prototype.onEnable=function(){},Be.prototype.loadAsset=function(t,o,e){if(l.getEngine()==r){if(n=cc.loader.getRes(t,o))return void(e&&e(null,n));cc.loader.loadRes(t,o,function(t,o){e&&e(t,o)})}else if(l.getEngine()==s){var n;if(n=Laya.loader.getRes(t))return void(e&&e(null,n));Laya.loader.create(t,Laya.Handler.create(this,function(t){e(null,t)}),null,o)}},Be.prototype.loadAssetDir=function(t,o,i,e){l.getEngine()==r?cc.loader.loadResDir(t,o,function(t,o,e){var n=t/o*100,n=Math.ceil(n);i&&i(n)},function(t,o){e&&e(t,o)}):console.warn("不支持loadAssetDir")},Be.prototype.onDisable=function(){},Be);function Be(){return Ee.call(this)||this}var xe=(De.create=function(t){return new t},Object.defineProperty(De.prototype,"hideForm",{get:function(){return this._hideForm},set:function(t){this._hideForm=t},enumerable:!0,configurable:!0}),De);function De(){this._hideForm=!0,this.extraData={}}var ke,Re=(t(Ue,ke=xe),Ue);function Ue(){var t=null!==ke&&ke.apply(this,arguments)||this;return t.coinNum=0,t.videoNum=0,t.shareCoinNum=0,t.isWin=!0,t.level="1",t}var Me,He=(t(Ve,Me=xe),Ve);function Ve(){var t=null!==Me&&Me.apply(this,arguments)||this;return t.showCoinAnim=!0,t.coinOptions=null,t.baseNum=1,t.callback=null,t.shareCallback=null,t.videoCallback=null,t}var We,je=(t(ze,We=xe),ze);function ze(){var t=null!==We&&We.apply(this,arguments)||this;return t.shareCoinNum=0,t}var Ge,Qe=(t(qe,Ge=xe),qe);function qe(){var t=null!==Ge&&Ge.apply(this,arguments)||this;return t.coinNum=0,t.videoNum=0,t.shareCoinNum=0,t}var Xe,Ke=(t(Ye,Xe=xe),Ye);function Ye(){var t=null!==Xe&&Xe.apply(this,arguments)||this;return t.type=1,t}var Ze,Je=function(){this.x=0,this.y=0,this.z=0},$e=(t(tn,Ze=xe),tn);function tn(){var t=null!==Ze&&Ze.apply(this,arguments)||this;return t.randomY=100,t.randomX=100,t.imgNum=30,t.coinNum=0,t.starVec=new Je,t.endVec=new Je,t}function on(){this.VIDEO_STATUS=f,this.VIDEO_MSG=ft,this.SHARE_MSG=mt,this.BANNER_POSITION=m,this.SHARE_CHANNEL=X,this.APP_PLATFORM=i,this.PLATFORM_EVENT=w,this.Common=l,this.AD_POSITION=Pt,this.showOptions={endOptions:Re,prizeOptions:He,shareOptions:je,totalOptions:Qe,touchOptions:Ke,coinOptions:$e},this.mData=new k,this.mResource=new Le,this.mSetting=new M,this.mForm=new ge,this.mControl=new fe,this.mEntity=new Ot,this.mAudio=null,this.mDelay=new Fe,(window.moosnow=this).mData=new k,this.mSetting=new M,this.mEvent=new vt,this.initPlatform(),this.initHttp(),this.initAd(),this.initUI(),this.initEntity()}new(on.prototype.getAppPlatform=function(){return l.platform},on.prototype.initUI=function(){this.mUi=new Ut},on.prototype.initEntity=function(){this.mEntity=new Et},on.prototype.initHttp=function(){l.platform!=i.WX&&l.platform==i.OPPO_ZS?this.mHttp=new ut:this.mHttp=new T},on.prototype.initPlatform=function(){l.platform==i.WX?this.mPlatform=new _:l.platform==i.OPPO?this.mPlatform=new B:l.platform==i.VIVO?this.mPlatform=new _t:l.platform==i.OPPO_ZS?this.mPlatform=new st:l.platform==i.BYTEDANCE?this.mPlatform=new Y:l.platform==i.QQ?this.mPlatform=new $:l.platform==i.BAIDU?this.mPlatform=new lt:this.mPlatform=new C},on.prototype.initAd=function(){l.platform==i.WX||l.platform==i.PC||l.platform==i.BYTEDANCE?this.mAd=new G:l.platform==i.OPPO?this.mAd=new W:l.platform==i.OPPO_ZS?this.mAd=new nt:this.mAd=new P},Object.defineProperty(on.prototype,"platform",{get:function(){return this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"ad",{get:function(){return this.mAd},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"http",{get:function(){return this.mHttp},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"data",{get:function(){return this.mData},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"resource",{get:function(){return this.mResource},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"setting",{get:function(){return this.mSetting},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"event",{get:function(){return this.mEvent},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"ui",{get:function(){return this.mUi},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"form",{get:function(){return this.mForm},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"control",{get:function(){return this.mControl},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"entity",{get:function(){return this.mEntity},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"audio",{get:function(){return this.mAudio},set:function(t){this.mAudio=t},enumerable:!0,configurable:!0}),Object.defineProperty(on.prototype,"delay",{get:function(){return this.mDelay},enumerable:!0,configurable:!0}),on)}();
