!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(o,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var n in o)o.hasOwnProperty(n)&&(t[n]=o[n])})(o,n)};function o(o,n){function e(){this.constructor=o}t(o,n),o.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var n=function(){return(n=Object.assign||function(t){for(var o,n=1,e=arguments.length;n<e;n++)for(var i in o=arguments[n])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};var e,i=function(){function t(){}return t.randomNumBoth=function(t,o){var n=o-t,e=Math.random();return t+Math.round(e*n)},t}();!function(t){t[t.WX=0]="WX",t[t.BYTEDANCE=1]="BYTEDANCE",t[t.OPPO=2]="OPPO",t[t.OPPO_ZS=3]="OPPO_ZS",t[t.BAIDU=4]="BAIDU",t[t.QQ=5]="QQ",t[t.PC=6]="PC",t[t.VIVO=7]="VIVO"}(e||(e={}));var r,s="cc",a="Laya",h="",l=function(){function t(){}return t.titleCase=function(t){var o,n=t.toLowerCase().split(/\s+/);for(o=0;o<n.length;o++)n[o]=n[o].slice(0,1).toUpperCase()+n[o].slice(1);return n.join(" ")},t.numFixed=function(t,o){return parseFloat(parseFloat(t).toFixed(o))},t.parseMoney=function(t){return isNaN(t)?0:parseFloat(parseFloat(t).toFixed(2))},t.objKeySort=function(t){for(var o=Object.keys(t).sort(),n={},e=0;e<o.length;e++)n[o[e]]=t[o[e]];return n},t.isObject=function(t){var o=typeof t;return null!==t&&("object"===o||"function"===o)},t.object2Query=function(t){var o=[];for(var n in t)o.push(n+"="+t[n]);return o.join("&")},t.isFunction=function(t){return"function"==typeof t},t.isEmpty=function(t){if("object"==typeof t){var o;for(o in t)return!1;return!0}return null==t||"null"===t||"undefined"===t||""===t},t.formatTime=function(t){return[t.getHours(),t.getMinutes()].map(this.formatNumber).join(":")},t.formatNumber=function(t){return(t=t.toString())[1]?t:"0"+t},t.copy=function(t,o){for(var n in t)o[n]=t[n]},t.randomNumBoth=function(t,o){var n=o-t,e=Math.random();return t+Math.round(e*n)},t.randomFloat=function(t,o){return t+Math.random()*o},t.randomToRatio=function(t,o,n){return this.randomNumBoth(t,o)<=n},t.generateUUID=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(o){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==o?n:3&n|8).toString(16)}))},t.isNumber=function(t){return"number"==typeof t||"[object Number]"==Object.prototype.toString.call(t)},t.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},Object.defineProperty(t,"platform",{get:function(){if(this.mPlatform)return this.mPlatform;var t=window.moosnowConfig;if(window.tt)this.mPlatform=e.BYTEDANCE;else if(window.swan)this.mPlatform=e.BAIDU;else if(window.qq)this.mPlatform=e.QQ;else if(window.qg)if(window.qg&&window.qg.getSystemInfoSync){var o=window.qg.getSystemInfoSync();console.log("平台判断",JSON.stringify(o)),o&&o.brand&&-1!=o.brand.toLocaleLowerCase().indexOf("vivo")?this.mPlatform=e.VIVO:-1!=t.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=e.OPPO_ZS:this.mPlatform=e.OPPO}else-1!=t.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=e.OPPO_ZS:this.mPlatform=e.OPPO;else window.wx?this.mPlatform=e.WX:t.debug&&t[t.debug]?"wx"==t.debug?this.mPlatform=e.WX:"oppo"==t.debug?-1!=t.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=e.OPPO_ZS:this.mPlatform=e.OPPO:"bd"==t.debug?this.mPlatform=e.BAIDU:"byte"==t.debug?this.mPlatform=e.BYTEDANCE:"qq"==t.debug?this.mPlatform=e.QQ:"vivo"==t.debug?this.mPlatform=e.VIVO:this.mPlatform=e.PC:this.mPlatform=e.PC;return this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(t,"config",{get:function(){var o=window.moosnowConfig;return t.platform==e.WX?o.wx:t.platform==e.OPPO||t.platform==e.OPPO_ZS?o.oppo:t.platform==e.VIVO?o.vivo:t.platform==e.QQ?o.qq:t.platform==e.BAIDU?o.bd:t.platform==e.BYTEDANCE?o.byte:o.wx},enumerable:!0,configurable:!0}),t.deepCopy=function(t){var o=Array.isArray(t)?[]:{};if(t&&"object"==typeof t)for(var n in t)t.hasOwnProperty(n)&&(t[n]&&"object"==typeof t[n]?o[n]=this.deepCopy(t[n]):o[n]=t[n]);return o},t.getEngine=function(){return window[s]?s:window[a]?a:h},t.popOpenAnim=function(t,o){if(this.getEngine()==s)return t.scale=.8,void t.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1),cc.callFunc((function(){o&&o()}),this)));o()},t.popCloseAnim=function(t,o){if(this.getEngine()==s)return t.scale=1,void t.runAction(cc.sequence(cc.scaleTo(.1,0,0),cc.callFunc((function(){o&&o()}),this)));o()},t.format=function(t){for(var o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];if(void 0===t||null==t||""==t||"undefined"==t)return t;for(var e=0;e<o.length;e++){var i=new RegExp("\\{"+e+"\\}","gm");t=t.replace(i,o[e])}return t},t.formatMoney=function(t){return isNaN(t)&&(t=0),t<9999?parseInt(""+t):t<9999999?parseFloat(""+t/1e3).toFixed(2)+"K":t<9999999999?parseFloat(""+t/1e6).toFixed(2)+"M":t<9999999999999?parseFloat(""+t/1e9).toFixed(2)+"G":t<1e16?parseFloat(""+t/1e12).toFixed(2)+"T":t<1e19?parseFloat(""+t/1e15).toFixed(2)+"P":t<1e22?parseFloat(""+t/1e18).toFixed(2)+"E":parseFloat(""+t/1e21).toFixed(2)+"B"},t}(),c=function(){function t(){this.moduleName="",this.mIntervalArr={},this.mTimeoutArr={}}return t.prototype.schedule=function(t,o){var n=this,e=setInterval((function(){t&&t.apply(n)}),1e3*o);console.log("BaseModule schedule ",e),this.mIntervalArr[e]=t},t.prototype.unschedule=function(t){for(var o in this.mIntervalArr)(this.mIntervalArr[o]===t||l.isEmpty(this.mIntervalArr[o]))&&clearInterval(parseInt(o))},t.prototype.scheduleOnce=function(t,o){var n=this,e=setTimeout((function(){clearTimeout(e),t&&t.apply(n)}),1e3*o);this.mTimeoutArr[e]=t},t.prototype.unscheduleOnce=function(t){for(var o in this.mTimeoutArr)(this.mTimeoutArr[o]===t||l.isEmpty(this.mTimeoutArr[o]))&&clearTimeout(parseInt(o))},t.prototype.initProperty=function(t){for(var o in t)this.hasOwnProperty(o)&&(this[o]=t[o])},t.prototype.preload=function(t,o){o&&o()},t.prototype._findComponent=function(t,o){for(var n=null,e=0;e<t._components.length;e++){var i=t._components[e];if(i.willHide&&i.willShow){n=i;break}}return n},t.prototype._findComponentByName=function(t,o){return!!t&&(t.name==o||this._findComponentByName(t.$super,o))},t}(),p={TOP:"__banner_top",CENTER:"__banner_center",BOTTOM:"__banner_bottom",CUSTOM:"__banner_custom"},u={END:"__video_end",NOTEND:"__video_not_end",ERR:"__video_error"},m=function(){function t(){}return t.VIBRATESWITCH_CHANGED="VIBRATESWITCH_CHANGED",t.SOUNDSWITCH_CHANGED="SOUNDSWITCH_CHANGED",t.MUSICSWITCH_CHANGED="MUSICSWITCH_CHANGED",t.ON_PLATFORM_SHOW="ON_PLATFORM_SHOW",t.ON_PLATFORM_HIDE="ON_PLATFORM_HIDE",t.ON_BANNER_HIDE="ON_BANNER_HIDE",t.ON_AD_SHOW="ON_AD_SHOW",t.AD_VIEW_CHANGE="AD_VIEW_CHANGE",t.AD_VIEW_REFRESH="AD_VIEW_REFRESH",t.COIN_CHANGED="COIN_CHANGED",t}(),d="隐藏banner",f="你的好友{0}邀请你加入",w="banner id 没有配置",g="显示BANNER",y="banner位置或大小被重新设置",v="跳转太频繁 >>>>>>>>>>>>>>>>>>>>>",b="跳转数据",C="设备信息",N="video id 没有配置",I="加载video成功回调",_="video关闭回调",S="video加载错误",A="加载原生广告成功",P="原生广告加载出错,使用新ID加载原生广告",O="原生广告加载出错，本次没有广告",F="原生广告ID已经用完，本次没有广告",E="点击了原生广告",T="上报原生广告",L="原生广告数据没有，回调Null",B="原生广告销毁",x="插屏广告ID为空，系统不加载",D="阿拉丁文件未引入",k="版本过低 平台不支持",R=function(t){function n(){var o=t.call(this)||this;return o.baseUrl="https://api.liteplay.com.cn/",o.currentShareCallback=null,o.shareFail=null,o.vibrateOn=!1,o.systemInfo=null,o.banner=null,o.video=null,o.inter=null,o.native=null,o.box=null,o.platformName="wx",o.bannerId="",o.videoId="",o.interId="",o.boxId="",o.nativeId=[],o.nativeIdIndex=0,o.bannerWidth=300,o.bannerHeigth=96,o.bannerShowCount=0,o.bannerShowCountLimit=3,o.bannerCb=null,o.bannerPosition=p.BOTTOM,o.bannerStyle=null,o.isBannerShow=!1,o.videoCb=null,o.videoLoading=!1,o.videoPlaying=!1,o.interShowCount=0,o.interShowCountLimit=3,o.isInterLoaded=!1,o.nativeAdResult=null,o.nativeCb=null,o.nativeLoading=!1,o.record=null,o.shareInfoArr=[],o.versionRet=null,o.prevNavigate=Date.now(),o.initAppConfig(),o.initShare(!0),o.share_clickTime=null,o.currentShareCallback=null,o.shareFail=!1,o.updateProgram(),o.initRecord(),o}return o(n,t),n.prototype.onEnable=function(){},n.prototype.vibrateSwitch=function(t){this.vibrateOn=t},n.prototype.initAppConfig=function(){this.moosnowConfig=l.config,this.bannerId=this.moosnowConfig.bannerId,this.videoId=this.moosnowConfig.videoId,this.interId=this.moosnowConfig.interId,this.boxId=this.moosnowConfig.boxId,this.nativeId=this.moosnowConfig.nativeId,console.log("moosnowConfig ",JSON.stringify(this.moosnowConfig))},n.prototype.isIphoneXModel=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone x/.test(t.model.toLowerCase())}},n.prototype.isIphone=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone/.test(t.model.toLowerCase())}},n.prototype.isIphoneX=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),o=t.screenHeight,n=t.screenWidth/o;return n<=.5||n>=2}},n.prototype.compareVersion=function(t,o){t=t.split("."),o=o.split(".");for(var n=Math.max(t.length,o.length);t.length<n;)t.push("0");for(;o.length<n;)o.push("0");for(var e=0;e<n;e++){var i=parseInt(t[e]),r=parseInt(o[e]);if(i>r)return 1;if(i<r)return-1}return 0},n.prototype.supportVersion=function(t){var o=this.getSystemInfoSync().SDKVersion;return this.compareVersion(o,t)>=0},n.prototype.supportFunction=function(t){return!!window[this.platformName]&&!!window[this.platformName][t]},n.prototype.checkVersion=function(t,o){null==this.versionRet?this._checkConfigVersion(o):o(this.versionRet)},n.prototype._checkRemoteVersion=function(t){var o=this,n=this.baseUrl+"admin/wx_list/getAppConfig",e={appid:this.moosnowConfig.moosnowAppId};moosnow.http.request(n,e,"POST",(function(n){o.versionRet=o.checkLog(n.data.version),t(o.versionRet)}),(function(){console.log("checkVersion fail")}),(function(){console.log("checkVersion complete")}))},n.prototype._checkConfigVersion=function(t){var o=this;moosnow.http.getAllConfig((function(n){n&&n.version?(o.versionRet=o.checkLog(n.version),t(o.versionRet)):o._checkRemoteVersion(t)}))},n.prototype.checkLog=function(t){var o=moosnow.platform.moosnowConfig.version,n=t==o;return console.log("版本检查 后台版本"+t+" 配置文件版本"+o),console.log("获取广告开关：",n),n},n.prototype.isSmallWidth=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),o=t.screenHeight;t.screenWidth;return o<667&&(console.log("高度不够",o),!0)}},n.prototype.login=function(t,o){if(l.isFunction(t)){var n=moosnow.data.getToken();n||(n=(n=l.generateUUID()).replace(/-/g,""),moosnow.data.setToken(n)),t(n)}},n.prototype.postMessage=function(t){window[this.platformName]&&window[this.platformName].getOpenDataContext&&window[this.platformName].getOpenDataContext().postMessage(t)},n.prototype.navigate2Mini=function(t,o,n,e){var i=this;if(console.log(b,t),Date.now()-this.prevNavigate<300)console.log(v);else if(this.prevNavigate=Date.now(),window[this.platformName]){var r=t.appid,s=t.path,a=t.extraData;a=a||{},moosnow.http.navigate(r,(function(h){window[i.platformName].navigateToMiniProgram({appId:r,path:s,extraData:a,success:function(){moosnow.http.point("跳转",{position:t.position,appid:r,img:t.atlas||t.img}),moosnow.http.navigateEnd(h.code),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMini fail ",t," fail callback ",!!n),n&&n()},complete:function(){e&&e()}})}))}else n&&n()},n.prototype.updateProgram=function(){var t=this;if(window[this.platformName]&&"function"==typeof window[this.platformName].getUpdateManager){var o=window[this.platformName].getUpdateManager();o.onCheckForUpdate((function(t){})),o.onUpdateReady((function(n){t.showModal("发现新版本","新版本已经准备好，是否更新？","取消","更新",(function(t){t&&o.applyUpdate()}))})),o.onUpdateFailed((function(){}))}},n.prototype.vibrateShort=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateShort||window[this.platformName].vibrateShort())},n.prototype.vibrateLong=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateLong||window[this.platformName].vibrateLong())},n.prototype.showLoading=function(t){window[this.platformName]?window[this.platformName].showLoading({title:t,mask:!1,success:null,fail:null,complete:null}):console.log("showLoading",t)},n.prototype.hideLoading=function(){window[this.platformName]&&window[this.platformName].hideLoading()},n.prototype.showModal=function(t,o,n,e,i){window[this.platformName]&&window[this.platformName].showModal({title:t,content:o,cancelText:n,confirmText:e,showCancel:!0,cancelColor:"#000000",confirmColor:"#3CC51F",fail:null,complete:null,success:function(t){t.confirm?i&&i(!0):t.cancel&&i&&i(!1)}})},n.prototype.showModalWithoutCancel=function(t,o,n,e){window[this.platformName]&&window[this.platformName].showModal({title:t,content:o,showCancel:!1,confirmText:n,cancelColor:"#000000",confirmColor:"#3CC51F",cancelText:"",fail:null,complete:null,success:function(t){t.confirm?e&&e(!0):t.cancel&&e&&e(!1)}})},n.prototype.showToast=function(t,o,n){void 0===o&&(o="none"),void 0===n&&(n=!1),window[this.platformName]&&window[this.platformName].showToast({title:t,icon:o,duration:2e3,mask:n,image:null,success:null,fail:null,complete:null})},n.prototype.authOrGetUserInfo=function(t){if(window[this.platformName]){var o=this;this.getSetting((function(n){console.log("授权信息",n),n["scope.userInfo"]?o.getUserInfo((function(o){console.log("获取用户信息：",o),t(o,!1)}),(function(t){})):o.showUserInfoButton((function(o){t(o,!0),console.log("授权获取用户信息：",o)}))}),(function(n){o.showUserInfoButton((function(o){t(o,!0),console.log("授权获取用户信息：",o)}))}))}},n.prototype.showUserInfoButton=function(t){var o={type:"text",text:"",style:this._initLoginButton()},n=window[this.platformName].createUserInfoButton(o);n.onTap((function(o){o.userInfo&&o.userInfo.nickName?(t(o.userInfo),n.hide()):t(null)})),n.show()},n.prototype.getSetting=function(t,o){window[this.platformName].getSetting({success:function(o){t(o.authSetting)},fail:function(){o()},complete:null})},n.prototype.getUserInfo=function(t,o){window[this.platformName].getUserInfo({success:function(o){t(o.userInfo)},fail:function(){o()},withCredentials:!1,complete:null,lang:"en"})},n.prototype.getLaunchOption=function(){return window[this.platformName]&&window[this.platformName].getLaunchOptionsSync?window[this.platformName].getLaunchOptionsSync():{}},n.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log(C,this.systemInfo)),this.systemInfo},n.prototype.isLandscape=function(t,o){return t<o},n.prototype.initShare=function(t){var o=this;window[this.platformName]&&window[this.platformName].showShareMenu&&(this.shareInfoArr=t,window[this.platformName].showShareMenu({withShareTicket:!0,success:null,fail:null,complete:null}),window[this.platformName].onShareAppMessage&&window[this.platformName].onShareAppMessage((function(){return o._buildShareInfo()})))},n.prototype.getShareInfo=function(t,o,n){void 0===n&&(n=null),window[this.platformName]&&window[this.platformName].getShareInfo({shareTicket:t,success:function(t){o(t.encryptedData,t.iv)},fail:function(){n&&n()},complete:null})},n.prototype.share=function(t,o){void 0===t&&(t={}),window[this.platformName]||o&&o(!0),this.currentShareCallback=o,this.share_clickTime=Date.now(),this.shareFail=!1,this._share(t)},n.prototype.shareWithoutCheck=function(t,o){void 0===t&&(t={}),window[this.platformName]||o&&o(!0),this.currentShareCallback=o,this.share_clickTime=1,this.shareFail=!1,this._share(t)},n.prototype._share=function(t){if(void 0===t&&(t=null),window[this.platformName])if(window[this.platformName].shareAppMessage){var o=this._buildShareInfo(t);console.log("分享数据：",o),window[this.platformName].shareAppMessage(o)}else this.currentShareCallback(!0);else this.currentShareCallback(!0)},n.prototype._buildShareInfo=function(t){void 0===t&&(t=null);var o="",n="";if(this.shareInfoArr.length>0){var e=this.shareInfoArr[i.randomNumBoth(0,this.shareInfoArr.length-1)];o=e.title,n=e.img}return{title:o,imageUrl:n,query:t}},n.prototype._onShareback=function(){var t=this;setTimeout((function(){t.share_clickTime&&t.currentShareCallback&&(t.shareFail?t.currentShareCallback(!1):1==t.share_clickTime||Date.now()-t.share_clickTime>=3e3?t.currentShareCallback(!0):t.currentShareCallback(!1)),t.shareFail=!1,t.currentShareCallback=null,t.share_clickTime=null}),100)},n.prototype._initLoginButton=function(){if(window[this.platformName]){var t=window[this.platformName].getSystemInfoSync();return{left:0,top:0,width:t.screenWidth,height:t.screenHeight,lineHeight:40,color:"#ffffff",type:"text",text:"获取用户信息",textAlign:"center",fontSize:28}}},n.prototype.initRecord=function(){},n.prototype.clipRecord=function(){},n.prototype.startRecord=function(t,o){void 0===t&&(t=300),void 0===o&&(o=null),this.record||o&&o(!1)},n.prototype.stopRecord=function(t){void 0===t&&(t=null),this.record||t&&t(!1)},n.prototype.pauseRecord=function(){},n.prototype.resumeRecord=function(){},n.prototype._regisiterWXCallback=function(){window[this.platformName]&&(this._regisiterOnShow(),this._regisiterOnHide())},n.prototype._regisiterOnShow=function(){if(window[this.platformName].onShow){var t=this;window[this.platformName].onShow((function(o){t._onShowCallback(o)}))}},n.prototype._onShowCallback=function(t){this._onShareback(),console.log("on show ",t),moosnow.event.sendEventImmediately(m.ON_PLATFORM_SHOW,t)},n.prototype._regisiterOnHide=function(){if(window[this.platformName].onHide){var t=this;window[this.platformName].onHide((function(o){t._onHideCallback(o)}))}},n.prototype._onHideCallback=function(t){console.log("on show ",t),moosnow.event.sendEventImmediately(m.ON_PLATFORM_HIDE,t),console.log("on hide ",t);var o=t&&(8==t.targetAction||9==t.targetAction||10==t.targetAction)&&t.targetPagePath.length>50;o&&moosnow.http.clickBanner(),this.bannerCb?this.bannerCb(o):console.log("banner callback is null ")},n.prototype.initBanner=function(){window[this.platformName]&&this._prepareBanner()},n.prototype._prepareBanner=function(){if(window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.windowWidth;t.windowHeight<t.windowWidth?o<this.bannerWidth&&(this.bannerWidth=o):this.bannerWidth=o,this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad)),this.banner=this._createBannerAd(),this.banner&&(this.banner.onResize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)))}},n.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=(this.getSystemInfoSync().windowWidth-this.bannerWidth)/2;if(!l.isEmpty(this.bannerId))return window[this.platformName].createBannerAd({adUnitId:this.bannerId,style:{top:0,left:t,width:this.bannerWidth}});console.warn(w)}},n.prototype._onBannerLoad=function(){this.bannerShowCount=0},n.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode,t.errMsg),this.banner=null,this.isBannerShow=!1,moosnow.event.sendEventImmediately(m.ON_BANNER_HIDE,null)},n.prototype._bottomCenterBanner=function(t){var o=this.getSystemInfoSync().windowWidth;this.banner.style.left=(o-t.width)/2,this.bannerWidth=this.banner.style.realWidth,this.bannerHeigth=this.banner.style.realHeight,console.log("_bottomCenterBanner",this.banner.style)},n.prototype._resetBanenrStyle=function(t){if(l.isEmpty(t))console.log("设置的banner尺寸为空,不做调整");else{var o=this.getSystemInfoSync(),n=(o.windowWidth,o.windowHeight),e=0;this.bannerPosition==p.BOTTOM?e=n-this.bannerHeigth:this.bannerPosition==p.CENTER?e=(n-this.bannerHeigth)/2:this.bannerPosition==p.TOP&&(e=0),this.bannerStyle?this.banner.style=this.bannerStyle:(this.banner.style.top=e,console.log(y,this.banner.style,"set top ",e))}},n.prototype.showBanner=function(t,o,n){var e=this;void 0===o&&(o=p.BOTTOM),console.log(g),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=n,this.mTimeoutId&&(clearTimeout(this.mTimeoutId),this.mTimeoutId=null),this.banner&&(console.log("show banner style ",this.banner.style),this.banner.hide(),this._resetBanenrStyle({width:this.banner.style.width,height:this.banner.style.realHeight}),this.banner.show().then((function(){e._resetBanenrStyle({width:e.banner.style.width,height:e.banner.style.realHeight})}))))},n.prototype.showAutoBanner=function(){var t=this;console.log("执行自动显示和隐藏Banner功能"),moosnow.http.getAllConfig((function(o){if(o&&1==o.gameBanner){moosnow.platform.showBanner();var n=isNaN(o.gameBanenrHideTime)?1:parseFloat(o.gameBanenrHideTime);t.mTimeoutId=setTimeout((function(){console.log("自动隐藏时间已到，开始隐藏Banner"),t.isBannerShow,t.hideBanner()}),1e3*n)}}))},n.prototype.showIntervalBanner=function(){var t=this;console.log("执行 showIntervalBanner"),moosnow.http.getAllConfig((function(o){var n=o&&!isNaN(o.gameBannerInterval)?parseFloat(o.gameBannerInterval):20;!o||o.gameBanner;t.schedule(t.showAutoBanner,n)}))},n.prototype.clearIntervalBanner=function(){console.log("执行 clearIntervalBanner"),this.unschedule(this.showAutoBanner)},n.prototype.hideBanner=function(){console.log(d),this.isBannerShow&&(this.isBannerShow=!1,window[this.platformName]&&(this.bannerShowCount++,this.banner?this.bannerShowCount>=this.bannerShowCountLimit?(console.log("banner destroy"),this.banner.hide(),this.banner.destroy(),this.banner=null,this._prepareBanner()):this.banner.hide():this._prepareBanner()))},n.prototype.initVideo=function(){this.createRewardAD(!1)},n.prototype.createRewardAD=function(t){var o=this;if(!moosnow.platform.videoLoading)if(window[this.platformName])if(window[this.platformName].createRewardedVideoAd){if(l.isEmpty(this.videoId))return console.warn(N),void moosnow.platform.videoCb(u.END);if(this.video)this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad);else if(this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.videoId}),!this.video)return void console.warn("创建视频广告失败");this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad),moosnow.platform.videoLoading=!0,this.videoPlaying=!1,this.video.load().then((function(){t&&o.video.show().then((function(){})).catch((function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))})).catch((function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))}else moosnow.platform.videoCb(u.END);else moosnow.platform.videoCb(u.END)},n.prototype._onVideoError=function(t,o){console.log(S,t,o),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,moosnow.platform.videoCb&&(moosnow.platform.videoCb(u.ERR),moosnow.platform.videoCb=null)},n.prototype._onVideoClose=function(t){if(console.log(_,t.isEnded),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,t.isEnded&&moosnow.http.clickVideo(),moosnow.platform.videoCb){var o=t.isEnded?u.END:u.NOTEND;setTimeout((function(){moosnow.platform.videoCb(o)}),50)}},n.prototype._onVideoLoad=function(){console.log(I),moosnow.platform.videoLoading=!1},n.prototype.showVideo=function(t){void 0===t&&(t=null),console.log("显示video"),moosnow.platform.videoCb=t,this.createRewardAD(!0)},n.prototype.initInter=function(){this.prepareInter()},n.prototype.prepareInter=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createInterstitialAd&&this.supportVersion("2.8.0")&&(l.isEmpty(this.interId)?console.warn(x):(this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this))))},n.prototype.showInter=function(){this.inter&&this.isInterLoaded&&this.inter.show()},n.prototype._onInterLoad=function(){this.interShowCount=0,this.isInterLoaded=!0,console.log("插屏广告加载完成")},n.prototype._onInterClose=function(){this.interShowCount++,this.interShowCount>=this.interShowCountLimit&&(this.isInterLoaded=!1,this.inter.load())},n.prototype._onInterError=function(t){console.log("插屏广告出错：",t)},n.prototype._prepareNative=function(){},n.prototype._onNativeLoad=function(t){},n.prototype._onNativeError=function(t){},n.prototype._destroyNative=function(){},n.prototype.showNativeAd=function(t){l.isFunction(t)&&t()},n.prototype.clickNative=function(t){},n.prototype.showAppBox=function(t,o){void 0===o&&(o=!0),l.isFunction(t)&&t()},n.prototype.hideAppBox=function(t){l.isFunction(t)&&t()},n.prototype.reportMonitor=function(t,o){},n.prototype.showMoreGameButton=function(t,o,n){void 0===n&&(n=null),o&&o()},n.prototype.initRank=function(){this.postMessage({action:1})},n.prototype.showRank=function(){this.postMessage({action:10})},n.prototype.updateUserScore=function(t){var o={action:13,data:t};this.postMessage(o)},n.prototype.hideRank=function(){this.postMessage({action:20})},n.prototype.onDisable=function(){},n}(c),U=function(t){function n(){var o=t.call(this)||this;return o.platformName="wx",o._regisiterWXCallback(),o.initBanner(),o.initInter(),o}return o(n,t),n.prototype.login=function(o,n){moosnow.http.getAllConfig((function(t){}));var e=this,i=moosnow.data.getToken();i?e.getUserToken("",i,o):window[this.platformName]&&window[this.platformName].login?window[this.platformName].login({success:function(t){t.code?e.getUserToken(t.code,"",o):l.isFunction(o)&&o()},fail:function(){}}):t.prototype.login.call(this,o,n)},n.prototype.getUserToken=function(t,o,n){var e=this.getLaunchOption(),i=e.scene,r=e.query&&e.query.channel_id?e.query.channel_id:"0",s=e.referrerInfo&&e.referrerInfo.appId?e.referrerInfo.appId:"0";moosnow.data.setChannelAppId(s),moosnow.data.setChannelId(r);var a=e.referrerInfo?e.referrerInfo.appId:"未知";window[this.platformName]&&window[this.platformName].aldSendEvent&&window[this.platformName].aldSendEvent("来源",{origin:a,path:e.query.from||0}),moosnow.http.request(this.baseUrl+"api/channel/login.html",{appid:moosnow.platform.moosnowConfig.moosnowAppId,code:t,user_id:o,channel_id:r,channel_appid:s,scene:i,fromApp:a},"POST",(function(t){0==t.code&&t.data&&t.data.user_id&&moosnow.data.setToken(t.data.user_id),l.isFunction(n)&&n(t)}),(function(){l.isFunction(n)&&n({})}))},n}(R),M=function(t){function e(){var o=t.call(this)||this;return o.baseUrl="https://api.liteplay.com.cn/admin/",o.cacheImage=null,o.cacheKey="cacheUrl",o.getResUrl=function(t){for(var o in this.this.cacheImage)if(this.this.cacheImage[o]==t)return o;return""},o.convertToCacheUrl=function(t,o){this.cacheImage[t]?o(this.cacheImage[t]):this.downloadImage(t,(function(t){o(t)}))},o.saveCacheUrl=function(t){var o=[],n=window.wx.getFileSystemManager();for(var e in this.cacheImage){var i=!0;for(var r in t)for(var s=0;s<t[r].length;s++)t[r][s].atlas!=this.cacheImage[e]&&t[r][s].img!=this.cacheImage[e]||(i=!1);i&&o.push(e)}for(s=0;s<o.length;s++){if(o[s]){console.log("clear file ",o[s]);try{n.removeSavedFile(o[s])}catch(t){console.log("clear file error ",o[s])}}delete this.cacheImage[o[s]]}window.wx&&window.wx.setStorage({key:this.cacheKey,data:this.cacheImage,success:function(){},fail:function(){},complete:function(){}})},o.mMemory={},o.getCache=function(){return this.mMemory},o.setCache=function(t){this.mMemory=t},o}return o(e,t),e.prototype.getDistinctAd=function(t){for(var o=[],n=[],e=t.sort((function(t,o){return Math.random()>.5?1:-1})),i=0;i<e.length;i++){for(var r=e[i],s=!0,a=0;a<o.length;a++){if(o[a].appid==r.appid){s=!1;break}}s?o.push(r):n.push(r)}return function(){for(var t=0,o=0,n=arguments.length;o<n;o++)t+=arguments[o].length;var e=Array(t),i=0;for(o=0;o<n;o++)for(var r=arguments[o],s=0,a=r.length;s<a;s++,i++)e[i]=r[s];return e}(o,n)},e.prototype.getAd=function(t){var o=this,e=this.getCache();if(l.isEmpty(e.indexLeft))this.getRemoteAd((function(i){var r=o.initRetValue();i.forEach((function(t){r=o.formatRow(r,t)})),o.setCache(r);var s=o.getDistinctAd(r.indexLeft),a=n(n({},e),{indexLeft:s});t(a)}));else{var i=this.getDistinctAd(e.indexLeft),r=n(n({},e),{indexLeft:i});t(r)}},e.prototype.getRemoteAd=function(t){t([])},e.prototype.loadCacheImage=function(t){var o=this;this.cacheImage?t(this.cacheImage):wx.getStorage({key:this.cacheKey,success:function(t){this.this.cacheImage=t.data,console.log("cacheKey data  ",t.data)},fail:function(){o.cacheImage={},console.log("cacheKey error ")},complete:function(){t(this.this.cacheImage)}})},e.prototype.initRetValue=function(){return{indexBanner:[],indexFloat:[],indexLeft:[],gameEndPage:[],gameRespawnPage:[],exportPage:[]}},e.prototype.formatRow=function(t,o){switch(o.position){case"1":t.indexLeft.push(o);break;case"2":t.indexFloat.push(o);break;case"3":t.indexBanner.push(o);break;case"4":t.gameEndPage.push(o);break;case"5":t.gameRespawnPage.push(o);break;case"6":t.exportPage.push(o);break;default:t.indexLeft.push(o)}return t},e.prototype.downloadImage=function(t,o){window.wx?wx.downloadFile({header:{},url:t,success:function(n){var e=this;200===n.statusCode&&wx.saveFile({tempFilePath:n.tempFilePath,success:function(n){e.cacheImage[""+t]=n.savedFilePath,o(n.savedFilePath)},fail:function(){o(t)},complete:function(){}})},fail:function(){o(t)},complete:function(){}}):o(t)},e}(c),H=function(t){function i(){var o=t.call(this)||this;o.appid="",o.secret="",o.versionNumber="",o.version="2.0.1",o.baseUrl="https://api.liteplay.com.cn/",o._cdnUrl="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com",o.mLaunchOptions={},o.cfgData=null,o.areaData=null,o._cfgQuene=[],o._localQuene=[];var n=o._cdnUrl+"/SDK/version.json?t="+Date.now();return l.platform==e.PC?o.request(n,{},"GET",(function(t){o.version<t.version&&(console.warn("您的SDK版本号["+o.version+"]不是最新版本，请尽快升级，最新版本["+t.version+"]  下载地址："+t.download),l.isEmpty(t.memo)||console.warn(""+t.memo))})):l.platform==e.WX&&window.wx&&o.request(n,{},"GET",(function(t){var o=window.wx.aldVersion;(!o||o&&o<t.aldVersion)&&console.warn("阿拉丁文件错误，请重新下载"+t.aldUrl)})),o.getShareInfo((function(t){moosnow.platform.initShare(t)})),o.loadCfg((function(t){console.log("remote config ",t)})),o}return o(i,t),Object.defineProperty(i.prototype,"appLaunchOptions",{get:function(){return this.mLaunchOptions||moosnow.platform&&moosnow.platform.getLaunchOption&&(this.mLaunchOptions=moosnow.platform.getLaunchOption()),this.mLaunchOptions},enumerable:!0,configurable:!0}),i.prototype.request=function(t,o,n,e,i,r){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState){var t=s.responseText;if(s.status>=200&&s.status<400){var o={};try{o=JSON.parse(t)}catch(o){console.error("json parse error ",t),i&&i(o)}e&&e(o)}else console.warn("error ",t),i&&i(t)}},s.timeout=1e4,s.ontimeout=function(t){console.error("error ",t),i&&i(t)},s.open(n,t,!0),"POST"==n?(s.open("POST",t),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(this._object2Query(o))):s.send()},i.prototype._object2Query=function(t){var o=[];for(var n in t)o.push(n+"="+t[n]);return o.join("&")},i.prototype.isDisableArea=function(t){},i.prototype.finishLoading=function(){this.postData("api/channel/validUser.html")},i.prototype.clickBanner=function(){this.postData("api/channel/clickBanner.html")},i.prototype.clickVideo=function(){this.postData("api/channel/clickVideo.html")},i.prototype.exportUser=function(){this.postData("api/channel/exportUser.html")},i.prototype.navigate=function(t,o){var n=moosnow.data.getToken();this.request(this.baseUrl+"api/jump/record",{appid:l.config.moosnowAppId,uid:n,jump_appid:t},"POST",(function(t){console.log("navigate",t),o&&o(t.data)}))},i.prototype.navigateEnd=function(t){this.request(this.baseUrl+"api/jump/status",{code:t},"POST",(function(o){console.log("navigateEnd code ",t,o)}))},i.prototype.postData=function(t){var o=moosnow.data.getToken();if(!l.isEmpty(o)&&"0"!=moosnow.data.getChannelId()&&"0"!=moosnow.data.getChannelAppId())try{this.request(""+this.baseUrl+t,{appid:l.config.moosnowAppId,user_id:o,channel_id:moosnow.data.getChannelId(),channel_appid:moosnow.data.getChannelAppId()},"POST",(function(t){}))}catch(t){console.log("postData error ",t)}},i.prototype.point=function(t,o){void 0===o&&(o=null),l.platform==e.WX&&window.wx&&window.wx.aldSendEvent&&window.wx.aldSendEvent(t,o)},i.prototype.startGame=function(t){l.platform==e.WX&&(window.wx&&window.wx.aldStage?window.wx.aldStage.onStart({stageId:t,stageName:t,userId:moosnow.data.getToken()}):console.warn(D))},i.prototype.endGame=function(t,o){if(l.platform==e.WX){var n=o?"complete":"fail",i=o?"关卡完成":"关卡失败";window.wx&&window.wx.aldStage?window.wx.aldStage.onEnd({stageId:t,stageName:t,userId:moosnow.data.getToken(),event:n,params:{desc:i}}):console.warn(D)}},i.prototype.videoPoint=function(t,o,n){if(l.platform==e.WX){var i=0==t?"点击视频":"观看完成视频";window.wx&&window.wx.aldSendEvent?window.wx.aldSendEvent(i,{info:o,level:n+""}):console.warn(D)}},i.prototype.getAllConfig=function(t){var o=this;this.loadCfg((function(e){o.loadArea((function(i){o.disableAd(e,i,(function(o){t(o?n(n({},e),{mistouchNum:0,mistouchPosNum:0,bannerShowCountLimit:1}):e)}))}))}))},i.prototype.loadCfg=function(t){var o=this;if(l.isEmpty(this.cfgData)){if(this._cfgQuene.push(t),this._cfgQuene.length>1)return;var e="";e=l.config.url?l.config.url+"?t="+Date.now():this._cdnUrl+"/config/"+l.config.moosnowAppId+".json",this.request(e,{},"GET",(function(t){o.cfgData=n(n({},l.deepCopy(t)),{zs_native_click_switch:t&&t.mx_native_click_switch?t.mx_native_click_switch:0,zs_jump_switch:t&&t.mx_jump_switch?t.mx_jump_switch:0}),moosnow.platform&&(moosnow.platform.bannerShowCountLimit=parseInt(t.bannerShowCountLimit)),o._cfgQuene.forEach((function(t){t(o.cfgData)})),o._cfgQuene=[]}),(function(){o._cfgQuene.forEach((function(t){t({mistouchNum:0,mistouchPosNum:0,bannerShowCountLimit:1})})),o._cfgQuene=[],console.log("load config json fail")}))}else t(this.cfgData)},i.prototype.loadArea=function(t){var o=this;if(this.areaData)t(this.areaData);else{if(this._localQuene.push(t),this._localQuene.length>1)return;var n=this.baseUrl+"admin/wx_config/getLocation";this.request(n,{},"GET",(function(t){o.areaData=t,o._localQuene.forEach((function(t){t(o.areaData)})),o._localQuene=[]}),(function(){o._localQuene.forEach((function(t){t(o.areaData)})),o._localQuene=[]}))}},i.prototype.getForceExport=function(t){var o=this;this.loadCfg((function(n){o.loadArea((function(e){o.disabledForceExport(n,e,(function(o){t(o)}))}))}))},i.prototype.disabledForceExport=function(t,o,n){var e=l.formatTime(new Date),i=!1;if(t.disabledForceExport)for(var r=0;r<t.disabledForceExport.length;r++){var s=t.disabledForceExport[r];if(-1!=o.data.city.indexOf(s)||-1!=o.data.province.indexOf(s)||-1!=o.data.area.indexOf(s)){i=!0;break}}i?t.forceExportTime&&2==t.forceExportTime.length?e>t.forceExportTime[0]&&e<t.forceExportTime[1]?n(!0):n(!1):n(!0):n(!1)},i.prototype.getMisTouchNum=function(t){var o=this;this.loadCfg((function(n){o.loadArea((function(e){o.disableAd(n,e,(function(o){o?(t(0),console.log("getMisTouchNum",0,"disableAd",o)):(t(parseInt(n.mistouchNum)),console.log("getMisTouchNum",n.mistouchNum,"disableAd",o))}))}))}))},i.prototype.getMistouchPosNum=function(t){var o=this;this.loadCfg((function(n){o.loadArea((function(e){o.disableAd(n,e,(function(o){o?(t(0),console.log("getMistouchPosNum",0,"disableAd",o)):(t(parseInt(n.mistouchPosNum)),console.log("getMistouchPosNum",n.mistouchPosNum,"disableAd",o))}))}))}))},i.prototype.getBannerShowCountLimit=function(t){this.loadCfg((function(o){isNaN(o.bannerShowCountLimit)?t(5):t(parseInt(o.bannerShowCountLimit))}))},i.prototype.disableAd=function(t,o,n){var e=l.formatTime(new Date),i=!1;if(t&&t.disabledRegion)for(var r=0;r<t.disabledRegion.length;r++){var s=t.disabledRegion[r];if(o&&o.data&&(-1!=o.data.city.indexOf(s)||-1!=o.data.province.indexOf(s)||-1!=o.data.area.indexOf(s))){i=!0;break}}if(this.appLaunchOptions&&-1!=[1005,1007,1008,1044].indexOf(this.appLaunchOptions.scene))return n(!0),void console.log("appLaunchOptions",this.appLaunchOptions);i?t.disabledTime&&2==t.disabledTime.length?e>t.disabledTime[0]&&e<t.disabledTime[1]?n(!0):n(!1):n(!0):n(!1)},i.prototype.getShareInfo=function(t){this.request(this.baseUrl+"admin/wx_share/getShare",{appid:l.config.moosnowAppId},"POST",(function(o){console.log("分享数据",o.data),t(o.data),moosnow.platform.initShare(o.data)}))},i}(c),V=function(t){function n(){var o=t.call(this)||this;return o.platformName="qg",o.appSid="",o.bannerWidth=760,o.bannerHeight=96,o.interLoadedShow=!1,o.prevNavigate=Date.now(),o.mIsClickedNative=!1,o._regisiterWXCallback(),o.initAdService(),o}return o(n,t),n.prototype.initAdService=function(){if(window[this.platformName]){var t=this;window[this.platformName].initAdService?window[this.platformName].initAdService({isDebug:!0,appId:this.moosnowConfig.moosnowAppId,success:function(o){console.log("初始化广告"),t.initBanner(),t.initInter(),t._prepareNative()},fail:function(t){console.warn("初始化广告错误 "+t.code+"  "+t.msg)},complete:function(t){console.log("initAdService  complete")}}):(console.log("初始化广告"),t.initBanner(),t.initInter(),t._prepareNative()),moosnow.event.addListener(m.ON_PLATFORM_SHOW,this,this.onAppShow)}},n.prototype.navigate2Mini=function(t,o,n,e){var i=this;if(console.log(b,t),Date.now()-this.prevNavigate<300)console.log(v);else if(this.prevNavigate=Date.now(),window[this.platformName]){var r=t.appid,s=t.path,a=t.extraData,h=t.pkgName;a=a||{},this.supportVersion(1044)?window[this.platformName].navigateToMiniGame({appId:r,path:s,pkgName:h||r,extraData:a,success:function(){window[i.platformName]&&window[i.platformName].aldSendEvent&&window[i.platformName].aldSendEvent("跳转",{position:t.position,appid:r,img:t.atlas||t.img}),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMiniProgram error ",t),n&&n()},complete:function(){e&&e()}}):console.log(k)}else o&&o()},n.prototype.supportVersion=function(t){return this.getSystemInfoSync().platformVersion>=t},n.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode," msg ",t.errMsg),this.banner&&(this.banner.hide(),this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null)},n.prototype._prepareBanner=function(){if(window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.windowWidth;this.isLandscape(t.windowHeight,t.windowWidth)?o<this.bannerWidth&&(this.bannerWidth=o):this.bannerWidth=o,this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide()),this.banner=this._createBannerAd(),this.banner.onResize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)),this.banner.onHide(this._onBannerHide.bind(this))}},n.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.windowWidth,n=t.windowHeight,e=(o-this.bannerWidth)/2;if(!l.isEmpty(this.bannerId)){var i=n-this.bannerHeigth;return window[this.platformName].createBannerAd({adUnitId:this.bannerId,style:{top:i,left:e,width:this.bannerWidth}})}console.warn(w)}},n.prototype._bottomCenterBanner=function(t){var o=this.getSystemInfoSync(),n=o.windowWidth,e=o.windowHeight,i=o.statusBarHeight,r=o.notchHeight||0;this.bannerWidth=t.width,this.bannerHeigth=t.height,this.banner.style.left=(n-t.width)/2;var s=e-this.bannerHeigth;s=this.bannerPosition==p.BOTTOM?e-this.bannerHeigth:this.bannerPosition==p.CENTER?(e-this.bannerHeigth)/2:this.bannerPosition==p.TOP?this.isLandscape(o.windowHeight,o.windowWidth)?0:i+r:this.bannerStyle.top,this.banner.style.top=s,console.log("_bottomCenterBanner  ",this.banner.style)},n.prototype._resetBanenrStyle=function(t){var o=this.getSystemInfoSync(),n=(o.windowWidth,o.windowHeight),e=o.statusBarHeight,i=o.notchHeight||0;isNaN(this.bannerWidth)||(this.banner.style.width=this.bannerWidth),isNaN(this.bannerHeight)||(this.banner.style.height=this.bannerHeight);var r=n-this.bannerHeigth;r=this.bannerPosition==p.BOTTOM?n-this.bannerHeigth:this.bannerPosition==p.CENTER?(n-this.bannerHeigth)/2:this.bannerPosition==p.TOP?this.isLandscape(o.windowHeight,o.windowWidth)?0:e+i:this.bannerStyle.top,this.banner.style.top=r,console.log("_resetBanenrStyle ",this.banner.style,"set styleTop ",r)},n.prototype._onBannerHide=function(){console.log("banner 已隐藏 ")},n.prototype.destroyBanner=function(){this.banner&&(this.banner.hide(),this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null)},n.prototype.showBanner=function(t,o,n){var e=this;void 0===o&&(o=p.BOTTOM),console.log(g),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.banner?(this._resetBanenrStyle({width:this.banner.style.width,height:this.banner.style.height}),this.banner.show(),setTimeout((function(){e._resetBanenrStyle({width:e.banner.style.width,height:e.banner.style.height})}),500)):this.initBanner())},n.prototype.hideBanner=function(){console.log(d),this.isBannerShow&&window[this.platformName]&&(this.bannerShowCount++,this.banner?this.bannerShowCount>=this.bannerShowCountLimit?(console.log("banner destroy"),this.banner.hide(),this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null,console.log("重新创建banner"),this._prepareBanner()):this.banner.hide():this._prepareBanner(),this.isBannerShow=!1)},n.prototype.createRewardAD=function(t){if(!moosnow.platform.videoLoading)if(window[this.platformName]){if(window[this.platformName].createRewardedVideoAd){if(this.video)this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad);else{if(l.isEmpty(this.videoId))return void console.warn(N);this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.videoId})}this.video.onError(this._onVideoError.bind(this)),this.video.onClose(this._onVideoClose.bind(this)),this.video.onLoad(this._onVideoLoad.bind(this)),moosnow.platform.videoLoading=!0,this.video.load()}}else moosnow.platform.videoCb(u.END)},n.prototype._onVideoLoad=function(){console.log(I),moosnow.platform.videoLoading=!1,this.video&&this.video.show()},n.prototype.prepareInter=function(){if(l.isEmpty(this.interId))console.warn(x);else if(window[this.platformName])if(this.supportVersion("1061")){if("function"!=typeof window[this.platformName].createInterstitialAd)return;this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()}else{if("function"!=typeof window[this.platformName].createInsertAd)return;this.inter=window[this.platformName].createInsertAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onShow(this._onInterOnShow.bind(this)),this.inter.load()}},n.prototype.showInter=function(){this.inter?this.inter.show():this.interLoadedShow=!0},n.prototype._onInterLoad=function(){this.interLoadedShow&&(this.inter?this.inter.show():this.interLoadedShow=!1)},n.prototype._onInterOnShow=function(){this.inter&&this.inter.load()},n.prototype.showAutoBanner=function(){console.log(" oppo 不支持自动")},n.prototype.reportMonitor=function(t,o){window[this.platformName]&&window[this.platformName].reportMonitor&&window[this.platformName].reportMonitor("game_scene",0)},n.prototype._prepareNative=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createNativeAd&&(this.native=window[this.platformName].createNativeAd({adUnitId:parseInt(""+this.nativeId[this.nativeIdIndex])}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this)),this.nativeLoading=!0)},n.prototype._onNativeLoad=function(t){this.nativeLoading=!1,console.log(A,t),t&&t.adList&&t.adList.length>0?(this.nativeAdResult=t.adList[0],l.isEmpty(this.nativeAdResult.adId)||(console.log(T),this.native.reportAdShow({adId:this.nativeAdResult.adId})),l.isFunction(this.nativeCb)&&this.nativeCb(l.deepCopy(this.nativeAdResult))):(console.log(L),l.isFunction(this.nativeCb)&&this.nativeCb(null))},n.prototype._onNativeError=function(t){this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log(P,t),this.nativeIdIndex+=1,this._destroyNative(),this._prepareNative()):(console.log(F),this.nativeIdIndex=0,l.isFunction(this.nativeCb)&&this.nativeCb(null)):(console.log(O,t),l.isFunction(this.nativeCb)&&this.nativeCb(null))},n.prototype._destroyNative=function(){this.nativeLoading=!1,this.native.offLoad(),this.native.offError(),this.native.destroy(),console.log(B)},n.prototype.showNativeAd=function(t){this.nativeCb=t,this.native&&this.native.load()},n.prototype.clickNative=function(t){this.nativeAdResult&&!l.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log(F,this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},n.prototype.onAppShow=function(){this.mIsClickedNative&&(this.mIsClickedNative=!1,l.isFunction(this.mClickedNativeCallback)&&this.mClickedNativeCallback())},n}(R),W=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.TOKEN="token",o.COIN="COIN",o.mUserToken="",o.VIBRATE_SWITCH="VIBRATE_SWITCH",o.mCoin=0,o.mCurrentMisTouchCount=0,o.mChannel_id="0",o.mChannel_appid="0",o}return o(n,t),n.prototype.initCoin=function(t){null==moosnow.setting._getValue(this.COIN,null)&&moosnow.setting.setValue(this.COIN,t)},n.prototype.getCoin=function(){return 0==this.mCoin&&(this.mCoin=moosnow.setting.getInt(this.COIN,0)),this.mCoin},n.prototype.subCoin=function(t){this.mCoin-=t,moosnow.event.sendEventImmediately(m.COIN_CHANGED,this.mCoin)},n.prototype.addCoin=function(t){this.mCoin+=t,moosnow.event.sendEventImmediately(m.COIN_CHANGED,this.mCoin)},n.prototype.setCoin=function(t){this.mCoin=t,moosnow.event.sendEventImmediately(m.COIN_CHANGED,this.mCoin)},n.prototype.saveCoin=function(){moosnow.setting.setValue(this.COIN,this.mCoin)},n.prototype.getToken=function(){return l.isEmpty(this.mUserToken)&&(this.mUserToken=moosnow.setting.getString(this.TOKEN,"")),this.mUserToken},n.prototype.setToken=function(t){moosnow.setting.setValue(this.TOKEN,t)},n.prototype.getCurrentMisTouchCount=function(){return this.mCurrentMisTouchCount},n.prototype.setCurrentMisTouchCount=function(t){this.mCurrentMisTouchCount=t},n.prototype.getChannelId=function(){return this.mChannel_id},n.prototype.setChannelId=function(t){this.mChannel_id=t},n.prototype.getChannelAppId=function(){return this.mChannel_appid},n.prototype.setChannelAppId=function(t){this.mChannel_appid=t},n.prototype.getVibrateSetting=function(){return moosnow.setting.getBool(this.VIBRATE_SWITCH,!0)},n.prototype.setVibrateSetting=function(t){moosnow.setting.setBool(this.VIBRATE_SWITCH,t),moosnow.event.sendEventImmediately(m.VIBRATESWITCH_CHANGED,t)},n}(c),j=function(t){function n(){return t.call(this)||this}return o(n,t),n.prototype.onEnable=function(){},n.prototype.getInt=function(t,o){var n=this._getValue(t,o);return parseInt(n)},n.prototype.getFloat=function(t,o){var n=this._getValue(t,o);return parseFloat(n)},n.prototype.getBool=function(t,o){var n;return n=1==o?"true":"false","true"==this.getString(t,n)},n.prototype.getString=function(t,o){return this._getValue(t,o)},n.prototype.getObject=function(t,o){var n=this._getValue(t,o);return n&&""!=n?JSON.parse(n):null},n.prototype.setObject=function(t,o){var n="";o&&(n=JSON.stringify(o)),this.setValue(t,n)},n.prototype.setBool=function(t,o){1==o?this.setValue(t,"true"):this.setValue(t,"false")},n.prototype.setValue=function(t,o){window.localStorage.setItem(t,o)},n.prototype.appendInt=function(t,o){var n=this.getInt(t,0),e=parseInt(o)+n;return this.setValue(t,e),e},n.prototype.appendFloat=function(t,o){var n=this.getFloat(t,0),e=parseFloat(o)+n;this.setValue(t,e)},n.prototype.removeValueOfKey=function(t){window.localStorage.removeItem(t)},n.prototype.removeAll=function(){window.localStorage.clear()},n.prototype._getValue=function(t,o){var n=window.localStorage.getItem(t);return null!=n&&""!=n||(n=o),n},n}(c),z=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.getRemoteAd=function(o){var n=this,e="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/exportConfig/"+moosnow.platform.moosnowConfig.moosnowAppId+".json?t="+Date.now();moosnow.http.request(e,{},"GET",(function(t){o(t),console.log("WXAdModule getRemoteAd",t)}),(function(){t.prototype.getRemoteAd.call(n,o),console.log("getRemoteAd fail")}),(function(){console.log("getRemoteAd complete")}))},n}(M),G=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.getRemoteAd=function(t){var o=this,n="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/exportConfig/"+moosnow.platform.moosnowConfig.moosnowAppId+".json?t="+Date.now();moosnow.http.request(n,{},"GET",(function(o){t(o),console.log("WXAdModule getRemoteAd",o)}),(function(n){o.repairAd(t),console.log("getRemoteAd fail")}),(function(){console.log("getRemoteAd complete")}))},n.prototype.repairAd=function(t){var o=this.baseUrl+"wx_export/getExport",n={appid:moosnow.platform.moosnowConfig.moosnowAppId};moosnow.http.request(o,n,"POST",(function(o){o.data.sort((function(){return Math.random()>.5?1:-1})),t&&t(o.data)}),(function(){t([]),console.log("getRemoteAd fail")}),(function(){console.log("getRemoteAd complete")}))},n}(M),Q={ARTICLE:"article",VIDEO:"video",TOKEN:"token",LINK:""},q=function(){},X=function(t){function e(){var o=t.call(this)||this;return o.platformName="tt",o.recordRes=null,o.recordCb=null,o.recordNumber=0,o.bannerWidth=208,o.moreGameCb=null,o.mBannerLoaded=!1,o._regisiterWXCallback(),o._registerTTCallback(),o.initBanner(),o.initRecord(),o.initInter(),o}return o(e,t),e.prototype._registerTTCallback=function(){var t=this;window[this.platformName]&&(window[this.platformName].onMoreGamesModalClose&&window[this.platformName].onMoreGamesModalClose((function(o){console.log("modal closed",o),t.moreGameCb&&t.moreGameCb(0)})),window[this.platformName].onNavigateToMiniGameBox?window[this.platformName].onNavigateToMiniGameBox((function(t){console.log("onNavigateToMiniGameBox",t)})):window[this.platformName].onNavigateToMiniProgram&&window[this.platformName].onNavigateToMiniProgram((function(t){console.log("onNavigateToMiniProgram",t)})))},e.prototype.prepareInter=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createInterstitialAd&&(l.isEmpty(this.interId)?console.warn(x):(this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()))},e.prototype._bottomCenterBanner=function(t){if(this.bannerWidth!=t.width){var o=this.getSystemInfoSync(),n=o.windowWidth,e=o.windowHeight;this.bannerWidth=t.width,this.bannerHeigth=this.bannerWidth/16*9;var i=e-this.bannerHeigth-30;console.log("bannerWidth ",this.bannerWidth,"bannerHeigth",this.bannerHeigth,"top",i),this.banner&&(this.banner.style.top=i,this.banner.style.left=(n-t.width)/2)}},e.prototype.initRecord=function(){window[this.platformName]&&window[this.platformName].getGameRecorderManager&&(this.record=window[this.platformName].getGameRecorderManager())},e.prototype.clipRecord=function(){this.record&&(this.recordNumber++,console.log("clipRecord",this.recordNumber),this.record.recordClip({timeRange:[2,2],success:function(t){console.log("clipRecord 成功 ",t)}}))},e.prototype.startRecord=function(t,o){var n=this;if(void 0===t&&(t=300),void 0===o&&(o=null),console.log("record startRecord"),this.record){this.recordNumber=0,this.recordCb=null,this.recordRes=null,this.record.onStart((function(t){console.log("record onStart"),o&&o(t)}));this.recordRes;this.record.onStop((function(t){console.log("on stop ",t),n.recordNumber>=4?n.record.clipVideo({path:t.videoPath,success:function(t){console.log("record clip succes:",t),n.recordRes=t,console.log("record clip recordRes :",n.recordRes),n.recordCb&&n.recordCb(t)},fail:function(){console.log("record clip fail:",t),n.recordRes=t,n.recordCb&&n.recordCb(t)}}):(n.recordRes=t,n.recordCb&&n.recordCb(t))})),this.record.start({duration:t})}else o&&o(!1)},e.prototype.stopRecord=function(t){void 0===t&&(t=null),console.log(" stop Record  callback  ",!!t),this.record?(console.log("record stop recordRes ",this.recordRes),this.recordRes?l.isFunction(t)&&t(this.recordRes):(this.recordCb=t,this.record.stop(),console.log("record stop  ",this.recordRes))):t&&t(!1)},e.prototype.pauseRecord=function(){this.record&&this.record.pause()},e.prototype.resumeRecord=function(){this.record&&this.record.resume()},e.prototype.share=function(t,o){void 0===t&&(t={}),this.currentShareCallback=o;var n=this._buildShareInfo(t);console.log("shareInfo:",n),window[this.platformName]&&window[this.platformName].shareAppMessage?window[this.platformName].shareAppMessage(n):this.currentShareCallback(!0)},e.prototype._buildShareInfo=function(t){var o=this,n="",e="";if(this.shareInfoArr.length>0){var r=this.shareInfoArr[i.randomNumBoth(0,this.shareInfoArr.length-1)];n=r.title,e=r.img}var s=Q.LINK;t&&-1!=[Q.LINK,Q.ARTICLE,Q.TOKEN,Q.VIDEO].indexOf(t.channel)&&(s=t.channel);var a=this.recordRes&&this.recordRes.videoPath?this.recordRes.videoPath:"";return console.log("video path ",a),{channel:s,title:n,imageUrl:e,query:moosnow.http._object2Query(t),extra:{videoPath:a,videoTopics:[n]},success:function(){console.log("share video success "),o.currentShareCallback&&o.currentShareCallback(!0)},fail:function(t){console.log("share video success ",t),o.currentShareCallback&&o.currentShareCallback(!1)}}},e.prototype._onBannerLoad=function(){this.bannerShowCount=0,this.mBannerLoaded=!0,this.isBannerShow&&this.showBanner()},e.prototype._prepareBanner=function(){this.mBannerLoaded=!1,t.prototype._prepareBanner.call(this)},e.prototype._resetBanenrStyle=function(t){if(l.isEmpty(t))console.log("设置的banner尺寸为空,不做调整");else{var o=this.getSystemInfoSync(),n=(o.windowWidth,o.windowHeight),e=0;this.bannerPosition==p.BOTTOM?e=n-this.bannerHeigth-30:this.bannerPosition==p.CENTER?e=(n-this.bannerHeigth)/2:this.bannerPosition==p.TOP&&(e=0),this.bannerStyle?this.banner.style=this.bannerStyle:(this.banner.style.top=e,console.log(y,this.banner.style,"set top ",e))}},e.prototype.showBanner=function(t,o,n){var e=this;void 0===o&&(o=p.BOTTOM),console.log(g),this.bannerCb=t,this.isBannerShow=!0,this.mBannerLoaded&&window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=n,this.banner&&(console.log("show banner style ",this.banner.style),this.banner.hide(),this._resetBanenrStyle({width:this.banner.style.width,height:this.banner.style.realHeight}),this.banner.show().then((function(){e._resetBanenrStyle({width:e.banner.style.width,height:e.banner.style.realHeight})}))))},e.prototype.showAppBox=function(t,o){var n=this;void 0===o&&(o=!0),this.moreGameCb=t,window[this.platformName]&&window[this.platformName].showMoreGamesModal&&moosnow.http.getAllConfig((function(t){o?t&&1==t.showAppBox&&n._showMoreGamesModal():n._showMoreGamesModal()}))},e.prototype._getAppLaunchOptions=function(t){var o=[];moosnow.ad.getAd((function(n){0!=n.indexLeft.length&&(n.indexLeft.forEach((function(t){var n=new q;n.appId=t.appid,n.query=t.path||"1=1",n.extraData=t.extraData||{},o.push(n)})),console.log("appLaunchOptions",o),t(o))}))},e.prototype._showMoreGamesModal=function(){var t=this;"ios"!=this.getSystemInfoSync().platform&&this._getAppLaunchOptions((function(o){console.log("_showMoreGamesModal appLaunchOption",o);window[t.platformName].showMoreGamesModal({appLaunchOptions:o,success:function(t){console.log("show app box success",t)},fail:function(t){console.log("show app box fail",t)}})}))},e.prototype.showMoreGameBanner=function(){if(window[this.platformName]&&window[this.platformName].createMoreGamesBanner){var t=this.getSystemInfoSync();if("ios"!=t.platform&&"ios"!==t.platform){var o=[];moosnow.ad.getAd((function(t){0!=t.indexLeft.length&&t.indexLeft.forEach((function(t){var n=new q;n.appId=t.appid,n.query=t.path||"1=1",n.extraData=t.extraData||{},o.push(n)}))}));var n=window[this.platformName].createMoreGamesBanner({style:{left:20,top:0,width:150,height:40},appLaunchOptions:o,success:function(t){console.log("show app box success",t.errMsg)},fail:function(t){console.log("show app box fail",t.errMsg)}});n.show(),n.onTap((function(){console.log("点击跳转游戏盒子")}))}}},e.prototype.showMoreGameButton=function(t,o,e){var i=this;if(void 0===e&&(e=null),window[this.platformName]&&window[this.platformName].createMoreGamesButton){var r={left:this.getSystemInfoSync().windowWidth-80-30,top:40,width:80,height:80,lineHeight:80,backgroundColor:"#ff0000",textColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:0,borderWidth:1,borderColor:"#ff0000"},s=n(n({},r),e);this._moreGameBotton?this._moreGameBotton.show():this._getAppLaunchOptions((function(t){cc.loader.loadRes("texture/game/more.png",cc.Texture2D,(function(n,e){n||(i._moreGameBotton=window[i.platformName].createMoreGamesButton({type:"image",image:e.url,actionType:"box",style:s,appLaunchOptions:t,onNavigateToMiniGame:function(t){console.log("跳转其他小游戏",t),o&&o(1,t)}}),i._moreGameBotton.show(),i._moreGameBotton.onTap((function(){console.log("点击更多游戏"),o&&o(2,null)})))}))}))}},e.prototype.hideMoreGameButton=function(){this._moreGameBotton&&this._moreGameBotton.hide()},e.prototype.isIphone=function(){return!!window[this.platformName]&&"ios"==this.getSystemInfoSync().platform},e.prototype.navigate2Mini=function(t,o,n,e){console.log("tt navigate2Mini "),this.showAppBox((function(){console.log("tt showAppBox close ")}),!1)},e}(R),K=function(t){function n(){var o=t.call(this)||this;return o.platformName="qq",o._regisiterWXCallback(),o.initBanner(),o}return o(n,t),n.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.bannerHeigth=Math.round(this.bannerWidth/300*72.8071),o=this.getSystemInfoSync(),n=o.screenWidth,e=o.screenHeight,i=(n-this.bannerWidth)/2,r=e-t/2;if(!l.isEmpty(this.bannerId)){console.log("create banner by banner id ",this.bannerId);var s={top:r,left:i,width:this.bannerWidth,height:t};return console.log("create banner style ",s),window[this.platformName].createBannerAd({adUnitId:this.bannerId,style:s})}console.warn(w)}},n.prototype.showBanner=function(t,o,n){var e=this;if(void 0===o&&(o=p.BOTTOM),console.log(g),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=n,this._resetBanenrStyle({}),this.banner)){var i=this.banner.show();i&&i.then((function(){e._resetBanenrStyle({})}))}},n.prototype._bottomCenterBanner=function(t){console.log("Resize后正式宽高:",t.width,t.height)},n.prototype._resetBanenrStyle=function(t){var o=this.getSystemInfoSync(),n=(o.windowWidth,o.windowHeight),e=0;e=this.bannerPosition==p.BOTTOM?n-this.bannerHeigth:this.bannerPosition==p.CENTER?(n-this.bannerHeigth)/2:this.bannerPosition==p.TOP?0:this.bannerStyle.top,this.banner&&this.banner.style&&(this.banner.style.top=e)},n.prototype.showAppBox=function(t,o){var n=this;void 0===o&&(o=!0),window[this.platformName]&&window[this.platformName].createAppBox&&(this.mOnBoxCallback=t,console.log("showAppBox"),moosnow.http.getAllConfig((function(t){o?t&&1==t.showAppBox?(n.box||(n.box=window[n.platformName].createAppBox({adUnitId:n.moosnowConfig.boxId}),n.box.onClose(n.onBoxClose.bind(n))),n.box.load().then((function(){n.box.show()}))):(l.isFunction(n.mOnBoxCallback)&&n.mOnBoxCallback(-1),console.log("后台不允许显示Box，如有需要请联系运营")):(n.box||(n.box=window[n.platformName].createAppBox({adUnitId:n.moosnowConfig.boxId}),n.box.onClose(n.onBoxClose.bind(n))),n.box.load().then((function(){n.box.show()})))})))},n.prototype.hideAppBox=function(t){var o=this;if(this.box){this.box.offClose(this.onBoxClose);var n=this.box.destroy();console.log("box destroy ",n),n&&n.then((function(){console.log("destroy successfully ",n),o.box=null,l.isFunction(t)&&t(!0)})).catch((function(){console.log("destroy fail ",n),o.box=null,l.isFunction(t)&&t(!1)}))}},n.prototype.onBoxClose=function(){l.isFunction(this.mOnBoxCallback)&&this.mOnBoxCallback(0)},n}(R),Y=function(){this.appid="",this.boxAppid="",this.desc="",this.img="",this.path="",this.title="",this.atlas="",this.pkgName="",this.extraData="",this.position="",this.onCancel=null,this.index=0,this.refresh=!1},Z=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.getRemoteAd=function(t){var o={apk_id:moosnow.platform.moosnowConfig.moosnowAppId};moosnow.http.request("https://platform.qwpo2018.com/api/apk_ad/index",o,"POST",(function(o){var n=o.data;if(n.sort((function(){return Math.random()>.5?1:-1})),console.log("接口数据",o.data),t){for(var e=[],i=0;i<n.length;i++){var r=n[i],s=new Y;s.appid=r.link_appid,s.img=r.link_img,s.path=r.link_path,s.title=r.link_name,s.pkgName=r.link_page,s.desc=r.link_des,e.push(s)}t(e)}}),(function(){t([]),console.log("getRemoteAd fail")}),(function(){console.log("getRemoteAd complete")}))},n}(M),J=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.checkVersion=function(o,n){var e=this;moosnow.http.loadCfg((function(o){var i=t.prototype.checkLog.call(e,o.zs_version);n(i)}))},n.prototype.login=function(t,o){window[this.platformName]?window[this.platformName].login({success:function(o){moosnow.http.request("https://platform.qwpo2018.com/api/oppo_login/index",{apk_id:moosnow.platform.moosnowConfig.moosnowAppId,code:o.data.token},"POST",(function(o){moosnow.data.setToken(o.data.user_id),t&&t(o.data),console.log("platformLogin success ",o)}),(function(o){t&&t(null),console.log("platformLogin fail ",o)}))},fail:function(t){o&&o(t)}}):t&&t()},n.prototype.navigate2Mini=function(o,n,e,i){var r=this;t.prototype.navigate2Mini.call(this,o,(function(){r.navigateCallback(o.appid),l.isFunction(n)&&n()}),e,i)},n.prototype.navigateCallback=function(t){var o={user_id:moosnow.data.getToken(),apk_id:moosnow.platform.moosnowConfig.moosnowAppId,appid:t,link_id:t};console.log("跳转数据上报",o),moosnow.http.request("https://platform.qwpo2018.com/api/apk_ad/click_log",o,"POST",(function(t){console.log("跳转数据上报成功",t)}),(function(t){console.log("跳转数据上报失败",t)}),(function(){console.log("upload navigate complete")}))},n}(V),$=function(t){function n(){var o=t.call(this)||this;return o.platformName="swan",o.bannerId="",o.videoId="",o.appSid="",o.recordRes=null,o.recordCb=null,o}return o(n,t),n.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.screenWidth,n=t.screenHeight;if(!l.isEmpty(this.bannerId))return window[this.platformName].createBannerAd({adUnitId:this.bannerId,appSid:this.appSid,style:{top:n,width:o}});console.warn(w)}},n.prototype.createRewardAD=function(t){var o=this;this.videoLoading||window[this.platformName].createRewardedVideoAd&&(this.video?(this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad)):this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.videoId,appSid:this.appSid}),this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad),this.videoLoading=!0,this.video.load().then((function(){t&&o.video.show().then((function(){})).catch((function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))})).catch((function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})))},n.prototype.initRecord=function(){if(window[this.platformName]){var t=this.getSystemInfoSync().brand.toLowerCase();/huawei/.test(t)||/honor/.test(t)||(this.record=window[this.platformName].getVideoRecorderManager())}},n.prototype.startRecord=function(t,o){var n=this;void 0===t&&(t=120),void 0===o&&(o=null),console.log("record startRecord"),this.recordRes=null,this.recordCb=null,this.record?(this.record.onStart((function(t){console.log("record onStart"),o&&o(t)})),this.record.onStop((function(t){n.recordRes=t,n.recordCb&&(console.log("stop 2"),n.recordCb(t))})),this.record.start({duration:t})):o&&o(!1)},n.prototype.stopRecord=function(t){void 0===t&&(t=null),console.log("record stopRecord"),this.record?this.recordRes?(console.log("stop 1"),t(this.recordRes)):(this.recordCb=t,this.record.stop()):t&&t(!1)},n}(R),tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getMisTouchNum=function(t){this.loadCfg((function(o){t(parseInt(o.mistouchNum))}))},e.prototype.getMistouchPosNum=function(t){this.loadCfg((function(o){t(parseInt(o.mistouchPosNum))}))},e.prototype.getBannerShowCountLimit=function(t){this.loadCfg((function(o){isNaN(o.bannerShowCountLimit)?t(5):t(parseInt(o.bannerShowCountLimit))}))},e.prototype.getAllConfig=function(t){this.loadCfg((function(o){t(o)}))},e.prototype.loadCfg=function(t){var o=this;if(this.cfgData)t(this.cfgData);else{var e=moosnow.platform.moosnowConfig.url+"?t="+Date.now();console.log("appid ",moosnow.platform.moosnowConfig.moosnowAppId),this.request(e,{apk_id:moosnow.platform.moosnowConfig.moosnowAppId},"POST",(function(e){var i=e.data.zs_version==moosnow.platform.moosnowConfig.version;o.cfgData=n(n({},l.deepCopy(e.data)),{mistouchNum:e.data.zs_switch,mistouchPosNum:e.data.zs_switch,showNative:i,showInter:i,showExportAd:i,mx_native_click_switch:1==e.zs_native_click_switch,mx_jump_switch:1==e.zs_jump_switch,bannerShowCountLimit:isNaN(e.data.bannerShowCountLimit)?1:e.data.bannerShowCountLimit}),moosnow.platform&&(moosnow.platform.bannerShowCountLimit=parseInt(e.data.bannerShowCountLimit)),t(o.cfgData)}),(function(){t({}),console.log("load config json fail")}))}},e}(H),ot={FAIL:"请分享到群！"},nt={ERR:"视频正在加载中,请稍后",NOTEND:"请完整观看完视频！"},et=function(){function t(){}return t.prototype.shuffle=function(t){for(var o,n,e=t.length,i=e;i--;)i!==(n=Math.floor(Math.random()*e))&&(o=t[i],t[i]=t[n],t[n]=o);return t},t.prototype.indexOf=function(t,o){for(var n=-1,e=0,i=t.length;e<i;e++)if(t[e]==o){n=e;break}return n},t.prototype.replace=function(t,o,n){var e=t[o],i=t[n];t[n]=e,t[o]=i},t.prototype.merge=function(t,o){for(var n=0,e=t.length;n<e;n++)o.push(t[n]);return o},t.clone=function(t){new Array;return t.slice(0)},t.remove=function(t,o){for(var n=0;n<t.length;n++)if(t[n]==o)return t.splice(n,1),void n--},t}(),it=function(t){function n(){var o=t.call(this)||this;return o._eventList=[],o._waitingForSendList=[],o._eventList=[],o._waitingForSendList=[],o}return o(n,t),n.prototype.addListener=function(t,o,n){this._addListener(t,o,!1,n)},n.prototype.addToSendQueue=function(t,o){this._addToSendList(t,o)},n.prototype.sendEventImmediately=function(t,o){this._sendEvent(t,o),this.onUpdate()},n.prototype.removeListener=function(t,o){if(null!=t&&""!=t)for(var n=0;n<this._eventList.length;n++){var e=this._eventList[n];if(e.eventName===t){for(var i=0;i<e.listeners.length;i++){var r=e.listeners[i];if(r.target===o){et.remove(e.listeners,r);break}}0==e.listeners.length&&et.remove(this._eventList,e);break}}else console.error("eventName:"+t+"不合法！")},n.prototype.removeAllListener=function(){this._eventList.length=0,this._eventList=[],this._waitingForSendList.length=0,this._waitingForSendList=[]},n.prototype._addListener=function(t,o,n,e){if(null!=t&&""!=t){var i=new rt;e instanceof Function?i.callback=e:console.error("callback不是一个方法"),o?i.target=o:console.error("target为空"),i.once=n;var r=!1;if(this._eventList.length>0){for(var s=0;s<this._eventList.length;s++){var a=this._eventList[s];if(t===a.eventName)return a.listeners.push(i),void(r=!0)}if(!r){var h=new st;h.eventName=t,h.listeners.push(i),this._eventList.push(h)}}else{var l=new st;l.eventName=t,l.listeners.push(i),this._eventList.push(l)}}else console.error("eventName:"+t+"不合法！")},n.prototype._addToSendList=function(t,o){if(null!=t&&""!=t){var n={eventName:t,data:o};this._waitingForSendList.push(n)}else console.error("eventName:"+t+"不合法！")},n.prototype._sendEvent=function(t,o){for(var n=this._eventList,e=0;e<n.length;e++){var i=n[e];if(i.eventName===t)for(var r=i.listeners,s=r.length-1;s>=0;s--){var a=r[s],h=a.callback,l=a.target;l?(h.call(l,o),a.once&&this._eventList[e].listeners[s]&&(et.remove(this._eventList[e].listeners,a),e--)):(et.remove(this._eventList[e].listeners,a),s--)}}},n.prototype.onUpdate=function(){if(0!=this._waitingForSendList.length)for(var t=0;t<this._waitingForSendList.length;t++){var o=this._waitingForSendList[t];this._sendEvent(o.eventName,o.data),et.remove(this._waitingForSendList,o),t--}},n.prototype.onDisable=function(){},n}(c),rt=function(){this.callback=null,this.target=[],this.once=!1,this.callback=null,this.target=null,this.once=!1},st=function(){this.eventName="",this.listeners=[],this.eventName="",this.listeners=[]},at=function(t){function n(){var o=t.call(this)||this;return o.platformName="qg",o.appSid="",o.bannerWidth=720,o.bannerHeight=113,o.interLoadedShow=!1,o.prevNavigate=Date.now(),o.mMinInterval=10,o.mIsClickedNative=!1,o._regisiterWXCallback(),o.initAdService(),o}return o(n,t),n.prototype.initAdService=function(){moosnow.event.addListener(m.ON_PLATFORM_SHOW,this,this.onAppShow)},n.prototype.navigate2Mini=function(t,o,n,e){var i=this;if(console.log(b,t),Date.now()-this.prevNavigate<300)console.log(v);else if(this.prevNavigate=Date.now(),window[this.platformName]){var r=t.appid,s=t.path,a=t.extraData,h=t.pkgName;a=a||{},this.supportVersion(1044)?window[this.platformName].navigateToMiniGame({appId:r,path:s,pkgName:h||r,extraData:a,success:function(){window[i.platformName]&&window[i.platformName].aldSendEvent&&window[i.platformName].aldSendEvent("跳转",{position:t.position,appid:r,img:t.atlas||t.img}),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMiniProgram error ",t),n&&n()},complete:function(){e&&e()}}):console.log(k)}else o&&o()},n.prototype.supportVersion=function(t){return this.getSystemInfoSync().platformVersion>=t},n.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode," msg ",t.errMsg),this.destroyBanner()},n.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log(C,this.systemInfo)),this.systemInfo},n.prototype._prepareBanner=function(){window[this.platformName].createBannerAd&&(this.banner&&(this.banner.offSize(),this.banner.offError(),this.banner.offLoad(),this.banner.offClose(),this.banner.destroy(),this.banner=null),this.banner=this._createBannerAd(),this.banner&&(this.banner.onSize(this._bottomCenterBanner.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)),this.banner.onClose(this._onBannerClose.bind(this))))},n.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=Date.now();if(this.mShowTime||(this.mShowTime=t),!this.mShowTime||this.mShowTime&&t-this.mShowTime<=1e3*this.mMinInterval)console.log("banner创建太频繁了 "+this.mMinInterval+"秒内只能显示一次");else{this.mShowTime=Date.now();var o=this.getSystemInfoSync(),n=o.screenWidth,e=o.screenHeight,i=o.statusBarHeight,r=o.pixelRatio,s=this.getNotchHeight(),a=(n-this.bannerWidth)/r/2;if(!l.isEmpty(this.bannerId)){var h={top:this.bannerPosition==p.BOTTOM?(e-this.bannerHeight)/r:this.bannerPosition==p.CENTER?(e-this.bannerHeight)/r/2:this.bannerPosition==p.TOP?this.isLandscape(o.screenHeight,o.screenWidth)?0:i+s:this.bannerStyle.top,left:a,width:this.bannerWidth,height:this.bannerHeight};return console.log("_createBannerAd style",h,"screenHeight",e,"bannerHeigth",this.bannerHeigth),window[this.platformName].createBannerAd({posId:this.bannerId,style:h})}console.warn(w)}}},n.prototype.getNotchHeight=function(){var t=0;return window[this.platformName].getNotchHeightSync&&(t=window[this.platformName].getNotchHeightSync().height),t},n.prototype._bottomCenterBanner=function(t){console.log("onSize callback  ",t)},n.prototype._onBannerClose=function(){console.log("banner 已关闭 ")},n.prototype._onBannerHide=function(){console.log("banner 已隐藏 ")},n.prototype.destroyBanner=function(){this.banner&&(this.banner.offResize(this._bottomCenterBanner),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offClose(this._onBannerClose),this.banner.destroy(),this.banner=null)},n.prototype.showBanner=function(t,o,n){if(void 0===o&&(o=p.BOTTOM),this.bannerCb=t,this.isBannerShow=!0,window[this.platformName]&&(this.bannerPosition=o,this.bannerStyle=n,this.banner||this.initBanner(),this.banner)){var e=this.banner.show();console.log("显示banner style ",this.banner),e&&e.then((function(){console.log("banner广告展示成功")})).catch((function(t){switch(t.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log("加载广告失败，重新加载广告");break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(t))}}))}},n.prototype.hideBanner=function(){console.log(d),this.isBannerShow&&window[this.platformName]&&(this.bannerShowCount++,this.banner&&(this.banner.hide(),this.destroyBanner()),this.isBannerShow=!1)},n.prototype.createRewardAD=function(t){moosnow.platform.videoLoading||(window[this.platformName]?window[this.platformName].createRewardedVideoAd&&(l.isEmpty(this.videoId)?console.warn(N):this.video?this.video.load():(moosnow.platform.videoLoading=!0,this.video=window[this.platformName].createRewardedVideoAd({posId:this.videoId}),this.video.onError(this._onVideoError.bind(this)),this.video.onClose(this._onVideoClose.bind(this)),this.video.onLoad(this._onVideoLoad.bind(this)))):moosnow.platform.videoCb(u.END))},n.prototype._onVideoLoad=function(){var t=this;console.log(I),moosnow.platform.videoLoading=!1,this.video&&this.video.show().then((function(){t.videoPlaying=!0,moosnow.event.sendEventImmediately(m.ON_PLATFORM_HIDE,{}),console.log("激励视频广告展示完成")})).catch((function(t){console.log("激励视频广告展示失败",JSON.stringify(t))}))},n.prototype._onVideoClose=function(t){if(console.log(_,t.isEnded),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,t.isEnded&&moosnow.http.clickVideo(),moosnow.event.sendEventImmediately(m.ON_PLATFORM_SHOW,{}),moosnow.platform.videoCb){var o=t.isEnded?u.END:u.NOTEND;setTimeout((function(){moosnow.platform.videoCb(o)}),50)}},n.prototype.prepareInter=function(){if(l.isEmpty(this.interId))console.warn(x);else if(window[this.platformName])if(this.supportVersion("1061")){if("function"!=typeof window[this.platformName].createInterstitialAd)return;this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()}else{if("function"!=typeof window[this.platformName].createInsertAd)return;this.inter=window[this.platformName].createInsertAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onShow(this._onInterOnShow.bind(this)),this.inter.load()}},n.prototype.showInter=function(){this.inter?this.inter.show():this.interLoadedShow=!0},n.prototype._onInterLoad=function(){this.interLoadedShow&&(this.inter?this.inter.show():this.interLoadedShow=!1)},n.prototype._onInterOnShow=function(){this.inter&&this.inter.load()},n.prototype.showAutoBanner=function(){console.log(" vivo 不支持自动")},n.prototype.reportMonitor=function(t,o){window[this.platformName]&&window[this.platformName].reportMonitor&&window[this.platformName].reportMonitor("game_scene",0)},n.prototype._prepareNative=function(t){void 0===t&&(t=!1),window[this.platformName]&&"function"==typeof window[this.platformName].createNativeAd&&(this.native=window[this.platformName].createNativeAd({posId:this.nativeId[this.nativeIdIndex]}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this)),this.nativeLoading=!0,t&&this.native.load())},n.prototype._onNativeLoad=function(t){this.nativeLoading=!1,console.log(A,t),t&&t.adList&&t.adList.length>0?(this.nativeAdResult=t.adList[0],l.isEmpty(this.nativeAdResult.adId)||(console.log(T),this.native.reportAdShow({adId:this.nativeAdResult.adId})),l.isFunction(this.nativeCb)&&this.nativeCb(l.deepCopy(this.nativeAdResult))):(console.log(L),l.isFunction(this.nativeCb)&&this.nativeCb(null))},n.prototype._onNativeError=function(t){this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log(P,t),this.nativeIdIndex+=1,this._destroyNative(),this._prepareNative()):(console.log(F),this.nativeIdIndex=0,l.isFunction(this.nativeCb)&&this.nativeCb(null)):(console.log(O,t),l.isFunction(this.nativeCb)&&this.nativeCb(null))},n.prototype._destroyNative=function(){this.nativeLoading=!1,this.native.offLoad(),this.native.offError(),this.native.destroy(),console.log(B)},n.prototype.showNativeAd=function(t){this.nativeCb=t,this.native?this.native.load():this._prepareNative(!0)},n.prototype.clickNative=function(t){this.nativeAdResult&&!l.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log(E,this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},n.prototype.onAppShow=function(){this.mIsClickedNative&&(this.mIsClickedNative=!1,l.isFunction(this.mClickedNativeCallback)&&this.mClickedNativeCallback())},n}(R),ht={NONE:0,BANNER:1,FLOAT:2,SIDE:4,CENTER:8,EXPORT:16,BACK:32,MASK:64,WAIT:128,LEFTRIGHT:256,EXPORT_FIXED:512,EXTEND1:1024,EXTEND2:2048,EXTEND3:4096,EXTEND4:8192,TOP:32768,RECOVER:16384},lt=function(t){function n(){var o=t.call(this)||this;return o.entityLogics=[],o._serializeId=0,o.paused=!0,o.prefabPath="prefab/entity/",o.mEntity3DPools=[],o.mEntity3DLogics=[],o.entityPools=[],o.mIsSlow=!0,o.entityLogics=[],o.mEntity3DPools=[],o.mEntity3DLogics=[],o._serializeId=0,o}return o(n,t),n.prototype.update=function(t){if(!this.paused)for(var o=0;o<this.entityLogics.length;o++){this.entityLogics[o].onFwUpdate(t)}},n.prototype.pause=function(){this.paused=!0},n.prototype.resume=function(){this.paused=!1},n.prototype.getAllEntity=function(t){return this.entityLogics.filter((function(o){return o.poolName==t}))},n.prototype.showEntity=function(t,o,n){},n.prototype.hideEntity=function(t,o,n){void 0===n&&(n=!1)},n.prototype.hideAllEntity=function(t,o){void 0===o&&(o=!1)},n}(c),ct=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.prefabPath="moosnow/prefab/entity/",o}return o(n,t),n.prototype.preload=function(t,o){cc.loader.loadRes(this.prefabPath+""+t,cc.Prefab,(function(t,n){o&&o(t,n)}))},n.prototype.showEntity=function(t,o,n){var e=this._showEntity(t);return e.id=this._serializeId--,e.node.parent=o,e.willShow(n),e.node.active=!0,e.node.zIndex=e.id,e.onShow(n),this.entityLogics.push(e),e},n.prototype._createEntity=function(t){var o;return o=l.isString(t)?this._getPrefabByName(t):t,cc.instantiate(o)},n.prototype._showEntity=function(t){var o=this._getOrNewEntityPool(t),n=o.get();null==n&&(n=this._createEntity(t));var e=this._findComponent(n,"EntityLogic");return e.poolName=o.name,e},n.prototype._getPrefabByName=function(t){return cc.loader.getRes(this.prefabPath+""+t,cc.Prefab)},n.prototype._getOrNewEntityPool=function(t){var o=this._getPoolName(t),n=this._getEntityPool(o);return null==n&&(n=this._newEntityPool(o)),n},n.prototype._getPoolName=function(t){var o=l.getEngine();return o==s&&l.isObject(t)?t.name:o==a&&l.isObject(t)?t.json.name:""+t},n.prototype._getEntityPool=function(t){for(var o=0;o<this.entityPools.length;o++){var n=this.entityPools[o];if(n.name===t)return n}return null},n.prototype._newEntityPool=function(t){var o=new cc.NodePool(t);return o.name=t,this.entityPools.push(o),o},n.prototype.hideEntity=function(t,o,n){void 0===n&&(n=!1),this._hideEntity(t,o,n)},n.prototype.hideAllEntity=function(t,o){void 0===o&&(o=!1);for(var n=0;n<this.entityLogics.length;n++){var e=this.entityLogics[n];e.poolName==t&&(this.hideEntity(e,null,o),n--)}},n.prototype._hideEntity=function(t,o,n){if(void 0===n&&(n=!1),n)t.willHide(o),t.node.active=!1,t.onHide(o),t.destroy();else{var e=this._getOrNewEntityPool(t.poolName);t.willHide(o),e.put(t.node),t.node.active=!1,t.onHide(o)}cc.js.array.remove(this.entityLogics,t)},n}(lt),pt=function(){this.name="",this.node=null,this.UIForm=null,this.zIndex=0,this.name="",this.node=null,this.UIForm=null,this.zIndex=0},ut=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n}(function(t){function n(){var o=t.call(this)||this;return o.rootCanvas=null,o.layerIndex=0,o.UIRoot="",o.UIFormStack=[],o.cachedUIForms=[],o.toastForm=null,o.layerIndex=0,o.UIRoot="moosnow/prefab/ui/",o.UIFormStack=[],o.cachedUIForms=[],o.toastForm=null,o}return o(n,t),n.prototype.showToast=function(t){var o=this,n=this;null==n.toastForm?this._createUINode("toastForm",1e3,(function(e,i){cc.Canvas.instance.node.addChild(e),n.toastForm=o._findComponent(e,"toastForm"),e.zIndex=i,n.toastForm.show(t)})):n.toastForm.show(t)},n.prototype.pushUIForm=function(t,o,n){var e=this,i=this._getUINodeFromCacheByName(t);null==i?this._createUIFormModel(t,(function(t){e._showUIForm(t,o),n&&n(t,o)})):(i.zIndex=this.layerIndex++,this.UIFormStack.push(i),this._showUIForm(i,o),n&&n(i,o))},n.prototype.pop=function(t,o){if(void 0===t&&(t=!1),0!=this.UIFormStack.length){var n=this.UIFormStack.pop();t?this._destroyUIForm(n,null):this._hideUIForm(n,null,o)}},n.prototype.getUIFrom=function(t){for(var o=0;o<this.UIFormStack.length;o++){var n=this.UIFormStack[o];if(n.name==t)return n.UIForm}},n.prototype.hideUIForm=function(t,o,n){if("string"==typeof t)for(var e=0;e<this.UIFormStack.length;e++){(i=this.UIFormStack[e]).name==t&&this._hideUIForm(i,o,n)}else for(e=0;e<this.UIFormStack.length;e++){var i;(i=this.UIFormStack[e])==t&&this._hideUIForm(i,o,n)}},n.prototype.hideAllUIForm=function(){for(var t=this.UIFormStack.length-1;t>=0;t--){var o=this.UIFormStack[t];this._hideUIForm(o,null)}},n.prototype.destroyUIForm=function(t,o){for(var n=0;n<this.UIFormStack.length;n++){var e=this.UIFormStack[n];e.name==t&&this._destroyUIForm(e,o)}},n.prototype._formatUIFormName=function(t){return t.replace(/\//g,"_")},n.prototype._createUINode=function(t,o,n){var e=this.UIRoot+t;cc.loader.loadRes(e,cc.Prefab,(function(t,e){var i=cc.instantiate(e);n&&n(i,o)}))},n.prototype._createUIFormModel=function(t,o){var n=this,e=this,i=new pt;i.name=t;var r=this.layerIndex++;i.zIndex=r,this.UIFormStack.push(i),this._createUINode(t,r,(function(r,s){for(var a=0;a<e.UIFormStack.length;a++){var h=e.UIFormStack[a];if(h.zIndex==s&&h.name==r.name){if(null==r)return void n._removeStack(a);var l=n._findComponent(r,"UIForm");return l.formName=t,h.UIForm=l,h.node=r,void(o&&o(i))}}}))},n.prototype._getUINodeFromCacheByName=function(t){for(var o=0;o<this.cachedUIForms.length;o++){var n=this.cachedUIForms[o];if(null!=n.node&&n.name==t)return this.cachedUIForms.splice(o,1),n}return null},n.prototype._showUIForm=function(t,o){if(cc.Canvas.instance.node.addChild(t.node),t.UIForm.willShow(o),t.node.active=!0,o&&!isNaN(o.zIndex)?t.node.zIndex=o.zIndex:t.node.zIndex=t.zIndex,t.UIForm.onShow(o),t.UIForm.isPopEffect){var n=t.node;l.popOpenAnim(n)}},n.prototype._hideUIForm=function(t,o,n){if(t.UIForm.willHide(o),t.UIForm.onHide(o),this._removeStack(t),this.cachedUIForms.push(t),t.UIForm.isPopEffect){var e=t.node;l.popCloseAnim(e,(function(){t.node.active=!1,t.node.removeFromParent(!1),n&&n()}))}else t.UIForm.hideAnim((function(){t.node.active=!1,t.node.removeFromParent(!1),n&&n()}))},n.prototype._destroyUIForm=function(t,o){t.UIForm.willHide(o),t.node.removeFromParent(),t.UIForm.onHide(o),t.node.active=!1,this._removeStack(t),t.node.destroy()},n.prototype._removeStack=function(t){var o=this;isNaN(t)?this.UIFormStack.forEach((function(n,e){n==t&&o.UIFormStack.splice(e,1)})):this.UIFormStack.splice(t,1)},n}(c)),mt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),n.prototype.initForm=function(t){this.initProperty(t)},n.prototype.willShow=function(t){this.mFormData=t},n.prototype.onShow=function(t){},n.prototype.willHide=function(t){},n.prototype.onHide=function(t){},n}(c),dt=function(t){function e(){var o=null!==t&&t.apply(this,arguments)||this;return o.pauseContainer=null,o.pauseView=null,o.pauseLayout=null,o.centerContainer=null,o.centerView=null,o.centerLayout=null,o.exportContainer=null,o.exportView=null,o.exportLayout=null,o.exportClose=null,o.exportMask=null,o.exportCloseTxt=null,o.floatContainer=null,o.floatFull=null,o.bannerContainer=null,o.bannerView=null,o.bannerLayout=null,o.endContainer=null,o.endView=null,o.endLayout=null,o.failContainer=null,o.failView=null,o.failLayout=null,o.gameOverContainer=null,o.gameOverView=null,o.gameOverLayout=null,o.respawnContainer=null,o.respawnScrollView=null,o.respawnLayout=null,o.playerDiedContainer=null,o.playerDiedScrollView=null,o.playerDiedLayout=null,o.leftContainer=null,o.leftView=null,o.leftLayout=null,o.rightView=null,o.rightLayout=null,o.sideContainer=null,o.sideView=null,o.sideLayout=null,o.btnSideShow=null,o.btnSideHide=null,o.extend1Container=null,o.extend1View=null,o.extend1Layout=null,o.extend2Container=null,o.extend2View=null,o.extend2Layout=null,o.extend3Container=null,o.extend3View=null,o.extend3Layout=null,o.extend4Container=null,o.extend4View=null,o.extend4Layout=null,o.topContainer=null,o.topView=null,o.topLayout=null,o.mAdItemList=[],o.mScrollVec=[],o.mChangeLen=0,o.mIndex=999,o.mShowAd=moosnow.AD_POSITION.NONE,o.mPrevShowAd=moosnow.AD_POSITION.NONE,o.mEndLogic=[],o.mFloatIndex=0,o.mFloatRefresh=3,o.mFloatCache={},o.mSecond=3,o}return o(e,t),e.prototype.setPosition=function(t,o,n,e){void 0===o&&(o=""),void 0===e&&(e=!1);var i=l.deepCopy(t);return i.forEach((function(t){t.position=o,t.onCancel=n,t.refresh=e})),i},e.prototype.loadAd=function(t,o){var n=this;moosnow.entity.preload(t,(function(){moosnow.ad.getAd((function(t){n.mAdData=t,0!=t.indexLeft.length&&o&&o(t)}))}))},e.prototype.initView=function(t,o,n,e,i,r){var s=this;i?this.loadAd(i,(function(t){s.setPosition(t.indexLeft,e,r).forEach((function(t,o){var e=moosnow.entity.showEntity(i,n.node,t);s.mAdItemList.push(e)})),s.pushScroll(o,n)})):console.warn("entityName is null 无法初始化 ")},e.prototype.pushScroll=function(t,o){},e.prototype.addEvent=function(){moosnow.event.addListener(m.AD_VIEW_CHANGE,this,this.onAdChange)},e.prototype.removeEvent=function(){moosnow.event.removeListener(m.AD_VIEW_CHANGE,this)},e.prototype.onAdChange=function(t){this.mChangeLen++,this.mChangeLen>1&&t.showAd!=ht.RECOVER&&(this.mPrevShowAd=this.mShowAd),t.showAd==ht.RECOVER&&(t.showAd=this.mPrevShowAd),this.displayChange(t.showAd,t.callback),this.onAfterShow(this.mIndex)},e.prototype.onAfterShow=function(t){},e.prototype.willShow=function(o){t.prototype.willShow.call(this,o),this.mAdItemList=[],this.mScrollVec=[],this.addEvent(),o?this.displayChange(o.showAd,o.callback):this.displayChange(ht.NONE,null)},e.prototype.displayChange=function(t,o){void 0===o&&(o=null);var n=moosnow.getAppPlatform();moosnow.APP_PLATFORM.WX==n||n==moosnow.APP_PLATFORM.OPPO||n==moosnow.APP_PLATFORM.BYTEDANCE?(this.mShowAd=t,this.displayAd(!0),this.mBackCall=o):this.onBack()},e.prototype.onBack=function(){this.mBackCall&&this.mBackCall()},e.prototype.sideOut=function(){var t=this,o=moosnow.platform.getSystemInfoSync(),n=0,e=0;o&&(n=o.statusBarHeight||0,e=o.notchHeight||0),this.sideView.node.runAction(cc.sequence(cc.moveTo(1,n+e+this.sideView.node.width+20,0),cc.callFunc((function(){t.btnSideShow.active=!1,t.btnSideHide.active=!0}))))},e.prototype.sideIn=function(){var t=this;this.sideView.node.runAction(cc.sequence(cc.moveTo(1,0,0),cc.callFunc((function(){t.btnSideShow.active=!0,t.btnSideHide.active=!1}))))},e.prototype.initFiexdView=function(t,o,e,i,r){var s=this;this.loadAd(i,(function(t){if(s.mEndLogic){for(var a=0;a<s.mEndLogic.length;a++)moosnow.entity.hideEntity(s.mEndLogic[a],{});s.mEndLogic=[]}var h=s.setPosition(t.indexLeft,e,r,!0),l=[],c=[];for(a=0;a<6;a++){var p=h.length>a?h[a]:h[0];c.push({appid:p.appid,position:p.position,index:a}),l.push(p)}l.forEach((function(t){var e=n(n({},t),{showIds:c,source:h}),r=moosnow.entity.showEntity(i,o,e);return s.mEndLogic.push(r),!1}))}))},e.prototype.willHide=function(){this.removeEvent(),this.mAdItemList.forEach((function(t){moosnow.entity.hideEntity(t,null)})),this.mAdItemList=[],this.mScrollVec=[]},e.prototype.initFloatAd=function(t,o,n,e,i){var r=this;cc.loader.loadResDir(moosnow.entity.prefabPath,cc.Prefab,(function(){moosnow.ad.getAd((function(s){if(r.mAdData=s,0!=s.indexLeft.length){var a=r.setPosition(s.indexLeft,e,i,!0),h=[];o.forEach((function(o,e){var i=e;i>a.length-1&&(i=0);var s=a[i];h.push({appid:s.appid,position:s.position,index:e});var l=n[e];s.x=l.x,s.y=l.y,s.source=a,s.showIds=h;var c=moosnow.entity.showEntity(o,t,s);r.mFloatCache[e]={index:i,logic:c},r.floatAnim(c.node)})),r.updateFloat(a),r.schedule((function(){r.updateFloat(a)}),r.mFloatRefresh)}}))}))},e.prototype.floatAnim=function(t){},e.prototype.updateFloat=function(t){for(var o in this.mFloatCache){var n=this.mFloatCache[o].index,e=this.mFloatCache[o].logic;n<t.length-1?n++:n=0,this.mFloatCache[o].index=n,e.refreshImg(t[n])}},e.prototype.hasAd=function(t){return(this.mShowAd&t)==t},e.prototype.showExportClose=function(){this.mSecond-=1,this.exportCloseTxt.active=!0;var t=this.exportCloseTxt.getComponent(cc.Label);if(this.mSecond<=0)return this.exportClose.active=!0,this.exportCloseTxt.active=!1,void this.unschedule(this.showExportClose);t.string="剩余"+this.mSecond+"秒可关闭"},e.prototype.displayAd=function(t){this.floatContainer.active=t&&this.hasAd(ht.FLOAT),this.bannerContainer.active=t&&this.hasAd(ht.BANNER),this.centerContainer.active=t&&this.hasAd(ht.CENTER),this.leftContainer.active=t&&this.hasAd(ht.LEFTRIGHT),this.exportMask.active=t&&this.hasAd(ht.MASK),this.sideContainer.active=t&&this.hasAd(ht.SIDE),this.endContainer.active=t&&this.hasAd(ht.EXPORT_FIXED),this.topContainer.active=t&&this.hasAd(ht.TOP),this.extend1Container.active=t&&this.hasAd(ht.EXTEND1),this.extend2Container.active=t&&this.hasAd(ht.EXTEND2),this.extend3Container.active=t&&this.hasAd(ht.EXTEND3),this.extend4Container.active=t&&this.hasAd(ht.EXTEND4),this.exportContainer.active=t&&this.hasAd(ht.EXPORT),this.showClose(t),this.showInviteBox(t)},e.prototype.showClose=function(t){this.exportClose.active=!1,this.exportCloseTxt.active=!1,this.unschedule(this.showExportClose),t&&this.hasAd(ht.BACK)?this.hasAd(ht.WAIT)?(this.mSecond=3,this.showExportClose(),this.schedule(this.showExportClose,1)):(this.exportClose.active=!0,this.exportCloseTxt.active=!1):(this.exportClose.active=!1,this.exportCloseTxt.active=!1)},e.prototype.showInviteBox=function(t){var o=this;t&&this.hasAd(ht.EXPORT)&&moosnow.http.getAllConfig((function(t){t&&(1==t.exportAutoNavigate&&moosnow.platform.navigate2Mini(o.mAdData.indexLeft[l.randomNumBoth(0,o.mAdData.indexLeft.length-1)]),t.exportAutoInvite&&o._createInviteBox())})),t&&this.hasAd(ht.BANNER)&&moosnow.http.getAllConfig((function(t){o._createInviteBox(),t&&t.bannerAutoInvite&&o._createInviteBox()})),t&&this.hasAd(ht.SIDE)&&moosnow.http.getAllConfig((function(t){t&&t.sideAutoInvite&&o._createInviteBox()}))},e.prototype._createInviteBox=function(){var t=this;moosnow.http.getAllConfig((function(o){if(o){var n=isNaN(o.inviteDelay)?0:parseFloat(o.inviteDelay);n>0?t.scheduleOnce((function(){moosnow.entity.showEntity("inviteBox",cc.Canvas.instance.node,{})}),n):moosnow.entity.showEntity("inviteBox",cc.Canvas.instance.node,{})}else moosnow.entity.showEntity("inviteBox",cc.Canvas.instance.node,{})}))},e.prototype.onFwUpdate=function(){},e}(mt),ft=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n,"TOUCH_START",{get:function(){return cc.Node.EventType.TOUCH_START},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TOUCH_END",{get:function(){return cc.Node.EventType.TOUCH_END},enumerable:!0,configurable:!0}),n}(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n,"TOUCH_START",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(n,"TOUCH_END",{get:function(){return""},enumerable:!0,configurable:!0}),n}(mt)),wt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.mMoveSpeed=2,o}return o(n,t),n.prototype.addEvent=function(){this.exportClose&&this.exportClose.on(ft.TOUCH_END,this.onBack,this),this.btnSideShow&&this.btnSideShow.on(ft.TOUCH_START,this.sideOut,this),this.btnSideHide&&this.btnSideHide.on(ft.TOUCH_START,this.sideIn,this),t.prototype.addEvent.call(this)},n.prototype.removeEvent=function(){this.exportClose&&this.exportClose.off(ft.TOUCH_END,this.onBack,this),this.btnSideShow&&this.btnSideShow.off(ft.TOUCH_START,this.sideOut,this),this.btnSideHide&&this.btnSideHide.off(ft.TOUCH_START,this.sideIn,this),t.prototype.removeEvent.call(this)},n.prototype.floatAnim=function(t){t.runAction(cc.sequence(cc.rotateTo(.3,10),cc.rotateTo(.6,-10),cc.rotateTo(.3,0),cc.scaleTo(.3,.8),cc.scaleTo(.3,1)).repeatForever())},n.prototype.pushScroll=function(t,o){o.type==cc.Layout.Type.GRID?t.vertical?this.mScrollVec.push({scrollView:t,move2Up:!1}):this.mScrollVec.push({scrollView:t,move2Left:!1}):o.type==cc.Layout.Type.HORIZONTAL?this.mScrollVec.push({scrollView:t,move2Left:!1}):o.type==cc.Layout.Type.VERTICAL&&this.mScrollVec.push({scrollView:t,move2Up:!1})},n.prototype.onFwUpdate=function(){for(var t=0;t<this.mScrollVec.length;t++){var o=this.mScrollVec[t],n=o.scrollView;if(!n.isScrolling()){var e=n.getMaxScrollOffset(),i=e.y/2+20,r=e.x/2+20,s=n.getContentPosition();1==o.move2Up?(s.y>i&&(o.move2Up=!1),o.scrollView.setContentPosition(new cc.Vec2(s.x,s.y+this.mMoveSpeed))):0==o.move2Up&&(s.y<-i&&(o.move2Up=!0),o.scrollView.setContentPosition(new cc.Vec2(s.x,s.y-this.mMoveSpeed))),1==o.move2Left?(s.x>r&&(o.move2Left=!1),o.scrollView.setContentPosition(new cc.Vec2(s.x+this.mMoveSpeed,s.y))):0==o.move2Left&&(s.x<-r&&(o.move2Left=!0),o.scrollView.setContentPosition(new cc.Vec2(s.x-this.mMoveSpeed,s.y)))}}},n}(dt);!function(t){t[t.AUTO_HIDE=1]="AUTO_HIDE",t[t.MAST=2]="MAST"}(r||(r={}));var gt=function(){function t(){}return Object.defineProperty(t,"mapping",{get:function(){var t,o,n,e,i,r,s,a,h,l,c,p;return{adForm:(t={},t[moosnow.APP_PLATFORM.WX]="adForm",t),pauseForm:(o={},o[moosnow.APP_PLATFORM.WX]="pauseForm",o[moosnow.APP_PLATFORM.BYTEDANCE]="pauseFormTT",o[moosnow.APP_PLATFORM.OPPO]="pauseFormOPPO",o[moosnow.APP_PLATFORM.OPPO_ZS]="pauseFormOPPO",o[moosnow.APP_PLATFORM.VIVO]="pauseFormOPPO",o[moosnow.APP_PLATFORM.QQ]="pauseFormTT",o),respawnForm:(n={},n[moosnow.APP_PLATFORM.WX]="respawnForm",n[moosnow.APP_PLATFORM.BYTEDANCE]="respawnFormTT",n[moosnow.APP_PLATFORM.OPPO]="respawnFormOPPO",n[moosnow.APP_PLATFORM.OPPO_ZS]="respawnFormOPPO",n[moosnow.APP_PLATFORM.VIVO]="respawnFormOPPO",n[moosnow.APP_PLATFORM.QQ]="respawnFormQQ",n),endForm:(e={},e[moosnow.APP_PLATFORM.WX]="endForm",e[moosnow.APP_PLATFORM.BYTEDANCE]="endFormTT",e[moosnow.APP_PLATFORM.OPPO]="endFormOPPO",e[moosnow.APP_PLATFORM.OPPO_ZS]="endFormOPPO",e[moosnow.APP_PLATFORM.VIVO]="endFormOPPO",e),totalForm:(i={},i[moosnow.APP_PLATFORM.WX]="totalForm",i[moosnow.APP_PLATFORM.BYTEDANCE]="totalFormTT",i[moosnow.APP_PLATFORM.QQ]="totalFormQQ",i),tryForm:(r={},r[moosnow.APP_PLATFORM.WX]="tryForm",r[moosnow.APP_PLATFORM.BYTEDANCE]="tryFormTT",r[moosnow.APP_PLATFORM.QQ]="tryFormTT",r),mistouchForm:(s={},s[moosnow.APP_PLATFORM.WX]="mistouchForm",s[moosnow.APP_PLATFORM.QQ]="mistouchFormQQ",s[moosnow.APP_PLATFORM.BYTEDANCE]="mistouchFormTT",s),prizeForm:(a={},a[moosnow.APP_PLATFORM.BYTEDANCE]="prizeFormTT",a[moosnow.APP_PLATFORM.QQ]="prizeForm",a),shareForm:(h={},h[moosnow.APP_PLATFORM.WX]="shareFormTT",h[moosnow.APP_PLATFORM.BYTEDANCE]="shareFormTT",h),setForm:(l={},l[moosnow.APP_PLATFORM.WX]="setForm",l),toastForm:(c={},c[moosnow.APP_PLATFORM.WX]="toastForm",c),coinForm:(p={},p[moosnow.APP_PLATFORM.WX]="coinForm",p)}},enumerable:!0,configurable:!0}),t.convertUIName=function(t){if(!t)return console.warn("convertUIName fail  mappingForm is null "),null;var o=moosnow.getAppPlatform();return t[o]?t[o]:t[moosnow.APP_PLATFORM.WX]?t[moosnow.APP_PLATFORM.WX]:(console.warn("convertUIName fail ",t),null)},Object.defineProperty(t,"AdForm",{get:function(){return this.convertUIName(this.mapping.adForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CoinForm",{get:function(){return this.convertUIName(this.mapping.coinForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ShareForm",{get:function(){return this.convertUIName(this.mapping.shareForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TotalForm",{get:function(){return this.convertUIName(this.mapping.totalForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EndForm",{get:function(){return this.convertUIName(this.mapping.endForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ToastForm",{get:function(){return this.convertUIName(this.mapping.toastForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PauseForm",{get:function(){return this.convertUIName(this.mapping.pauseForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RespawnForm",{get:function(){return this.convertUIName(this.mapping.respawnForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SetForm",{get:function(){return this.convertUIName(this.mapping.setForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PrizeForm",{get:function(){return this.convertUIName(this.mapping.prizeForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MistouchForm",{get:function(){return this.convertUIName(this.mapping.mistouchForm)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"TryForm",{get:function(){return this.convertUIName(this.mapping.tryForm)},enumerable:!0,configurable:!0}),t}(),yt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.clickProgress=null,o.btnBanner=null,o.logo=null,o.mMaxNum=10,o.mCurrentNum=0,o.mNavigateIndex=0,o.mBannerShow=!1,o.mShowTime=0,o.mBannerClickType=r.AUTO_HIDE,o}return o(n,t),Object.defineProperty(n.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),n.prototype.initPos=function(){},n.prototype.willShow=function(o){var n=this;t.prototype.willShow.call(this,o),this.btnBanner.active=!0,this.initPos(),this.mCurrentNum=0,this.mNavigateIndex=l.randomNumBoth(3,this.mMaxNum-2),this.addEvent(),this.schedule(this.subProgress,.1),moosnow.form.showAd(moosnow.AD_POSITION.NONE,null),this.mBannerShow=!1,moosnow.http.getAllConfig((function(t){n.mBannerClickType=r.MAST}))},n.prototype.willHide=function(){this.unschedule(this.subProgress),this.unschedule(this.resetProgress),this.removeEvent()},n.prototype.subProgress=function(){this.mCurrentNum>0&&(this.mCurrentNum-=.1)},n.prototype.addEvent=function(){},n.prototype.removeEvent=function(){},n.prototype.bannerClickCallback=function(t){t&&(this.unschedule(this.onHideBanner),this.unschedule(this.resetProgress),moosnow.platform.hideBanner(),this.mBannerShow=!1,this.FormData&&this.FormData.callback&&this.FormData.callback())},n.prototype.onLogoUp=function(){this.logo.position=this.mEndPos},n.prototype.onLogoDown=function(){this.logo.position=this.mBeginPos},n.prototype.onBannerClick=function(){var t=this;this.onLogoDown(),this.mCurrentNum+=1,this.mCurrentNum>=this.mNavigateIndex&&(this.mBannerShow||(this.mShowTime=Date.now(),this.mBannerShow=!0,moosnow.platform.showBanner((function(o){console.log("banner click callback ",o),t.bannerClickCallback(o)})),this.mBannerClickType==r.AUTO_HIDE?(this.unschedule(this.onHideBanner),this.scheduleOnce(this.onHideBanner,2)):this.mBannerClickType==r.MAST&&(this.unschedule(this.resetProgress),this.scheduleOnce(this.resetProgress,2)))),this.mCurrentNum>=this.mMaxNum&&(moosnow.platform.hideBanner(),this.mBannerShow=!1,moosnow.ui.destroyUIForm(gt.MistouchForm,null),this.FormData&&this.FormData.callback&&this.FormData.callback(!0))},n.prototype.resetProgress=function(){this.mCurrentNum=0,moosnow.platform.hideBanner(),this.mBannerShow=!1},n.prototype.onHideBanner=function(){moosnow.platform.hideBanner()},n.prototype.update=function(){this.clickProgress.progress=this.mCurrentNum/this.mMaxNum},n}(mt),vt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.clickProgress=null,o.btnBanner=null,o.logo=null,o}return o(n,t),n.prototype.addEvent=function(){this.btnBanner.on(ft.TOUCH_START,this.onLogoUp,this),this.btnBanner.on(ft.TOUCH_END,this.onBannerClick,this)},n.prototype.removeEvent=function(){this.btnBanner.off(ft.TOUCH_START,this.onLogoUp,this),this.btnBanner.off(ft.TOUCH_END,this.onBannerClick,this),moosnow.event.removeListener(m.ON_PLATFORM_SHOW,this)},n.prototype.onLogoUp=function(){this.logo.position=this.mEndPos},n.prototype.onLogoDown=function(){this.logo.position=this.mBeginPos},n.prototype.initPos=function(){this.mBeginPos=this.logo.position.clone(),this.mEndPos=this.mBeginPos.add(new cc.Vec2(0,50))},n}(yt),bt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.clickProgress=null,o.btnReceive=null,o.btnConfirm=null,o.checked=null,o.unchecked=null,o.step1=null,o.step2=null,o.logo=null,o}return o(n,t),n.prototype.playBoxAnim=function(t){var o=this.logo.getComponent(cc.Animation);o.getAnimationState(t).isPlaying||o.play(t)},n.prototype.addEvent=function(){this.unchecked.node.on(ft.TOUCH_END,this.checkboxChange,this),this.btnReceive.on(ft.TOUCH_START,this.onLogoUp,this),this.btnReceive.on(ft.TOUCH_END,this.onBannerClick,this),this.btnConfirm.on(ft.TOUCH_END,this.openBox,this)},n.prototype.removeEvent=function(){this.unchecked.node.off(ft.TOUCH_END,this.checkboxChange,this),this.btnReceive.off(ft.TOUCH_START,this.onLogoUp,this),this.btnReceive.off(ft.TOUCH_END,this.onBannerClick,this),this.btnConfirm.off(ft.TOUCH_END,this.openBox,this)},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.clickProgress=null,o.btnReceive=null,o.btnConfirm=null,o.checked=null,o.unchecked=null,o.step1=null,o.step2=null,o.logo=null,o.mMaxNum=10,o.mCurrentNum=0,o.mOpenVideo=!0,o}return o(n,t),n.prototype.willShow=function(o){t.prototype.willShow.call(this,o),this.step1.active=!0,this.step2.active=!1,this.btnConfirm.active=!0,this.mCurrentNum=0,this.mOpenVideo=!0,this.showCheckbox(),this.addEvent(),this.schedule(this.subProgress,.1),moosnow.form.showAd(moosnow.AD_POSITION.NONE,null)},n.prototype.willHide=function(){this.unschedule(this.subProgress),this.unschedule(this.resetProgress),this.removeEvent()},n.prototype.subProgress=function(){this.mCurrentNum>0&&(this.mCurrentNum-=.1)},n.prototype.addEvent=function(){},n.prototype.removeEvent=function(){},n.prototype.openBox=function(){var t=this;this.mOpenVideo?(this.btnConfirm.active=!1,moosnow.platform.showVideo((function(o){o!=moosnow.VIDEO_STATUS.END?(o==moosnow.VIDEO_STATUS.NOTEND?moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND):moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR),t.btnConfirm.active=!0):t.FormData&&t.FormData.callback&&t.FormData.callback(!0)}))):moosnow.ui.hideUIForm(gt.MistouchForm,null)},n.prototype.checkboxChange=function(){this.mOpenVideo=!this.mOpenVideo,this.showCheckbox()},n.prototype.showCheckbox=function(){this.mOpenVideo?this.checked.node.active=!0:this.checked.node.active=!1},n.prototype.playBoxAnim=function(t){},n.prototype.onLogoUp=function(){this.playBoxAnim("prizeBox2")},n.prototype.onBannerClick=function(){this.mCurrentNum>this.mMaxNum+1||(this.mCurrentNum+=1,this.mCurrentNum>=this.mMaxNum&&(this.step1.active=!1,this.step2.active=!0,this.playBoxAnim("prizeBox1")))},n.prototype.resetProgress=function(){this.mCurrentNum=0},n.prototype.update=function(){var t=this.mCurrentNum/this.mMaxNum;this.clickProgress.progress=t>1?1:t},n}(yt)),Ct=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.clickProgress=null,o.btnBanner=null,o.logo=null,o.hand=null,o.pinch1=null,o.pinch2=null,o.pinch3=null,o.pinch4=null,o.pinch5=null,o.pinch6=null,o}return o(n,t),n.prototype.onLogoUp=function(){},n.prototype.onLogoDown=function(){var t=this.logo.getComponent(cc.Sprite);this.mCurrentNum<this.mMaxNum?t.spriteFrame=this["pinch"+(parseInt(""+this.mCurrentNum)%4+1)]:t.spriteFrame=this.pinch6},n.prototype.addEvent=function(){var t=this;this.mistouchAppBox()?(this.btnBanner.active=!1,this.logo.on(ft.TOUCH_START,this.onLogoUp,this),this.logo.on(ft.TOUCH_END,this.onBannerClick,this)):(this.btnBanner.active=!0,this.btnBanner.on(ft.TOUCH_START,this.onLogoUp,this),this.btnBanner.on(ft.TOUCH_END,this.onBannerClick,this)),moosnow.event.addListener(m.ON_PLATFORM_SHOW,this,(function(){t.mBannerShow&&t.bannerClickCallback(!0)}))},n.prototype.removeEvent=function(){this.btnBanner.off(ft.TOUCH_END,this.onBannerClick,this),moosnow.event.removeListener(m.ON_PLATFORM_SHOW,this)},n.prototype.playHandAnim=function(){this.hand.getComponent(cc.Animation).play()},n.prototype.showButton=function(t){this.btnBanner.active=t},n.prototype.showHand=function(t){this.hand.active=t},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.clickProgress=null,o.btnBanner=null,o.logo=null,o.hand=null,o.pinch1=null,o.pinch2=null,o.pinch3=null,o.pinch4=null,o.pinch5=null,o.pinch6=null,o}return o(n,t),n.prototype.willShow=function(o){t.prototype.willShow.call(this,o),this.mCurrentNum=0,this.mNavigateIndex=l.randomNumBoth(3,this.mMaxNum-2),this.addEvent(),this.schedule(this.subProgress,.016),moosnow.form.showAd(moosnow.AD_POSITION.NONE,null),this.mBannerShow=!1,this.mistouchAppBox()?(this.showHand(!0),this.showButton(!1),this.playHandAnim()):(this.showHand(!1),this.showButton(!0)),moosnow.platform.hideBanner()},n.prototype.playHandAnim=function(){},n.prototype.mistouchAppBox=function(){return this.FormData&&2==this.FormData.type},n.prototype.subProgress=function(){this.mCurrentNum>0&&(this.mCurrentNum-=.02)},n.prototype.initPos=function(){},n.prototype.onHideBanner=function(){this.mistouchAppBox()?moosnow.platform.hideAppBox():moosnow.platform.hideBanner()},n.prototype.showButton=function(t){},n.prototype.showHand=function(t){},n.prototype.onBannerClick=function(){var t=this;this.mCurrentNum+=1,this.onLogoDown(),this.showHand(!1),this.mCurrentNum>=this.mNavigateIndex&&(this.mBannerShow||(this.mShowTime=Date.now(),this.mBannerShow=!0,this.mistouchAppBox()?moosnow.platform.showAppBox((function(){t.bannerClickCallback(!0)})):moosnow.platform.showBanner((function(o){console.log("banner click callback ",o),t.bannerClickCallback(o)})),this.mBannerClickType==r.AUTO_HIDE?(this.unschedule(this.onHideBanner),this.scheduleOnce(this.onHideBanner,2)):this.mBannerClickType==r.MAST&&(this.unschedule(this.resetProgress),this.scheduleOnce(this.resetProgress,2)))),this.mCurrentNum>=this.mMaxNum&&(moosnow.platform.hideBanner(),this.mBannerShow=!1,this.scheduleOnce((function(){moosnow.ui.destroyUIForm(gt.MistouchForm,null),t.FormData&&t.FormData.callback&&t.FormData.callback()}),.2))},n}(yt)),Nt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.initForm=function(t){this.initProperty(t)},Object.defineProperty(n.prototype,"LogicData",{get:function(){return this.mLogicData},enumerable:!0,configurable:!0}),n.prototype.willShow=function(t){this.mLogicData=t,this.initPosition(t)},n.prototype.initPosition=function(t){},n.prototype.onShow=function(t){},n.prototype.willHide=function(t){},n.prototype.onHide=function(t){},n}(c),It=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.addListener=function(){this.logo.node.on(ft.TOUCH_END,this.onClickAd,this)},n.prototype.removeListener=function(){this.logo.node.off(ft.TOUCH_END,this.onClickAd,this)},n.prototype.initPosition=function(t){},n.prototype.willShow=function(o){var n=this;t.prototype.willShow.call(this,o),this.mAdItem=o,cc.loader.load(o.img,(function(t,o){var e=new cc.SpriteFrame(o);n.logo.spriteFrame=e})),this.title&&(this.title.string=o.title)},n.prototype.refreshImg=function(t){var o=this;this.mAdItem=t,cc.loader.load(t.img,(function(t,n){var e=new cc.SpriteFrame(n);o.logo.spriteFrame=e})),this.title&&(this.title.string=t.title)},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.logo=null,o.title=null,o.animLogo=null,o.nameBg=null,o.changeView=!1,o}return o(n,t),n.prototype.onClickAd=function(){var t=this,o=this.mAdItem;if(this.LogicData.refresh){var n=this.findNextAd();n.refresh&&moosnow.event.sendEventImmediately(m.AD_VIEW_REFRESH,{current:o,next:n}),this.refreshImg(n)}moosnow.platform.navigate2Mini(o,(function(){}),(function(){t.mAdItem.onCancel&&t.mAdItem.onCancel(o)}))},n.prototype.findNextAd=function(){if(!this.LogicData.source)return null;if(!this.LogicData.showIds)return null;for(var t=0;t<this.LogicData.source.length;t++){for(var o=!1,n=0;n<this.LogicData.showIds.length;n++)this.LogicData.showIds[n].appid==this.LogicData.source[t].appid&&this.LogicData.showIds[n].position==this.LogicData.source[t].position&&(o=!0);if(!o)return this.LogicData.source[t]}return null},n.prototype.onAdViewChange=function(t){if(this.LogicData.showIds&&this.LogicData.source){for(var o=t.current,n=t.next,e=this.LogicData.showIds,i=this.LogicData.source,r=0;r<e.length;r++)o.appid==e[r].appid&&o.position==e[r].position&&(this.LogicData.showIds[r]=n.appid);for(r=0;r<i.length;r++)if(n.appid==i[r].appid){this.LogicData.source.splice(r,1),this.LogicData.source.push(o);break}}},n.prototype.onShow=function(){this.LogicData&&this.LogicData.refresh&&moosnow.event.addListener(m.AD_VIEW_REFRESH,this,this.onAdViewChange)},n.prototype.onHide=function(){this.mAdItem&&(this.mAdItem.onCancel=null),this.removeListener(),moosnow.event.removeListener(m.AD_VIEW_REFRESH,this)},n.prototype.addListener=function(){},n.prototype.removeListener=function(){},n.prototype.willShow=function(o){t.prototype.willShow.call(this,o),this.addListener()},n.prototype.refreshImg=function(t){},n}(Nt)),_t=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.coinNum=null,o.btnConfirm=null,o}return o(n,t),n.prototype.initForm=function(t){this.initProperty(t),this.btnConfirm.on(ft.TOUCH_END,this.closeForm,this)},n.prototype.willHide=function(){this.btnConfirm.off(ft.TOUCH_END,this.closeForm,this)},n}(function(t){function e(){var o=null!==t&&t.apply(this,arguments)||this;return o.coinNum=null,o.btnConfirm=null,o}return o(e,t),Object.defineProperty(e.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),e.prototype.initForm=function(t){this.initProperty(t)},e.prototype.willHide=function(){},e.prototype.willShow=function(o){t.prototype.willShow.call(this,o),this.coinNum.string=""+l.formatMoney(o.coinNum),moosnow.platform.hideBanner()},e.prototype.closeForm=function(){var t=this;moosnow.ui.destroyUIForm(gt.PrizeForm,null),moosnow.ui.destroyUIForm(gt.MistouchForm,null),1==this.FormData.showCoinAnim?moosnow.ui.pushUIForm(gt.CoinForm,n(n({},l.deepCopy(this.FormData)),{callback:function(){t.FormData.callback&&t.FormData.callback()}})):this.FormData.callback&&this.FormData.callback()},e}(mt)),St=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.coinNum=null,o.btnConfirm=null,o}return o(n,t),n.prototype.onChecked=function(){this.mChecked=!this.mChecked,this.checked.active=this.mChecked},n.prototype.initForm=function(t){this.initProperty(t),this.btnConfirm.on(ft.TOUCH_END,this.closeForm,this)},n.prototype.willHide=function(){this.btnConfirm.off(ft.TOUCH_END,this.closeForm,this)},n.prototype.addListener=function(){this.btnCancel.on(ft.TOUCH_END,this.closeForm,this),this.btnVideo.on(ft.TOUCH_END,this.onVideo,this),this.btnReceive.on(ft.TOUCH_END,this.onReceive,this),this.btnShare.on(ft.TOUCH_END,this.onShare,this),this.unchecked.on(ft.TOUCH_END,this.onChecked,this)},n.prototype.removeListener=function(){this.btnCancel.off(ft.TOUCH_END,this.closeForm,this),this.btnVideo.off(ft.TOUCH_END,this.onVideo,this),this.btnReceive.off(ft.TOUCH_END,this.onReceive,this),this.btnShare.off(ft.TOUCH_END,this.onShare,this),this.unchecked.off(ft.TOUCH_END,this.onChecked,this)},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.prizeBg1=null,o.prizeBg2=null,o.btnCancel=null,o.txtCoutdown=null,o.btnVideo=null,o.btnShare=null,o.btnReceive=null,o.checked=null,o.unchecked=null,o.isMask=!0,o.mChecked=!1,o.mTotalSecond=10,o.mCurrentSecond=0,o}return o(n,t),Object.defineProperty(n.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),n.prototype.initForm=function(t){this.initProperty(t)},n.prototype.willShow=function(o){var n=this;t.prototype.willShow.call(this,o),this.addListener(),this.mChecked=!1,this.onChecked(),this.prizeBg1.active=!1,this.prizeBg2.active=!1,moosnow.http.getAllConfig((function(t){if(t)if(1==t.prizeFormVideo)n.showVideo();else if(2==t.prizeFormVideo)n.showShare();else{var o=t&&t.prizeFormVideosPrecent?parseFloat(t.prizeFormVideosPrecent):.5;l.randomNumBoth(0,100)/100<o?n.showVideo():n.showShare()}else n.showShare()})),this.mTotalSecond=10,this.mCurrentSecond=0,this.resumeCountdown(),moosnow.platform.showBanner()},n.prototype.onHide=function(){this.removeListener()},n.prototype.showVideo=function(){this.prizeBg1.active=!0,this.prizeBg2.active=!1},n.prototype.showShare=function(){this.prizeBg1.active=!1,this.prizeBg2.active=!0},n.prototype.onCountdown=function(){this.mCurrentSecond+=1;var t=this.mTotalSecond-this.mCurrentSecond;if(t<0)return this.unschedule(this.onCountdown),void moosnow.ui.hideUIForm(gt.PrizeForm,null);this.txtCoutdown.string=t+"秒"},n.prototype.stopCountdown=function(){this.unschedule(this.onCountdown)},n.prototype.resumeCountdown=function(){this.schedule(this.onCountdown,1)},n.prototype.addListener=function(){},n.prototype.removeListener=function(){},n.prototype.closeForm=function(){moosnow.ui.hideUIForm(gt.PrizeForm,null)},n.prototype.onChecked=function(){},n.prototype.onShare=function(){var t=this;this.stopCountdown(),moosnow.platform.share({channel:""},(function(o){t.resumeCountdown(),t.FormData&&(t.FormData.hideForm&&moosnow.ui.hideUIForm(gt.PrizeForm,null),t.FormData.shareCallback&&t.FormData.shareCallback(o))}))},n.prototype.onReceive=function(){this.mChecked?this.onVideo():this.FormData&&(this.FormData.hideForm&&moosnow.ui.hideUIForm(gt.PrizeForm,null),this.FormData.callback&&this.FormData.callback())},n.prototype.onVideo=function(){var t=this;this.stopCountdown(),moosnow.platform.showVideo((function(o){o!=moosnow.VIDEO_STATUS.END?(o==moosnow.VIDEO_STATUS.ERR?moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR):moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND),t.resumeCountdown()):t.FormData&&(t.FormData.hideForm&&moosnow.ui.hideUIForm(gt.PrizeForm,null),t.FormData.videoCallback&&t.FormData.videoCallback())}))},n}(mt)),At=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n.prototype,"rootNode",{get:function(){return cc.Canvas.instance.node},enumerable:!0,configurable:!0}),n.prototype.flyAnim=function(t,o,n){var e=t.node,i=l.randomNumBoth(0,100)/200;e.active=!0,e.runAction(cc.sequence(cc.delayTime(i),cc.spawn(cc.moveTo(1,o.x,o.y),cc.fadeOut(1),cc.sequence(cc.scaleTo(.8,1.2,1.2),cc.scaleTo(.8,.8,9.8))),cc.callFunc((function(){moosnow.entity.hideEntity(t,null,!0)}))))},n}(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),Object.defineProperty(n.prototype,"rootNode",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),n.prototype.flyAnim=function(t,o,n){},n.prototype.onShow=function(t){var o=this,n=this.FormData,e=n.imgNum,i=(n.coinNum,n.starVec),r=n.endVec,s=n.callback;console.log("showCoin",t),cc.loader.loadRes(moosnow.entity.prefabPath+"coin",cc.Prefab,(function(){for(var n=0;n<e;n++){var a=moosnow.entity.showEntity("coin",o.rootNode,{x:l.randomNumBoth(i.x-t.randomX,i.x+t.randomX),y:l.randomNumBoth(i.y-t.randomY,i.y+t.randomY)});o.flyAnim(a,r,s)}o.scheduleOnce((function(){o.FormData.hideForm&&moosnow.ui.hideUIForm(gt.CoinForm,null),l.isFunction(s)&&s()}),2.1)}))},n}(mt)),Pt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.addEvent=function(){this.unchecked.node.on(ft.TOUCH_END,this.onShareChange,this),this.btnReceive.node.on(ft.TOUCH_END,this.onReceive,this)},n.prototype.removeEvent=function(){this.unchecked.node.off(ft.TOUCH_END,this.onShareChange,this),this.btnReceive.node.off(ft.TOUCH_END,this.onReceive,this)},n.prototype.changeUI=function(){this.mCheckedVideo?this.checked.node.active=!0:this.checked.node.active=!1},n}(function(t){function e(){var o=null!==t&&t.apply(this,arguments)||this;return o.checked=null,o.unchecked=null,o.btnReceive=null,o.levelCoin=null,o.mCheckedVideo=!0,o.mLevelCoinNum=0,o.mLevelShareCoinNum=0,o}return o(e,t),e.prototype.initForm=function(t){this.initProperty(t)},e.prototype.addEvent=function(){},e.prototype.removeEvent=function(){},e.prototype.onReceive=function(){var t=this;this.mCheckedVideo?moosnow.platform.showVideo((function(o){o==moosnow.VIDEO_STATUS.END?t.openEndForm(5*t.mLevelCoinNum):o==moosnow.VIDEO_STATUS.ERR?moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR):moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND)})):this.openEndForm(this.mLevelCoinNum)},e.prototype.openEndForm=function(t){moosnow.ui.hideUIForm(gt.TotalForm,null),moosnow.ui.pushUIForm(gt.EndForm,n({coin:t,level:this.FormData.level,levelShareCoinNum:this.mLevelShareCoinNum},this.FormData))},e.prototype.onShareChange=function(){this.mCheckedVideo=!this.mCheckedVideo,this.changeUI()},e.prototype.changeUI=function(){},e.prototype.onShow=function(t){var o=t.coin,n=t.shareCoin;this.mLevelCoinNum=o,this.mLevelShareCoinNum=n,this.levelCoin.string=""+l.formatMoney(this.mLevelCoinNum),this.addEvent(),this.mCheckedVideo=!0,this.changeUI(),moosnow.platform.stopRecord(),moosnow.platform.showBanner()},e.prototype.willHide=function(){this.removeEvent(),moosnow.platform.hideBanner()},e}(mt)),Ot=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.addListener=function(){this.btnBack.on(ft.TOUCH_END,this.onBack,this),this.btnShare.on(ft.TOUCH_END,this.onShareVideo,this)},n.prototype.removeListener=function(){this.btnBack.off(ft.TOUCH_END,this.onBack,this),this.btnShare.off(ft.TOUCH_END,this.onShareVideo,this)},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.btnShare=null,o.btnBack=null,o.txtCoinNum=null,o.isMask=!0,o.mLevelShareCoinNum=0,o.mShareing=!1,o}return o(n,t),Object.defineProperty(n.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),n.prototype.initForm=function(t){this.initProperty(t),this.addListener()},n.prototype.addListener=function(){},n.prototype.removeListener=function(){},n.prototype.onBack=function(){this.FormData.hideForm&&moosnow.ui.hideUIForm(gt.ShareForm,null),this.FormData&&this.FormData.callback&&this.FormData.callback()},n.prototype.onShow=function(){this.btnShare.active=!0,this.mLevelShareCoinNum=this.FormData.shareCoinNum,this.txtCoinNum.string=""+l.formatMoney(this.mLevelShareCoinNum),moosnow.platform.stopRecord()},n.prototype.onShareVideo=function(){var t=this;this.mShareing||(this.mShareing=!0,moosnow.http.getAllConfig((function(o){if(o)if(1==o.shareFormVideo)t.onVideo();else if(2==o.shareFormVideo)t.onShare();else{var n=o&&o.shareFormVideoPrecent?parseFloat(o.shareFormVideoPrecent):.5;l.randomNumBoth(0,100)/100<n?t.onVideo():t.onShare()}else t.onVideo()})))},n.prototype.onVideo=function(){var t=this;moosnow.platform.showVideo((function(o){t.mShareing=!1,o==moosnow.VIDEO_STATUS.END?(t.FormData.hideForm&&moosnow.ui.hideUIForm(gt.ShareForm,null),t.FormData&&t.FormData.videoCallback&&t.FormData.videoCallback()):o==moosnow.VIDEO_STATUS.NOTEND?moosnow.ui.showToast(moosnow.VIDEO_MSG.NOTEND):moosnow.ui.showToast(moosnow.VIDEO_MSG.ERR)}))},n.prototype.onShare=function(){var t=this;moosnow.platform.share({channel:moosnow.SHARE_CHANNEL.VIDEO},(function(o){t.mShareing=!1,o?(t.FormData.hideForm&&moosnow.ui.hideUIForm(gt.ShareForm,null),t.FormData&&t.FormData.shareCallback&&t.FormData.shareCallback(o)):moosnow.ui.showToast("分享未完成"),console.log("分享结束",o)}))},n}(mt)),Ft=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return o(n,t),n.prototype.addListener=function(){this.btnConfirm.on(ft.TOUCH_END,this.onConfirm,this),this.btnCancel.on(ft.TOUCH_END,this.onCancel,this)},n.prototype.removeListener=function(){this.btnConfirm.off(ft.TOUCH_END,this.onConfirm,this),this.btnCancel.off(ft.TOUCH_END,this.onCancel,this)},n.prototype.initBox=function(t,o,n){var e=this;cc.loader.load(o,(function(t,o){if(!t){var n=new cc.SpriteFrame(o);e.logo.getComponent(cc.Sprite).spriteFrame=n}})),this.userName.string=l.format(f,t),this.gameName.string=n},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.logo=null,o.gameName=null,o.userName=null,o.btnConfirm=null,o.btnCancel=null,o.url="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/Avatar",o}return o(n,t),n.prototype.willShow=function(o){var n=this;t.prototype.willShow.call(this,o),this.addListener(),moosnow.http.request(this.url+"/avatar.json",{},"GET",(function(t){var o=t.name[l.randomNumBoth(0,t.name.length-1)],e=l.randomNumBoth(t.logo[0],t.logo[1]);moosnow.ad.getAd((function(t){var i=l.randomNumBoth(0,t.indexLeft.length-1),r=t.indexLeft[i];n.initBox(o,n.url+"/"+e+".png",r.title),n.mCurrentAdRow=r}))})),moosnow.http.getAllConfig((function(t){if(t){var o=isNaN(t.inviteDelayClose)?0:parseFloat(t.inviteDelayClose);o>0&&(n.unscheduleOnce(n.onCancel),n.scheduleOnce(n.onCancel,o))}}))},n.prototype.willHide=function(){this.unscheduleOnce(this.onCancel),this.removeListener()},n.prototype.initBox=function(t,o,n){},n.prototype.addListener=function(){},n.prototype.removeListener=function(){},n.prototype.onConfirm=function(){this.onCancel(),moosnow.platform.navigate2Mini(this.mCurrentAdRow)},n.prototype.onCancel=function(){moosnow.entity.hideAllEntity("inviteBox",null)},n}(Nt)),Et=function(){function t(){}return t.prototype.newViewItem=function(){return new It},Object.defineProperty(t.prototype,"inviteBox",{get:function(){return this.mAdInviteBox||(this.mAdInviteBox=new Ft),this.mAdInviteBox},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adForm",{get:function(){return this.mAdForm||(this.mAdForm=new wt),this.mAdForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"adFormQQ",{get:function(){return this.mAdForm||(this.mAdForm=new wt),this.mAdFormQQ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mistouchForm",{get:function(){return this.mMistouchForm||(this.mMistouchForm=new vt),this.mMistouchForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mistouchFormTT",{get:function(){return this.mMistouchFormTT||(this.mMistouchFormTT=new bt),this.mMistouchFormTT},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mistouchFormQQ",{get:function(){return this.mMistouchFormQQ||(this.mMistouchFormQQ=new Ct),this.mMistouchFormQQ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prizeForm",{get:function(){return this.mPrizeForm||(this.mPrizeForm=new _t),this.mPrizeForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prizeFormTT",{get:function(){return this.mPrizeFormTT||(this.mPrizeFormTT=new St),this.mPrizeFormTT},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coinForm",{get:function(){return this.mCoinForm||(this.mCoinForm=new At),this.mCoinForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"totalForm",{get:function(){return this.mTotalForm||(this.mTotalForm=new Pt),this.mTotalForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shareFormTT",{get:function(){return this.mShareForm||(this.mShareForm=new Ot),this.mShareForm},enumerable:!0,configurable:!0}),t}(),Tt=function(){function t(){}return t.prototype.showToast=function(t){moosnow.ui.showToast(t)},t.prototype.preloadAd=function(){moosnow.ui.pushUIForm(gt.AdForm,{showAd:moosnow.AD_POSITION.NONE},null)},t.prototype.showAd=function(t,o,n){if(void 0===t&&(t=ht.NONE),void 0===n&&(n=999),moosnow.getAppPlatform()==moosnow.APP_PLATFORM.BYTEDANCE&&moosnow.platform.isIphone())console.log("头条iphone 不显示广告");else{var e=moosnow.ui.getUIFrom(gt.AdForm);e?(moosnow.event.sendEventImmediately(m.AD_VIEW_CHANGE,{showAd:t,callback:o,zIndex:n}),e.node.zIndex=n):moosnow.ui.pushUIForm(gt.AdForm,{showAd:moosnow.AD_POSITION.NONE},(function(){moosnow.ui.getUIFrom(gt.AdForm).node.zIndex=n,moosnow.event.sendEventImmediately(m.AD_VIEW_CHANGE,{showAd:t,callback:o,zIndex:n})}))}},t.prototype.showCoin=function(t){moosnow.ui.pushUIForm(gt.CoinForm,t)},t.prototype.showMistouch=function(t){moosnow.ui.pushUIForm(gt.MistouchForm,t,(function(){}))},t.prototype.showPrize=function(t){moosnow.ui.pushUIForm(gt.PrizeForm,t,(function(){}))},t.prototype.showTotal=function(t){moosnow.ui.pushUIForm(gt.TotalForm,t)},t.prototype.showEnd=function(t){moosnow.ui.pushUIForm(gt.EndForm,t)},t.prototype.showShare=function(t){moosnow.ui.pushUIForm(gt.ShareForm,t)},t}(),Lt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.moveNode=null,o.distince=-100,o.showBanner=!0,o.pos1=cc.Vec2.ZERO,o.pos2=cc.Vec2.ZERO,o}return o(n,t),n.prototype.initPos=function(){0==this.pos1.x&&0==this.pos1.y&&(this.pos1=this.moveNode.position.clone(),this.pos2=this.pos1.add(new cc.Vec2(0,this.distince))),this.moveNode.active=!1},n.prototype.setPosition=function(t,o,n,e){t.active=o,t.x=n,t.y=e},n.prototype.copyNode=function(){var t=cc.instantiate(this.moveNode);return t.active=!0,this.moveNode.parent.addChild(t),t.x=this.pos2.x,t.y=this.pos2.y,t},n.prototype.removeTemp=function(t){t.active=!1,t.removeFromParent(),t.destroy()},n}(function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.moveNode=null,o.distince=-100,o.showBanner=!0,o.pos1=cc.Vec2.ZERO,o.pos2=cc.Vec2.ZERO,o.mMistouchPosNum=0,o.mMistouchPosSecond=2,o}return o(n,t),n.prototype.initPos=function(){},n.prototype.move=function(t,o,n){var e=this;this.moveNode=t,this.distince=o,this.showBanner=n,this.initPos();var i=moosnow.data.getCurrentMisTouchCount();moosnow.data.setCurrentMisTouchCount(i+1),moosnow.http.getAllConfig((function(t){isNaN(t.mistouchPosSecond)||(e.mMistouchPosSecond=parseFloat(t.mistouchPosSecond)),moosnow.http.getMistouchPosNum((function(t){e.mMistouchPosNum=t,e.movePosition()}))}))},n.prototype.setPosition=function(t,o,n,e){},n.prototype.movePosition=function(){var t=this;if(0==this.mMistouchPosNum)this.setPosition(this.moveNode,!0,this.pos1.x,this.pos1.y),this.showBanner&&moosnow.platform.showBanner();else if(moosnow.data.getCurrentMisTouchCount()%this.mMistouchPosNum==0){var o=this.copyNode();this.scheduleOnce((function(){t.onPosCallback(o)}),this.mMistouchPosSecond)}},n.prototype.copyNode=function(){},n.prototype.onPosCallback=function(t){this.showBanner&&moosnow.platform.showBanner(),this.removeTemp(t),this.setPosition(this.moveNode,!0,this.pos1.x,this.pos1.y),this.unscheduleOnce(this.onPosCallback)},n.prototype.removeTemp=function(t){},n}(c)),Bt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.mNode=null,o}return o(n,t),n.prototype.show=function(t,o){void 0===o&&(o=3),t&&(this.mNode=t,this.hideNode(),this.schedule(this.showNode,o))},n.prototype.hide=function(t,o){void 0===o&&(o=3),this.mNode=t,this.schedule(this.hideNode,o)},n.prototype.clear=function(){this.unschedule(this.showNode),this.unschedule(this.hideNode)},n.prototype.hideNode=function(){this.mNode.active=!1},n.prototype.showNode=function(){this.mNode.active=!0,this.unschedule(this.showNode)},n}(c),xt=function(t){function n(){return t.call(this)||this}return o(n,t),Object.defineProperty(n.prototype,"DelayMove",{get:function(){return this.mDelayMove||(this.mDelayMove=new Lt),this.mDelayMove},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"DelayShow",{get:function(){return this.mDelayShow||(this.mDelayShow=new Bt),this.mDelayShow},enumerable:!0,configurable:!0}),n}(c),Dt=function(t){function n(){return t.call(this)||this}return o(n,t),n.prototype.onEnable=function(){},n.prototype.loadAsset=function(t,o,n){if(l.getEngine()==s){if(e=cc.loader.getRes(t,o))return void(n&&n(null,e));cc.loader.loadRes(t,o,(function(t,o){n&&n(t,o)}))}else if(l.getEngine()==a){var e;if(e=Laya.loader.getRes(t))return void(n&&n(null,e));Laya.loader.create(t,Laya.Handler.create(this,(function(t){n(null,t)})),null,o)}},n.prototype.loadAssetDir=function(t,o,n,e){l.getEngine()==s?cc.loader.loadResDir(t,o,(function(t,o,e){var i=t/o*100;i=Math.ceil(i),n&&n(i)}),(function(t,o){e&&e(t,o)})):console.warn("不支持loadAssetDir")},n.prototype.onDisable=function(){},n}(c),kt=function(){function t(){this._hideForm=!0,this.extraData={}}return t.create=function(t){return new t},Object.defineProperty(t.prototype,"hideForm",{get:function(){return this._hideForm},set:function(t){this._hideForm=t},enumerable:!0,configurable:!0}),t}(),Rt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.coinNum=0,o.videoNum=0,o.shareCoinNum=0,o.isWin=!0,o.level="1",o}return o(n,t),n}(kt),Ut=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.showCoinAnim=!0,o.coinOptions=null,o.baseNum=1,o.callback=null,o.shareCallback=null,o.videoCallback=null,o}return o(n,t),n}(kt),Mt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.shareCoinNum=0,o}return o(n,t),n}(kt),Ht=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.coinNum=0,o.videoNum=0,o.shareCoinNum=0,o}return o(n,t),n}(kt),Vt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.type=1,o}return o(n,t),n}(kt),Wt=function(){this.x=0,this.y=0,this.z=0},jt=function(t){function n(){var o=null!==t&&t.apply(this,arguments)||this;return o.randomY=100,o.randomX=100,o.imgNum=30,o.coinNum=0,o.starVec=new Wt,o.endVec=new Wt,o}return o(n,t),n}(kt);new(function(){function t(){this.VIDEO_STATUS=u,this.VIDEO_MSG=nt,this.SHARE_MSG=ot,this.BANNER_POSITION=p,this.SHARE_CHANNEL=Q,this.APP_PLATFORM=e,this.PLATFORM_EVENT=m,this.Common=l,this.AD_POSITION=ht,this.showOptions={endOptions:Rt,prizeOptions:Ut,shareOptions:Mt,totalOptions:Ht,touchOptions:Vt,coinOptions:jt},this.mData=new W,this.mResource=new Dt,this.mSetting=new j,this.mForm=new Tt,this.mControl=new Et,this.mEntity=new lt,this.mAudio=null,this.mDelay=new xt,window.moosnow=this,this.mData=new W,this.mSetting=new j,this.mEvent=new it,this.initPlatform(),this.initHttp(),this.initAd(),this.initUI(),this.initEntity()}return t.prototype.getAppPlatform=function(){return l.platform},t.prototype.initUI=function(){this.mUi=new ut},t.prototype.initEntity=function(){this.mEntity=new ct},t.prototype.initHttp=function(){l.platform==e.WX?this.mHttp=new H:l.platform==e.OPPO_ZS?this.mHttp=new tt:this.mHttp=new H},t.prototype.initPlatform=function(){l.platform==e.WX?this.mPlatform=new U:l.platform==e.OPPO?this.mPlatform=new V:l.platform==e.VIVO?this.mPlatform=new at:l.platform==e.OPPO_ZS?this.mPlatform=new J:l.platform==e.BYTEDANCE?this.mPlatform=new X:l.platform==e.QQ?this.mPlatform=new K:l.platform==e.BAIDU?this.mPlatform=new $:this.mPlatform=new R},t.prototype.initAd=function(){l.platform==e.WX||l.platform==e.PC||l.platform==e.BYTEDANCE?this.mAd=new G:l.platform==e.OPPO?this.mAd=new z:l.platform==e.OPPO_ZS?this.mAd=new Z:this.mAd=new M},Object.defineProperty(t.prototype,"platform",{get:function(){return this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ad",{get:function(){return this.mAd},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"http",{get:function(){return this.mHttp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.mData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resource",{get:function(){return this.mResource},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setting",{get:function(){return this.mSetting},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"event",{get:function(){return this.mEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ui",{get:function(){return this.mUi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"form",{get:function(){return this.mForm},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"control",{get:function(){return this.mControl},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entity",{get:function(){return this.mEntity},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audio",{get:function(){return this.mAudio},set:function(t){this.mAudio=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delay",{get:function(){return this.mDelay},enumerable:!0,configurable:!0}),t}())}();
