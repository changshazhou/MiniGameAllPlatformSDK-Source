var mx=function(){"use strict";var n=function(t,o){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(t,o)};function t(t,o){function e(){this.constructor=t}n(t,o),t.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}var c=function(){return(c=Object.assign||function(t){for(var o,e=1,n=arguments.length;e<n;e++)for(var i in o=arguments[e])Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);return t}).apply(this,arguments)};function l(){for(var t=0,o=0,e=arguments.length;o<e;o++)t+=arguments[o].length;for(var n=Array(t),i=0,o=0;o<e;o++)for(var r=arguments[o],a=0,s=r.length;a<s;a++,i++)n[i]=r[a];return n}var r,o,s=(e.randomNumBoth=function(t,o){var e=o-t,n=Math.random();return t+Math.round(n*e)},e.probabilitys=function(t){for(var o=0,e=l(t),n=0,i=0;i<e.length;i++)n+=e[i];if(100!=n)throw"所有概率值总和不等于100%";for(var r=new Array,i=0;i<e.length;i++){for(var a=e[i],s=0;s<a;s++)r.push(o);o++}return r[this.randomNumBoth(0,99)]},e);function e(){}(o=r=r||{})[o.WX=0]="WX",o[o.BYTEDANCE=1]="BYTEDANCE",o[o.OPPO=2]="OPPO",o[o.OPPO_ZS=3]="OPPO_ZS",o[o.BAIDU=4]="BAIDU",o[o.QQ=5]="QQ",o[o.PC=6]="PC",o[o.VIVO=7]="VIVO",o[o.UC=8]="UC",o[o.HW=9]="HW";var a="cc",h="Laya",i="",m=(d.titleCase=function(t){for(var o=t.toLowerCase().split(/\s+/),e=0;e<o.length;e++)o[e]=o[e].slice(0,1).toUpperCase()+o[e].slice(1);return o.join(" ")},d.numFixed=function(t,o){return parseFloat(parseFloat(t).toFixed(o))},d.parseMoney=function(t){return isNaN(t)?0:parseFloat(parseFloat(t).toFixed(2))},d.objKeySort=function(t){for(var o=Object.keys(t).sort(),e={},n=0;n<o.length;n++)e[o[n]]=t[o[n]];return e},d.isObject=function(t){var o=typeof t;return null!==t&&("object"==o||"function"==o)},d.object2Query=function(t){var o=[];for(var e in t)o.push(e+"="+t[e]);return o.join("&")},d.isFunction=function(t){return"function"==typeof t},d.isEmpty=function(t){if("object"!=typeof t)return null==t||"null"===t||"undefined"===t||""===t;var o;for(o in t)return!1;return!0},d.formatTime=function(t){return[t.getHours(),t.getMinutes()].map(this.formatNumber).join(":")},d.formatNumber=function(t){return(t=t.toString())[1]?t:"0"+t},d.copy=function(t,o){for(var e in t)o[e]=t[e]},d.randomNumBoth=function(t,o){var e=o-t,n=Math.random();return t+Math.round(n*e)},d.randomFloat=function(t,o){return t+Math.random()*o},d.randomToRatio=function(t,o,e){return this.randomNumBoth(t,o)<=e},d.generateUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)})},d.isNumber=function(t){return"number"==typeof t||"[object Number]"==Object.prototype.toString.call(t)},d.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},d.isString=function(t){return"[object String]"===Object.prototype.toString.call(t)},Object.defineProperty(d,"platform",{get:function(){if(this.mPlatform)return this.mPlatform;var t,o=window.moosnowConfig;return window.tt?this.mPlatform=r.BYTEDANCE:window.swan?this.mPlatform=r.BAIDU:window.qq?this.mPlatform=r.QQ:window.qg?window.qg&&window.qg.getSystemInfoSync?(t=window.qg.getSystemInfoSync(),console.log("平台判断",JSON.stringify(t)),t&&t.brand&&-1!=t.brand.toLocaleLowerCase().indexOf("vivo")?this.mPlatform=r.VIVO:o.oppo&&o.oppo.url&&-1!=o.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=r.OPPO_ZS:this.mPlatform=r.OPPO):o.oppo&&o.oppo.url&&-1!=o.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=r.OPPO_ZS:this.mPlatform=r.OPPO:window.uc?this.mPlatform=r.UC:window.hbs?this.mPlatform=r.HW:window.wx?this.mPlatform=r.WX:o.debug&&o[o.debug]?"wx"==o.debug?this.mPlatform=r.WX:"oppo"==o.debug?o.oppo&&o.oppo.url&&-1!=o.oppo.url.indexOf("platform.qwpo2018.com")?this.mPlatform=r.OPPO_ZS:this.mPlatform=r.OPPO:"bd"==o.debug?this.mPlatform=r.BAIDU:"byte"==o.debug?this.mPlatform=r.BYTEDANCE:"qq"==o.debug?this.mPlatform=r.QQ:"vivo"==o.debug?this.mPlatform=r.VIVO:"uc"==o.debug?this.mPlatform=r.UC:"hw"==o.debug?this.mPlatform=r.HW:this.mPlatform=r.PC:this.mPlatform=r.PC,this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(d,"isOnlyUI",{get:function(){return 1==window.onlyUI},enumerable:!0,configurable:!0}),Object.defineProperty(d,"isPC",{get:function(){return cc.sys.browserType===cc.sys.BROWSER_TYPE_CHROME},enumerable:!0,configurable:!0}),Object.defineProperty(d,"config",{get:function(){var t=window.moosnowConfig,o=d.platform==r.WX?t.wx:d.platform==r.OPPO||d.platform==r.OPPO_ZS?t.oppo:d.platform==r.VIVO?t.vivo:d.platform==r.QQ?t.qq:d.platform==r.BAIDU?t.bd:d.platform==r.BYTEDANCE?t.byte:d.platform==r.HW?t.hw:t.wx;return o},enumerable:!0,configurable:!0}),d.colorRGB2Hex=function(t){var o=t.split(",");return"#"+((1<<24)+(parseInt(o[0].split("(")[1])<<16)+(parseInt(o[1])<<8)+parseInt(o[2].split(")")[0])).toString(16).slice(1)},d.deepCopy=function(t){var o=Array.isArray(t)?[]:{};if(t&&"object"==typeof t)for(var e in t)t.hasOwnProperty(e)&&(t[e]&&"object"==typeof t[e]?o[e]=this.deepCopy(t[e]):o[e]=t[e]);return o},d.getEngine=function(){return window[a]?a:window[h]?h:i},d.popOpenAnim=function(t,o){if(this.getEngine()==a)return t.scale=.8,void t.runAction(cc.sequence(cc.scaleTo(.1,1.2,1.2),cc.scaleTo(.1,1,1),cc.callFunc(function(){o&&o()},this)));o()},d.popCloseAnim=function(t,o){if(this.getEngine()==a)return t.scale=1,void t.runAction(cc.sequence(cc.scaleTo(.1,0,0),cc.callFunc(function(){o&&o()},this)));o()},d.format=function(t){for(var o=[],e=1;e<arguments.length;e++)o[e-1]=arguments[e];if(void 0===t||null==t||""==t||"undefined"==t)return t;for(var n=0;n<o.length;n++){var i=new RegExp("\\{"+n+"\\}","gm");t=t.replace(i,o[n])}return t},d.formatMoney=function(t){return isNaN(t)&&(t=0),t<9999?parseInt(""+t):t<9999999?parseFloat(""+t/1e3).toFixed(2)+"K":t<9999999999?parseFloat(""+t/1e6).toFixed(2)+"M":t<9999999999999?parseFloat(""+t/1e9).toFixed(2)+"G":t<1e16?parseFloat(""+t/1e12).toFixed(2)+"T":t<1e19?parseFloat(""+t/1e15).toFixed(2)+"P":t<1e22?parseFloat(""+t/1e18).toFixed(2)+"E":parseFloat(""+t/1e21).toFixed(2)+"B"},d);function d(){}var p=(u.prototype.schedule=function(t,o){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var i=this,r=setInterval(function(){t&&t.apply.apply(t,l([i],e))},1e3*o,i);this.mIntervalArr[this.mScheduleIndex]={handle:r,callback:t},this.mScheduleIndex++},u.prototype.unschedule=function(t){for(var o in this.mIntervalArr)this.mIntervalArr[o].callback==t&&clearInterval(parseInt(this.mIntervalArr[o].handle))},u.prototype.scheduleOnce=function(t,o){var e=this,n=setTimeout(function(){clearTimeout(n),t&&t.apply(e)},1e3*o);this.mTimeoutArr[this.mScheduleIndex]={handle:n,callback:t},this.mScheduleIndex++},u.prototype.unscheduleOnce=function(t){for(var o in this.mTimeoutArr)this.mTimeoutArr[o].callback==t&&clearInterval(parseInt(this.mTimeoutArr[o].handle))},u.schedule=function(t,o){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var i=this,r=setInterval(function(){t&&t.apply.apply(t,l([i],e))},1e3*o,i);this.mIntervalArr[this.mScheduleIndex]={handle:r,callback:t},this.mScheduleIndex++},u.unschedule=function(t){for(var o in this.mIntervalArr)this.mIntervalArr[o].callback==t&&clearInterval(parseInt(this.mIntervalArr[o].handle))},u.scheduleOnce=function(t,o){var e=this,n=setTimeout(function(){clearTimeout(n),t&&t.apply(e)},1e3*o);this.mTimeoutArr[this.mScheduleIndex]={handle:n,callback:t},this.mScheduleIndex++},u.unscheduleOnce=function(t){for(var o in this.mTimeoutArr)this.mTimeoutArr[o].callback==t&&clearInterval(parseInt(this.mTimeoutArr[o].handle))},u.prototype.initProperty=function(t){for(var o in t)this.hasOwnProperty(o)&&(this[o]=t[o])},u.prototype.preload=function(t,o){o&&o()},u.prototype._findComponent=function(t,o){for(var e=null,n=0;n<t._components.length;n++){var i=t._components[n];if(i.willHide&&i.willShow){e=i;break}}return e},u.prototype._findComponentByName=function(t,o){return!!t&&(t.name==o||this._findComponentByName(t.$super,o))},u.mIntervalArr={},u.mTimeoutArr={},u.mScheduleIndex=0,u);function u(){this.moduleName="",this.mIntervalArr={},this.mTimeoutArr={},this.mScheduleIndex=0,this.mMaping={}}var f=(w.NONE=0,w.LEFT=1,w.RIGHT=2,w.CENTER=8,w);function w(){}var g=(v.NONE=16,v.TOP=32,v.CENTER=64,v.BOTTOM=128,v);function v(){}var y={END:"__video_end",NOTEND:"__video_not_end",ERR:"__video_error"},b=(C.VIBRATESWITCH_CHANGED="VIBRATESWITCH_CHANGED",C.SOUNDSWITCH_CHANGED="SOUNDSWITCH_CHANGED",C.MUSICSWITCH_CHANGED="MUSICSWITCH_CHANGED",C.ON_PLATFORM_SHOW="ON_PLATFORM_SHOW",C.ON_PLATFORM_HIDE="ON_PLATFORM_HIDE",C.ON_BANNER_ERROR="ON_BANNER_ERROR",C.ON_BANNER_HIDE="ON_BANNER_HIDE",C.ON_AD_SHOW="ON_AD_SHOW",C.AD_VIEW_CHANGE="AD_VIEW_CHANGE",C.AD_VIEW_REFRESH="AD_VIEW_REFRESH",C.COIN_CHANGED="COIN_CHANGED",C.RANDOWM_NAVIGATE="RANDOWM_NAVIGATE",C.COMPONENT_CHECKBOX_TOGGLE="COMPONENT_CHECKBOX_TOGGLE",C.PRIZE_BOX_UNLOCAK="PRIZE_BOX_UNLOCAK",C);function C(){}var N="隐藏banner",A="banner id 没有配置",S="显示BANNER",I="banner位置或大小被重新设置",_="跳转太频繁 >>>>>>>>>>>>>>>>>>>>>",T="跳转数据",k="设备信息",E="video id 没有配置",L="加载video成功回调",B="video关闭回调",O="video加载错误",F="加载原生广告成功",x="原生广告加载出错,使用新ID加载原生广告",R="原生广告加载出错，本次没有广告",D="原生广告ID已经用完，本次没有广告",P="点击了原生广告",M="上报原生广告",V="原生广告数据没有，回调Null",H="原生广告销毁",U="插屏广告ID为空，系统不加载",W="阿拉丁文件未引入",Q="版本过低 平台不支持",z=(j.NONE=0,j.LEFT=1,j.RIGHT=2,j.CENTER=8,j);function j(){}var G=(q.NONE=16,q.TOP=32,q.CENTER=64,q.BOTTOM=128,q);function q(){}var K,X=(t(Z,K=p),Z.prototype.getBannerId=function(t,o){void 0===t&&(t=0),void 0===o&&(o=!1);var e=m.config.bannerId;return e instanceof Array?o||t<0?e[s.randomNumBoth(0,e.length-1)]:e.length-1<t?(console.warn("banner id数组小于传入索引值，请检查代码"),null):e[t]:e},Z.prototype.getBlockId=function(t){void 0===t&&(t=0);var o=m.config.blockId;return o instanceof Array?o.length-1<t?(console.warn("block id数组小于传入索引值，请检查代码"),null):o[t]:o},Z.prototype.getVideoId=function(t){void 0===t&&(t=0);var o=m.config.videoId;return o instanceof Array?o.length-1<t?(console.warn("video id数组小于传入索引值，请检查代码"),null):o[t]:o},Object.defineProperty(Z.prototype,"bannerWidth",{get:function(){var t=this.getSystemInfoSync(),o=t.windowWidth;return t.windowHeight<t.windowWidth?this.mBannerWidth=o<300?o:300:this.mBannerWidth=o,this.mBannerWidth},set:function(t){this.mBannerWidth=t},enumerable:!0,configurable:!0}),Z.prototype.onEnable=function(){},Z.prototype.vibrateSwitch=function(t){this.vibrateOn=t},Z.prototype.initAppConfig=function(){this.moosnowConfig=m.config,this.interId=this.moosnowConfig.interId,this.boxId=this.moosnowConfig.boxId,this.nativeId=this.moosnowConfig.nativeId,console.log("moosnowConfig ",JSON.stringify(this.moosnowConfig))},Z.prototype.isIphoneXModel=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone x/.test(t.model.toLowerCase())}},Z.prototype.isIphone=function(){if(window[this.platformName]){var t=this.getSystemInfoSync();return!!/iphone/.test(t.model.toLowerCase())}},Z.prototype.isIphoneX=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),o=t.screenHeight,e=t.screenWidth/o;return e<=.5||2<=e}},Z.prototype.compareVersion=function(t,o){t=t.split("."),o=o.split(".");for(var e=Math.max(t.length,o.length);t.length<e;)t.push("0");for(;o.length<e;)o.push("0");for(var n=0;n<e;n++){var i=parseInt(t[n]),r=parseInt(o[n]);if(r<i)return 1;if(i<r)return-1}return 0},Z.prototype.supportVersion=function(t){var o=this.getSystemInfoSync().SDKVersion;return 0<=this.compareVersion(o,t)},Z.prototype.supportFunction=function(t){return!!window[this.platformName]&&!!window[this.platformName][t]},Z.prototype.checkVersion=function(t,o){null==this.versionRet?this._checkConfigVersion(o):o(this.versionRet)},Z.prototype._checkRemoteVersion=function(o){var e=this,t=this.baseUrl+"admin/wx_list/getAppConfig",n={appid:this.moosnowConfig.moosnowAppId};moosnow.http.request(t,n,"POST",function(t){e.versionRet=e.checkLog(t.data.version),o(e.versionRet)},function(){console.log("checkVersion fail")},function(){console.log("checkVersion complete")})},Z.prototype._checkConfigVersion=function(o){var e=this;moosnow.http.getAllConfig(function(t){t&&t.version?(e.versionRet=e.checkLog(t.version),o(e.versionRet)):e._checkRemoteVersion(o)})},Z.prototype.checkLog=function(t){var o=moosnow.platform.moosnowConfig.version,e=t!=o;return console.log("版本检查 后台版本"+t+" 配置文件版本"+o),console.log("获取广告开关：",e),e},Z.prototype.isSmallWidth=function(){if(window[this.platformName]){var t=this.getSystemInfoSync(),o=t.screenHeight;return t.screenWidth,o<667&&(console.log("高度不够",o),!0)}},Z.prototype.login=function(t,o){var e;m.isFunction(t)&&(""==(e=moosnow.data.getToken())&&(e=(e=m.generateUUID()).replace(/-/g,""),moosnow.data.setToken(e)),t(e))},Z.prototype.postMessage=function(t){window[this.platformName]&&window[this.platformName].getOpenDataContext&&window[this.platformName].getOpenDataContext().postMessage(t)},Z.prototype.navigate2Video=function(t){},Z.prototype.getClipboardData=function(o,e){window[this.platformName]&&window[this.platformName].getClipboardData&&window[this.platformName].getClipboardData({success:function(t){o&&o(t.data),console.log(""+t.data)},fail:function(t){e&&e(t),console.log("getClipboardData调用失败")}})},Z.prototype.setClipboardData=function(t,o,e){window[this.platformName]&&window[this.platformName].setClipboardData&&window[this.platformName].setClipboardData({data:t,success:function(t){o&&o(t),console.log("setClipboardData调用成功")},fail:function(t){e&&e(t),console.log("setClipboardData调用失败")}})},Z.prototype.navigate2Mini=function(t,o,e,n){var i,r,a,s,l;console.log(T,t),Date.now()-this.prevNavigate<300?console.log(_):(this.prevNavigate=Date.now(),window[this.platformName]?(i=this.getLaunchOption(),r=t.appid,a=t.path,s=(s=t.extraData)||{},l={position:t.position,appid:r,img:t.atlas||t.img,scene:i.scene,wxgamecid:i.query.wxgamecid},moosnow.http.point("打开跳转",l),window[this.platformName].navigateToMiniProgram({appId:r,path:a,extraData:s,success:function(){console.log("跳转参数",l),moosnow.http.point("跳转",l),o&&o()},fail:function(t){console.log("跳转失败 ",t," fail callback ",!!e),e&&e()},complete:function(){n&&n()}})):e&&e())},Z.prototype.updateProgram=function(){var o,e=this;window[this.platformName]&&"function"==typeof window[this.platformName].getUpdateManager&&((o=window[this.platformName].getUpdateManager()).onCheckForUpdate(function(t){}),o.onUpdateReady(function(t){e.showModal("发现新版本","新版本已经准备好，是否更新？","取消","更新",function(t){t&&o.applyUpdate()})}),o.onUpdateFailed(function(){}))},Z.prototype.vibrateShort=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateShort||window[this.platformName].vibrateShort())},Z.prototype.vibrateLong=function(){window[this.platformName]&&(window[this.platformName]&&!window[this.platformName].vibrateLong||window[this.platformName].vibrateLong())},Z.prototype.showLoading=function(t){window[this.platformName]?window[this.platformName].showLoading({title:t,mask:!1,success:null,fail:null,complete:null}):console.log("showLoading",t)},Z.prototype.hideLoading=function(){window[this.platformName]&&window[this.platformName].hideLoading()},Z.prototype.showModal=function(t,o,e,n,i){window[this.platformName]&&window[this.platformName].showModal({title:t,content:o,cancelText:e,confirmText:n,showCancel:!0,cancelColor:"#000000",confirmColor:"#3CC51F",fail:null,complete:null,success:function(t){t.confirm?i&&i(!0):t.cancel&&i&&i(!1)}})},Z.prototype.showModalWithoutCancel=function(t,o,e,n){window[this.platformName]&&window[this.platformName].showModal({title:t,content:o,showCancel:!1,confirmText:e,cancelColor:"#000000",confirmColor:"#3CC51F",cancelText:"",fail:null,complete:null,success:function(t){t.confirm?n&&n(!0):t.cancel&&n&&n(!1)}})},Z.prototype.showToast=function(t,o,e){void 0===o&&(o="none"),void 0===e&&(e=!1),window[this.platformName]&&window[this.platformName].showToast({title:t,icon:o,duration:2e3,mask:e,image:null,success:null,fail:null,complete:null})},Z.prototype.authOrGetUserInfo=function(o){var e;window[this.platformName]&&(e=this).getSetting(function(t){console.log("授权信息",t),t["scope.userInfo"]?e.getUserInfo(function(t){console.log("获取用户信息：",t),o(t,!1)},function(t){}):e.showUserInfoButton(function(t){o(t,!0),console.log("授权获取用户信息：",t)})},function(t){e.showUserInfoButton(function(t){o(t,!0),console.log("授权获取用户信息：",t)})})},Z.prototype.showUserInfoButton=function(o){var t={type:"text",text:"",style:this._initLoginButton()},e=window[this.platformName].createUserInfoButton(t);e.onTap(function(t){t.userInfo&&t.userInfo.nickName?(o(t.userInfo),e.hide()):o(null)}),e.show()},Z.prototype.getSetting=function(o,t){window[this.platformName].getSetting({success:function(t){o(t.authSetting)},fail:function(){t()},complete:null})},Z.prototype.getUserInfo=function(o,t){window[this.platformName].getUserInfo({success:function(t){o(t.userInfo)},fail:function(){t()},withCredentials:!1,complete:null,lang:"en"})},Z.prototype.getLaunchOption=function(){return window[this.platformName]&&window[this.platformName].getLaunchOptionsSync?window[this.platformName].getLaunchOptionsSync():{}},Z.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log(k,this.systemInfo)),this.systemInfo},Z.prototype.isLandscape=function(t,o){return t<o},Z.prototype.initShare=function(t){var o=this;window[this.platformName]&&window[this.platformName].showShareMenu&&(this.shareInfoArr=t,window[this.platformName].showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"],success:null,fail:null,complete:null}),window[this.platformName].onShareAppMessage&&window[this.platformName].onShareAppMessage(function(){return o._buildShareInfo()}),window[this.platformName].onShareTimeline&&window[this.platformName].onShareTimeline(function(){return o._buildShareInfo()}))},Z.prototype.getShareInfo=function(t,o,e){void 0===e&&(e=null),window[this.platformName]&&window[this.platformName].getShareInfo({shareTicket:t,success:function(t){o(t.encryptedData,t.iv)},fail:function(){e&&e()},complete:null})},Z.prototype.share=function(t,o,e){void 0===t&&(t={}),window[this.platformName]?(this.currentShareCallback=o,this.currentShortCall=e,this.share_clickTime=Date.now(),this.shareFail=!1,this._share(t)):o&&o(!0)},Z.prototype.shareWithoutCheck=function(t,o){void 0===t&&(t={}),window[this.platformName]||o&&o(!0),this.currentShareCallback=o,this.share_clickTime=1,this.shareFail=!1,this._share(t)},Z.prototype._share=function(t){var o;void 0===t&&(t=null),window[this.platformName]&&window[this.platformName].shareAppMessage?(o=this._buildShareInfo(t),console.log("分享数据：",o),window[this.platformName].shareAppMessage(o)):this.currentShareCallback(!0)},Z.prototype._buildShareInfo=function(t){void 0===t&&(t=null);var o,e="",n="";return 0<this.shareInfoArr.length&&(e=(o=this.shareInfoArr[s.randomNumBoth(0,this.shareInfoArr.length-1)]).title,n=o.img),{title:e,imageUrl:n,query:t}},Z.prototype._onShareback=function(){var t=this;setTimeout(function(){t.share_clickTime&&t.currentShareCallback&&(!t.shareFail&&(1==t.share_clickTime||3e3<=Date.now()-t.share_clickTime)?t.currentShareCallback(!0):t.currentShareCallback(!1)),t.shareFail=!1,t.currentShareCallback=null,t.share_clickTime=null},100)},Z.prototype._initLoginButton=function(){if(window[this.platformName]){var t=window[this.platformName].getSystemInfoSync();return{left:0,top:0,width:t.screenWidth,height:t.screenHeight,lineHeight:40,color:"#ffffff",type:"text",text:"获取用户信息",textAlign:"center",fontSize:28}}},Z.prototype.initRecord=function(){},Z.prototype.clipRecord=function(t,o){void 0===t&&(t=[2,2])},Z.prototype.startRecord=function(t,o){void 0===t&&(t=300),void 0===o&&(o=null),this.recordObj||o&&o(!1)},Z.prototype.stopRecord=function(t){void 0===t&&(t=null),this.recordObj||t&&t(!1)},Z.prototype.pauseRecord=function(){},Z.prototype.resumeRecord=function(){},Z.prototype.showShareButton=function(t,o,e){},Z.prototype.hideShareButton=function(){},Z.prototype._regisiterWXCallback=function(){window[this.platformName]&&(this._regisiterOnShow(),this._regisiterOnHide())},Z.prototype._regisiterOnShow=function(){var o;window[this.platformName].onShow&&window[(o=this).platformName].onShow(function(t){o._onShowCallback(t)})},Z.prototype._onShowCallback=function(t){this._onShareback(),console.log("on show ",t),moosnow.event.sendEventImmediately(b.ON_PLATFORM_SHOW,t)},Z.prototype._regisiterOnHide=function(){var o;window[this.platformName].onHide&&window[(o=this).platformName].onHide(function(t){o._onHideCallback(t)})},Z.prototype._onHideCallback=function(t){console.log("on show ",t),moosnow.event.sendEventImmediately(b.ON_PLATFORM_HIDE,t),console.log("on hide ",t);var o=t&&(8==t.targetAction||9==t.targetAction||10==t.targetAction)&&50<t.targetPagePath.length;o&&moosnow.http.clickBanner(),this.bannerCb?this.bannerCb(o):console.log("banner callback is null ")},Z.prototype.initBanner=function(){window[this.platformName]&&this._prepareBanner()},Z.prototype._prepareBanner=function(){},Z.prototype._createBannerAd=function(t){if(window[this.platformName]&&window[this.platformName].createBannerAd){var o=this.getBannerId(t);if(!m.isEmpty(o)){if(this.banner[o])return o;this.bannerShowTime=Date.now();var e=this._getBannerPosition();return console.log("🚀 ~ file: PlatformModule.ts ~ line 995 ~ PlatformModule ~ _createBannerAd ~ style",e),this.banner[o]||(this.banner[o]=window[this.platformName].createBannerAd({adUnitId:o,adIntervals:30,style:{top:e.top,left:e.left,width:this.bannerWidth}}),this.banner[o].isLoaded=!1,this.banner[o]&&(this.banner[o].onResize(this._onBannerResize.bind(this,o)),this.banner[o].onError(this._onBannerError.bind(this,o)),this.banner[o].onLoad(this._onBannerLoad.bind(this,o)))),o}console.warn(A)}},Z.prototype._onBannerLoad=function(t){console.log("🚀 ~ file: PlatformModule.ts ~ line 1043 ~ PlatformModule ~ _onBannerLoad ~ bannerId",t),this.bannerShowCount=0},Z.prototype._onBannerError=function(t,o){console.warn("banner___error:",o.errCode,o.errMsg),this.banner[t]=null,this.isBannerShow=!1,moosnow.event.sendEventImmediately(b.ON_BANNER_HIDE,null),moosnow.event.sendEventImmediately(b.ON_BANNER_ERROR,null)},Z.prototype._onBannerResize=function(t,o){console.log("_bottomCenterBanner -> size",o);var e=this.getSystemInfoSync().windowWidth;isNaN(this.banner[t].style.realWidth)||(this.bannerWidth=this.banner[t].style.realWidth),isNaN(this.banner[t].style.realHeight)||(this.bannerHeigth=this.banner[t].style.realHeight),console.log("_bottomCenterBanner -> this.banner.style",this.banner[t].style),this.bannerStyle?this.applyCustomStyle({banner:this.banner[t]}):this.banner[t].style.left=(e-o.width)/2},Z.prototype._resetBanenrStyle=function(t){var o;console.log("PlatformModule ~ _resetBanenrStyle ~ size",t),this.bannerStyle?this.applyCustomStyle(t):(o=this._getBannerPosition(),t.banner.style.top=o.top,t.banner.style.left=o.left,console.log(I,t.banner.style,"set top ",top))},Z.prototype.applyCustomStyle=function(t){for(var o in this.bannerStyle)t.banner.style[o]=this.bannerStyle[o]},Z.prototype._getBannerPosition=function(){var t=this.bannerHorizontal,o=this.bannerVertical,e=this.getSystemInfoSync(),n=e.windowWidth,i=e.windowHeight,r=0,a=0;return o==g.TOP?r=0:o==g.CENTER?r=(i-this.bannerHeigth)/2:o==g.BOTTOM&&(r=i-this.bannerHeigth),t==f.LEFT?a=0:t==f.RIGHT?a=n-this.bannerWidth:t==f.CENTER&&(a=(n-this.bannerWidth)/2),console.log("🚀 ~ file: PlatformModule.ts ~ line 1132 ~ PlatformModule ~ _getBannerPosition ~ left",a,r),{left:a,top:r}},Z.prototype.preloadBanner=function(t){void 0===t&&(t=-1),this.preloadBannerId=this._createBannerAd(t)},Z.prototype.showBanner=function(t,o,e,n,i,r){var a=this;void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=-1),console.log(S),this.bannerCb=o,window[this.platformName]&&(this.bannerHorizontal=e,this.bannerVertical=n,this.bannerStyle=r,this.hideBanner(),this.currentBannerId=this._createBannerAd(i),this.mTimeoutId&&(clearTimeout(this.mTimeoutId),this.mTimeoutId=null),t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),a._showBanner(i)):console.log("后台关闭了banner，不执行显示")}):this._showBanner(i))},Z.prototype._showBanner=function(t){var o,e=this,n=this.banner[this.getBannerId(t)];n&&(n.hide(),this._resetBanenrStyle({banner:n,width:n.style.width,height:n.style.realHeight}),(o=n.show())&&o.then(function(){e._resetBanenrStyle({banner:n,width:n.style.width,height:n.style.realHeight})}))},Z.prototype.showAutoBanner=function(e,n,i){var r=this;void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=-1),console.log("执行自动显示和隐藏Banner功能"),moosnow.http.getAllConfig(function(t){var o;t&&1==t.gameBanner?(r.showBanner(!0,function(){},e,n,i),o=isNaN(t.gameBanenrHideTime)?1:parseFloat(t.gameBanenrHideTime),r.mTimeoutId=setTimeout(function(){console.log("自动隐藏时间已到，开始隐藏Banner"),r.hideBanner()},1e3*o)):console.log("后台关闭了auto banner")})},Z.prototype.exitApplication=function(){},Z.prototype.showIntervalBanner=function(e,n){var i=this;void 0===e&&(e=z.NONE),void 0===n&&(n=G.NONE),console.log("执行 showIntervalBanner"),moosnow.http.getAllConfig(function(t){var o=t&&!isNaN(t.gameBannerInterval)?parseFloat(t.gameBannerInterval):20;i.schedule(i.showAutoBanner,o,[e,n])})},Z.prototype.clearIntervalBanner=function(){console.log("执行 clearIntervalBanner"),this.unschedule(this.showAutoBanner)},Z.prototype.hideBanner=function(){for(var t in console.log(" hideBanner ~ this.banner",this.banner),this.banner)t!=this.preloadBannerId?this.banner[t]&&(this.banner[t].hide(),this.banner[t].destroy(),this.banner[t]=null):this.banner[t]&&this.banner[t].hide()},Z.prototype.initVideo=function(){this.createRewardAD(!1)},Z.prototype.createRewardAD=function(t,o){var e=this;if(void 0===o&&(o=0),!this.videoLoading)if(window[this.platformName])if(window[this.platformName].createRewardedVideoAd){var n=this.getVideoId(o);if(m.isEmpty(n))return console.warn(E),void(moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END));if(!this.video[n]){if(this.video[n]=window[this.platformName].createRewardedVideoAd({adUnitId:n}),!this.video[n])return void console.warn("创建视频广告失败");this.video[n].onError(this._onVideoError),this.video[n].onClose(this._onVideoClose),this.video[n].onLoad(this._onVideoLoad)}moosnow.platform.videoLoading=!0,moosnow.platform.videoPlaying=!1,this.video[n].load().then(function(){t&&(moosnow.platform.videoPlaying=!0,e.video[n].show().then(function(){}).catch(function(t){e._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))}).catch(function(t){e._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}else moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END);else moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END)},Z.prototype._onVideoError=function(t,o){console.log(O,t,o),moosnow.platform.videoLoading=!1,moosnow.platform.videoPlaying=!1,moosnow.platform.videoCb&&(moosnow.platform.videoCb(y.ERR),moosnow.platform.videoCb=null)},Z.prototype._onVideoClose=function(t){var o;console.log(B,t.isEnded),moosnow.platform.videoLoading=!1,moosnow.platform.videoPlaying=!1,moosnow.event.sendEventImmediately(b.ON_PLATFORM_SHOW,null),t.isEnded&&moosnow.http.clickVideo(),moosnow.platform.videoCb&&(o=t.isEnded?y.END:y.NOTEND,setTimeout(function(){moosnow.platform.videoCb(o)},50))},Z.prototype._onVideoLoad=function(){console.log(L),moosnow.platform.videoLoading=!1},Z.prototype.showVideo=function(t,o){void 0===t&&(t=null),void 0===o&&(o=0),console.log("显示video"),moosnow.platform.videoCb=t,this.createRewardAD(!0,o)},Z.prototype.initInter=function(){this.prepareInter()},Z.prototype.prepareInter=function(){window[this.platformName]&&window[this.platformName].createInterstitialAd&&this.supportVersion("2.8.0")&&(m.isEmpty(this.interId)?console.warn(U):(this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this))))},Z.prototype.showInter=function(){this.inter&&this.isInterLoaded&&this.inter.show()},Z.prototype._onInterLoad=function(){this.interShowCount=0,this.isInterLoaded=!0,console.log("插屏广告加载完成")},Z.prototype._onInterClose=function(){this.interShowCount++,this.interShowCount>=this.interShowCountLimit&&(this.isInterLoaded=!1,this.inter.load())},Z.prototype._onInterError=function(t){console.log("插屏广告出错：",t)},Z.prototype._prepareNative=function(){},Z.prototype._onNativeLoad=function(t){},Z.prototype._onNativeError=function(t){},Z.prototype._destroyNative=function(){},Z.prototype.showNativeAd=function(t){m.isFunction(t)&&t()},Z.prototype.clickNative=function(t){},Z.prototype.showAppBox=function(t,o){void 0===o&&(o=!0),m.isFunction(t)&&t()},Z.prototype.hideAppBox=function(t){m.isFunction(t)&&t()},Z.prototype.reportMonitor=function(t,o){},Z.prototype.showMoreGameButton=function(t,o,e){void 0===e&&(e=null),o&&o()},Z.prototype.initRank=function(){this.postMessage({action:1})},Z.prototype.showRank=function(){this.postMessage({action:10})},Z.prototype.updateUserScore=function(t){var o={action:13,data:t};this.postMessage(o)},Z.prototype.hideRank=function(){this.postMessage({action:20})},Z.prototype.checkFollowAwemeSate=function(t,o){t&&t(!0)},Z.prototype.openAwemeUserProile=function(t,o){t&&t(!0)},Z.prototype.hasShortcutInstalled=function(t,o){t(!1)},Z.prototype.installShortcut=function(t,o,e){void 0===o&&(o="方便下次快速启动")},Z.prototype.showBlock=function(t,o,e,n){void 0===t&&(t=z.NONE),void 0===o&&(o=G.NONE),void 0===e&&(e=1),void 0===n&&(n=5)},Z.prototype.hideBlock=function(){},Z.prototype.hideExitButton=function(){var r=this;window[this.platformName]&&window[this.platformName].createVideo&&this.isIphone()&&(this.isLoaded||(this.isLoaded=!0,moosnow.http.getAllConfig(function(t){var o,e,n,i;t&&1==t.isBlockClose&&(e=(o=r.getSystemInfoSync()).screenWidth,n=o.screenHeight,i=window.wx.createVideo({x:0,y:0,width:e,height:n,src:"https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com/video/1.mp4",objectFit:"contain",controls:!1,autoplay:!0,showCenterPlayBtn:!1,enableProgressGesture:!1}),-1!=o.model.indexOf("iPhone")&&(console.log("苹果手机 播放视频"),i.requestFullScreen()),i.onEnded(function(t){i.destroy(),console.log("video.destroy")}))})))},Z.prototype.onDisable=function(){},Z);function Z(){var t=K.call(this)||this;return t.baseUrl="https://api.liteplay.com.cn/",t.currentShortCall=null,t.shareFail=null,t.vibrateOn=!1,t.systemInfo=null,t.block=null,t.banner={},t.video={},t.inter=null,t.native=null,t.box=null,t.platformName="wx",t.interId="",t.boxId="",t.nativeId=[],t.nativeIdIndex=0,t.mBannerWidth=300,t.bannerHeigth=96,t.bannerHorizontal=f.NONE,t.bannerVertical=g.NONE,t.bannerShowCount=0,t.bannerShowCountLimit=3,t.bannerShowTime=0,t.bannerShowTimeLimit=15,t.bannerLimitType=0,t.bannerCb=null,t.bannerStyle=null,t.isBannerShow=!1,t.blockWidth=300,t.blockHeigth=96,t.blockHorizontal=z.NONE,t.blockVertical=G.NONE,t.videoCb=null,t.videoLoading=!1,t.videoPlaying=!1,t.interShowCount=0,t.interShowCountLimit=3,t.isInterLoaded=!1,t.nativeAdResult=null,t.nativeCb=null,t.nativeLoading=!1,t.recordObj=null,t.shareInfoArr=[],t.versionRet=null,t.prevNavigate=Date.now(),t.preloadBannerId="",t.isLoaded=!1,t.initAppConfig(),t.initShare(!0),t.share_clickTime=null,t.currentShareCallback=null,t.shareFail=!1,t.updateProgram(),t.initRecord(),t}var Y,J=(t($,Y=X),$.prototype.login=function(o,t){moosnow.http.getAllConfig(function(t){});var e=this,n=moosnow.data.getToken();n?e.getUserToken("",n,o):window[this.platformName]&&window[this.platformName].login?window[this.platformName].login({success:function(t){t.code?e.getUserToken(t.code,"",o):m.isFunction(o)&&o()},fail:function(){}}):Y.prototype.login.call(this,o,t)},$.prototype.getUserToken=function(t,o,e){var n=this.getLaunchOption(),i=n.scene,r=n.query&&n.query.channel_id?n.query.channel_id:"0",a=n.referrerInfo&&n.referrerInfo.appId?n.referrerInfo.appId:"0";moosnow.data.setChannelAppId(a),moosnow.data.setChannelId(r);var s=n.referrerInfo?n.referrerInfo.appId:"未知";window[this.platformName]&&window[this.platformName].aldSendEvent&&window[this.platformName].aldSendEvent("来源",{origin:s,path:n.query.from||0}),moosnow.http.request(this.baseUrl+"api/channel/login.html",{appid:m.config.moosnowAppId,code:t,user_id:o,channel_id:r,channel_appid:a,scene:i,fromApp:s},"POST",function(t){console.log("WXModule -> getUserToken -> respone",t),0==t.code&&t.data&&t.data.user_id&&moosnow.data.setToken(t.data.user_id),m.isFunction(e)&&e(t)},function(){m.isFunction(e)&&e({})})},$.prototype.initRecord=function(){window[this.platformName]&&window[this.platformName].getGameRecorder&&(this.recordObj=window[this.platformName].getGameRecorder())},$.prototype.startRecord=function(t,o){var e=this;void 0===t&&(t=300),void 0===o&&(o=null),console.log("record startRecord"),this.recordObj?this.recordObj.start().then(function(t){e.recordObj.on("timeUpdate",function(t){console.log("视频时长: "+t.currentTime),e.writeTime=Math.min(t.currentTime,6e4)}),e.recordObj.on("start",function(){o&&o()}),e.recordObj.on("stop",function(t){console.log("对局回放时长: ",t),e.recordCb&&e.recordCb(t)})}):o&&o(!1)},$.prototype.stopRecord=function(t){var o,e=this;void 0===t&&(t=null),console.log(" stop Record  callback  ",!!t),this.recordObj?(this.recordCb=t,(o=this.recordObj.stop())&&o.then(function(t){t.error.code||e.recordObj.off("timeUpdate"),console.log(" stop Record  then  ",t)}).catch(function(t){console.log(" stop Record  catch  ",t)})):t&&t(!1)},$.prototype.pauseRecord=function(){this.recordObj&&this.recordObj.pause()},$.prototype.resumeRecord=function(){this.recordObj&&this.recordObj.resume()},$.prototype.showShareButton=function(o,e,n){var i=this;window[this.platformName]&&window[this.platformName].createGameRecorderShareButton&&(e=e||[[0,this.writeTime]],moosnow.http.getAllConfig(function(t){i.mShareButton=window[i.platformName].createGameRecorderShareButton({style:c(c({left:10,top:150,height:50},o),{color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,iconMarginRight:16,paddingLeft:1,paddingRight:30}),text:t.shareButtonText||"",image:t.shareBgImage||"",icon:t.shareIconImage||"",share:{query:"a=1&b=2",bgm:"",timeRange:e}}),i.mShareButton.show(),i.mShareButton.onTap(function(t){console.log("错误码："+t.error.code+"，错误信息："+t.error.message),n&&n(t)})}))},$.prototype.hideShareButton=function(){this.mShareButton&&this.mShareButton.hide()},$);function $(){var t=Y.call(this)||this;return t.platformName="wx",t.writeTime=0,t.recordCb=null,t._regisiterWXCallback(),t.initBanner(),t.initInter(),t}var tt,ot=(t(et,tt=p),et.prototype.getDistinctAd=function(t){for(var o=[],e=[],n=t.sort(function(t,o){return.5<Math.random()?1:-1}),i=0;i<n.length;i++){for(var r=n[i],a=!0,s=0;s<o.length;s++)if(o[s].appid==r.appid){a=!1;break}a?o.push(r):e.push(r)}return l(o,e)},et.prototype.getAd=function(i){var t,o,r=this,a=this.getCache();m.isEmpty(a.indexLeft)?this.getRemoteAd(function(t){var o=r.initRetValue();t.forEach(function(t){o=r.formatRow(o,t)}),r.setCache(o);var e=r.getDistinctAd(o.indexLeft),n=c(c({},a),{indexLeft:e});i(n)}):(t=this.getDistinctAd(a.indexLeft),o=c(c({},a),{indexLeft:t}),i(o))},et.prototype.getRemoteAd=function(t){t([])},et.prototype.loadCacheImage=function(t){var o=this;this.cacheImage?t(this.cacheImage):wx.getStorage({key:this.cacheKey,success:function(t){this.cacheImage=t.data,console.log("cacheKey data  ",t.data)},fail:function(){o.cacheImage={},console.log("cacheKey error ")},complete:function(){t(this.this.cacheImage)}})},et.prototype.initRetValue=function(){return{indexBanner:[],indexFloat:[],indexLeft:[],gameEndPage:[],gameRespawnPage:[],exportPage:[]}},et.prototype.formatRow=function(t,o){switch(o.position){case"1":t.indexLeft.push(o);break;case"2":t.indexFloat.push(o);break;case"3":t.indexBanner.push(o);break;case"4":t.gameEndPage.push(o);break;case"5":t.gameRespawnPage.push(o);break;case"6":t.exportPage.push(o);break;default:t.indexLeft.push(o)}return t},et.prototype.downloadImage=function(e,n){window.wx?wx.downloadFile({header:{},url:e,success:function(t){var o=this;200===t.statusCode&&wx.saveFile({tempFilePath:t.tempFilePath,success:function(t){o.cacheImage[""+e]=t.savedFilePath,n(t.savedFilePath)},fail:function(){n(e)},complete:function(){}})},fail:function(){n(e)},complete:function(){}}):n(e)},et);function et(){var t=tt.call(this)||this;return t.baseUrl="https://api.liteplay.com.cn/admin/",t.cacheImage=null,t.cacheKey="cacheUrl",t.getResUrl=function(t){for(var o in this.this.cacheImage)if(this.this.cacheImage[o]==t)return o;return""},t.convertToCacheUrl=function(t,o){this.cacheImage[t]?o(this.cacheImage[t]):this.downloadImage(t,function(t){o(t)})},t.saveCacheUrl=function(t){var o=[],e=window.wx.getFileSystemManager();for(var n in this.cacheImage){var i=!0;for(var r in t)for(var a=0;a<t[r].length;a++)t[r][a].atlas!=this.cacheImage[n]&&t[r][a].img!=this.cacheImage[n]||(i=!1);i&&o.push(n)}for(a=0;a<o.length;a++){if(o[a]){console.log("clear file ",o[a]);try{e.removeSavedFile(o[a])}catch(t){console.log("clear file error ",o[a])}}delete this.cacheImage[o[a]]}window.wx&&window.wx.setStorage({key:this.cacheKey,data:this.cacheImage,success:function(){},fail:function(){},complete:function(){}})},t.mMemory={},t.getCache=function(){return this.mMemory},t.setCache=function(t){this.mMemory=t},t}var nt,it="https://liteplay-1253992229.cos.ap-guangzhou.myqcloud.com",rt=(t(at,nt=p),Object.defineProperty(at.prototype,"appLaunchOptions",{get:function(){return this.mLaunchOptions||moosnow.platform&&moosnow.platform.getLaunchOption&&(this.mLaunchOptions=moosnow.platform.getLaunchOption()),this.mLaunchOptions},enumerable:!0,configurable:!0}),at.prototype.request=function(t,o,e,n,i,r){var a=t,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState){var o=s.responseText;if(200<=s.status&&s.status<400){var t={};try{t=JSON.parse(o)}catch(t){console.error("json parse error ",o),i&&i(t)}n&&n(t)}else console.warn("error ",o),i&&i(o)}},s.timeout=1e4,s.ontimeout=function(t){console.error("error ",t),i&&i(t)},"POST"==e?(s.open("POST",a),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(this._object2Query(o))):(s.open(e,a,!0),s.send())},at.prototype._object2Query=function(t){var o=[];for(var e in t)o.push(e+"="+t[e]);return o.join("&")},at.prototype.isDisableArea=function(t){},at.prototype.finishLoading=function(){this.point("加载完成",{time:Date.now()-this.instanceTime})},at.prototype.clickBanner=function(){},at.prototype.clickVideo=function(){},at.prototype.exportUser=function(){},at.prototype.postData=function(t){var o=moosnow.data.getToken();if(!m.isEmpty(o)&&"0"!=moosnow.data.getChannelId()&&"0"!=moosnow.data.getChannelAppId())try{this.request(""+this.baseUrl+t,{appid:m.config.moosnowAppId,user_id:o,channel_id:moosnow.data.getChannelId(),channel_appid:moosnow.data.getChannelAppId()},"POST",function(t){})}catch(t){console.log("postData error ",t)}},at.prototype.point=function(t,o){void 0===o&&(o=null),m.platform==r.WX?window.wx&&window.wx.aldSendEvent&&window.wx.aldSendEvent(t,o):m.platform==r.BYTEDANCE&&window.tt&&window.tt.reportAnalytics&&window.tt.reportAnalytics(t,o)},at.prototype.startGame=function(t){var o={stageId:""+t,stageName:""+t,userId:moosnow.data.getToken()};m.platform==r.WX?window.wx&&window.wx.aldStage?window.wx.aldStage.onStart(o):console.warn(W):m.platform==r.BYTEDANCE?this.point("startgame",o):console.log("startGame -> e",o)},at.prototype.endGame=function(t,o){var e=o?"complete":"fail",n=o?"关卡完成":"关卡失败",i={stageId:""+t,stageName:""+t,userId:moosnow.data.getToken(),event:e,params:{desc:n}};m.platform==r.WX?window.wx&&window.wx.aldStage?window.wx.aldStage.onEnd(i):console.warn(W):m.platform==r.BYTEDANCE?this.point(o?"gameEnd":"gameFail",{stageId:""+t,stageName:""+t,userId:moosnow.data.getToken()}):console.log("startGame -> e",i)},at.prototype.videoPoint=function(t,o,e){var n=0==t?"点击视频":"观看完成视频",i={info:o,level:e+""};m.platform==r.WX?this.point(n,i):m.platform==r.BYTEDANCE?this.point(0==t?"clickVideo":"endVideo",i):console.log("startGame -> e",i)},at.prototype.getAllConfig=function(n){var i=this;this.loadCfg(function(e){e.inWhite?n(c(c({},e),{exportAutoNavigate:1,isLimitArea:0})):i.loadArea(function(t){i.disableAd(e,t,function(t){var o=0;t?(1==e.exportAutoNavigate&&(o=0),2==e.exportAutoNavigate&&(o=1),n(c(c({isLimitArea:1},e),i.getCfg(!1)))):(1==e.exportAutoNavigate&&(o=1),2==e.exportAutoNavigate&&(o=1),n(c(c({},e),{exportAutoNavigate:o,isLimitArea:0})))})})})},at.prototype.getCfg=function(t){var o={checkBoxMistouch:0,checkBoxProbabilitys:[100,0,0,0,0],mistouchNum:0,mistouchPosNum:0,bannerShowCountLimit:1,exportBtnNavigate:0,exportAutoNavigate:0,delayShow:0,showAppBox:0,zs_native_click_switch:0,zs_jump_switch:0,mx_native_click_switch:0,mx_jump_switch:0,mistouchInterval:0,nativeErrorShowInter:0,bannerErrorShowInter:0,isStartMistouch:0,isStartVideo:0,loadingAdOn:0,isBlockClose:0};if(t)for(var e in o)isNaN(o[e])||(o[e]=1);return o},at.prototype.defaultCfg=function(t,o){var e=this.getCfg(!1);if(t){if(console.warn("defaultCfg -> moosnow.data.getToken()",moosnow.data.getToken()),console.warn("defaultCfg -> res.whitelist",t.whitelist),t.whitelist){var n=moosnow.data.getToken(),i=!1;if(""!=n)for(var r=0;r<t.whitelist.length;r++)if(n==t.whitelist[r]){i=!0;break}i&&(console.warn("白名单前 -> cfg",e),e=c(c({inWhite:i},e),this.getCfg(!0)),console.warn("白名单后 -> cfg",e))}o?(console.warn("使用后台数据前 -> cfg",e),e=c(c({},e),t),console.warn("使用后台数据后 -> cfg",e)):(console.warn("不使用后台数据前 -> cfg",e),e=c(c({},t),e),console.warn("不使用后台数据后 -> cfg",e))}return moosnow.platform&&t&&(isNaN(t.bannerShowCountLimit)||(moosnow.platform.bannerShowCountLimit=parseInt(t.bannerShowCountLimit)),isNaN(t.bannerLimitType)||(moosnow.platform.bannerLimitType=parseInt(t.bannerLimitType)),isNaN(t.bannerShowTimeLimit)||(moosnow.platform.bannerShowTimeLimit=parseInt(t.bannerShowTimeLimit))),e},at.prototype.loadCfg=function(t){var e=this;if(m.isEmpty(this.cfgData)){if(this._cfgQuene.push(t),1<this._cfgQuene.length)return;var o="",o=m.config.url?m.config.url+"?t="+Date.now():it+"/config/"+m.config.moosnowAppId+".json?t="+Date.now();this.request(o,{},"GET",function(t){var o;moosnow.platform.checkLog(t.version)?((o=!(!t||1!=t.mistouchOn))||console.log("总开关已关闭----------------",e.cfgData),e.cfgData=e.defaultCfg(t,o)):(e.cfgData=e.defaultCfg(t,!1),console.log("版本关闭----------------",e.cfgData)),e._cfgQuene.forEach(function(t){t(e.cfgData)}),e._cfgQuene=[]},function(){var o=e.defaultCfg(null,!1);e._cfgQuene.forEach(function(t){t(o)}),e._cfgQuene=[],console.log("load config json fail")})}else t(this.cfgData)},at.prototype.loadArea=function(t){var o=this;if(this.areaData)t(this.areaData);else{if(this._localQuene.push(t),1<this._localQuene.length)return;var e=this.baseUrl+"admin/wx_config/getLocation";this.request(e,{},"GET",function(t){o.areaData=t,o._localQuene.forEach(function(t){t(o.areaData)}),o._localQuene=[]},function(){o._localQuene.forEach(function(t){t(o.areaData)}),o._localQuene=[]})}},at.prototype.getForceExport=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disabledForceExport(o,t,function(t){e(t)})})})},at.prototype.disabledForceExport=function(t,o,e){var n=m.formatTime(new Date),i=!1;if(t.disabledForceExport)for(var r=0;r<t.disabledForceExport.length;r++){var a=t.disabledForceExport[r];if(-1!=o.data.city.indexOf(a)||-1!=o.data.province.indexOf(a)||-1!=o.data.area.indexOf(a)){i=!0;break}}i&&(!t.forceExportTime||2!=t.forceExportTime.length||n>t.forceExportTime[0]&&n<t.forceExportTime[1])?e(!0):e(!1)},at.prototype.getMisTouchNum=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disableAd(o,t,function(t){t?(e(0),console.log("getMisTouchNum",0,"disableAd",t)):(e(parseInt(o.mistouchNum)),console.log("getMisTouchNum",o.mistouchNum,"disableAd",t))})})})},at.prototype.getMistouchPosNum=function(e){var n=this;this.loadCfg(function(o){n.loadArea(function(t){n.disableAd(o,t,function(t){t?(e(0),console.log("getMistouchPosNum",0,"disableAd",t)):(e(parseInt(o.mistouchPosNum)),console.log("getMistouchPosNum",o.mistouchPosNum,"disableAd",t))})})})},at.prototype.getBannerShowCountLimit=function(o){this.loadCfg(function(t){isNaN(t.bannerShowCountLimit)?o(5):o(parseInt(t.bannerShowCountLimit))})},at.prototype.disableAd=function(t,o,e){var n=m.formatTime(new Date),i=!1;if(t&&t.disabledRegion)for(var r=0;r<t.disabledRegion.length;r++){var a=t.disabledRegion[r];if(o&&o.data&&(-1!=o.data.city.indexOf(a)||-1!=o.data.province.indexOf(a)||-1!=o.data.area.indexOf(a))){i=!0;break}}if(this.appLaunchOptions&&t&&(console.log("后台禁止场景 1 ",t.seachEntryScene),console.log("后台禁止场景 2 ",t.shareEntryScene),1==t.seachEntryOn&&t.seachEntryScene&&-1!=t.seachEntryScene.indexOf(this.appLaunchOptions.scene)||1==t.shareEntryOn&&t.shareEntryScene&&-1!=t.shareEntryScene.indexOf(this.appLaunchOptions.scene)))return e(!0),void console.log("后台禁止场景 ",this.appLaunchOptions.scene);i&&(!t.disabledTime||2!=t.disabledTime.length||n>t.disabledTime[0]&&n<t.disabledTime[1])?e(!0):e(!1)},at.prototype.getShareInfo=function(o){var t=this;this.request(it+"/share/"+m.config.moosnowAppId+".json",{appid:m.config.moosnowAppId},"GET",function(t){o(t),moosnow.platform.initShare(t)},function(){t.request(t.baseUrl+"admin/wx_share/getShare",{appid:m.config.moosnowAppId},"POST",function(t){console.log("分享数据",t.data),o(t.data),moosnow.platform.initShare(t.data)})})},at);function at(){var o=nt.call(this)||this;o.appid="",o.secret="",o.versionNumber="",o.version="2.1.0",o.baseUrl="https://api.liteplay.com.cn/",o.instanceTime=0,o.mLaunchOptions={},o.cfgData=null,o.areaData=null,o._cfgQuene=[],o._localQuene=[],o.instanceTime=Date.now();var t=it+"/SDK/version.json?t="+Date.now();return m.platform==r.PC?o.request(t,{},"GET",function(t){o.version<t.version&&(console.warn("您的SDK版本号["+o.version+"]不是最新版本，请尽快升级，最新版本["+t.version+"]  下载地址："+t.download),m.isEmpty(t.memo)||console.warn(""+t.memo))}):m.platform==r.WX&&window.wx&&o.request(t,{},"GET",function(t){var o=window.wx.aldVersion;(!o||o&&o<t.aldVersion)&&console.warn("阿拉丁文件错误，请重新下载"+t.aldUrl)}),o.getShareInfo(function(t){moosnow.platform.initShare(t)}),o.loadCfg(function(t){console.log("remote config ",t)}),o}var st,lt=(t(ct,st=X),Object.defineProperty(ct.prototype,"bannerWidth",{get:function(){var t=this.getSystemInfoSync(),o=t.windowWidth;return this.isLandscape(t.screenHeight,t.screenWidth)?this.mBannerWidth=o<760?o:760:this.mBannerWidth=o,this.mBannerWidth},set:function(t){this.mBannerWidth=t},enumerable:!0,configurable:!0}),ct.prototype.initAdService=function(){window[this.platformName]&&(window[this.platformName].initAdService?window[this.platformName].initAdService({isDebug:!0,appId:this.moosnowConfig.moosnowAppId,success:function(t){console.log("初始化广告")},fail:function(t){console.warn("初始化广告错误 "+t.code+"  "+t.msg)},complete:function(t){console.log("initAdService  complete")}}):console.log("初始化广告"),moosnow.event.addListener(b.ON_PLATFORM_SHOW,this,this.onAppShow))},ct.prototype.navigate2Mini=function(t,o,e,n){var i,r,a,s,l=this;console.log(T,t),Date.now()-this.prevNavigate<300?console.log(_):(this.prevNavigate=Date.now(),window[this.platformName]?(i=t.appid,r=t.path,s=t.extraData,a=t.pkgName,s=s||{},this.supportVersion(1044)?window[this.platformName].navigateToMiniGame({appId:i,path:r,pkgName:a||i,extraData:s,success:function(){window[l.platformName]&&window[l.platformName].aldSendEvent&&window[l.platformName].aldSendEvent("跳转",{position:t.position,appid:i,img:t.atlas||t.img}),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMiniProgram error ",t),e&&e()},complete:function(){n&&n()}}):console.log(Q)):o&&o())},ct.prototype.supportVersion=function(t){return this.getSystemInfoSync().platformVersion>=t},ct.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode," msg ",t.errMsg),this.banner&&(this.banner.hide(),this.banner.offResize(this._onBannerResize),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null)},ct.prototype._prepareBanner=function(){window[this.platformName].createBannerAd&&(this.hideBanner(),this.banner=this._createBannerAd(),this.banner.onResize(this._onBannerResize.bind(this)),this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)),this.banner.onHide(this._onBannerHide.bind(this)))},ct.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t={left:0,top:0,width:this.bannerWidth,height:this.bannerHeight},o=this._getBannerPosition(),e=c(c({},t),o),n=window[this.platformName].createBannerAd({adUnitId:this.getBannerId(),style:e});return console.log(" create banner ",n,"param style ",e),n}},ct.prototype._onBannerResize=function(t){console.log("_bottomCenterBanner  ",this.banner)},ct.prototype._getBannerPosition=function(){var t=this.getSystemInfoSync(),o=t.screenWidth,e=t.screenHeight,n=t.statusBarHeight,i=t.notchHeight||0,r=this.bannerHorizontal,a=this.bannerVertical,s=0,l=0;return a==g.TOP?s=n+i:a==g.CENTER?s=(e-this.bannerHeigth)/2:a==g.BOTTOM&&(s=e-this.bannerHeigth-16),r==f.LEFT?l=0:r==f.RIGHT?l=o-this.bannerWidth:r==f.CENTER&&(l=(o-this.bannerWidth)/2),console.log("OPPOModule -> _getBannerPosition -> left",l,"top",s),{left:l,top:s}},ct.prototype._resetBanenrStyle=function(t){var o=this._getBannerPosition();this.banner&&(this.banner.style={top:o.top,left:o.left,width:t.width,height:t.height}),console.log("_resetBanenrStyle this.banner ",this.banner,"set style ",o)},ct.prototype._onBannerHide=function(){console.log("banner 已隐藏 ")},ct.prototype.showBanner=function(t,o,e,n,i,r){var a=this;void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=0),console.log(S),this.bannerCb=o,window[this.platformName]&&(this.bannerHorizontal=e,this.bannerVertical=n,this.bannerStyle=r,t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),a._showBanner()):console.log("后台关闭了banner，不执行显示")}):this._showBanner())},ct.prototype._showBanner=function(){var t;this._prepareBanner(),!this.banner||(t=this.banner.show())&&t.then(function(){console.log("显示成功后")})},ct.prototype.hideBanner=function(){console.log(N),window[this.platformName]&&this.banner&&this.banner.hide&&(this.banner.hide(),this.banner.offResize(this._onBannerResize),this.banner.offError(this._onBannerError),this.banner.offLoad(this._onBannerLoad),this.banner.offHide(),this.banner.destroy(),this.banner=null)},ct.prototype.createRewardAD=function(t){if(!moosnow.platform.videoLoading)if(window[this.platformName]){if(window[this.platformName].createRewardedVideoAd){if(this.video)this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad);else{if(m.isEmpty(this.getVideoId()))return void console.warn(E);this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.getVideoId()})}this.video.onError(this._onVideoError.bind(this)),this.video.onClose(this._onVideoClose.bind(this)),this.video.onLoad(this._onVideoLoad.bind(this)),moosnow.platform.videoLoading=!0,this.video.load()}}else moosnow.platform.videoCb(y.END)},ct.prototype._onVideoLoad=function(){console.log(L),moosnow.platform.videoLoading=!1,this.video&&this.video.show()},ct.prototype.prepareInter=function(){if(m.isEmpty(this.interId))console.warn(U);else if(window[this.platformName])if(this.supportVersion("1061")){if("function"!=typeof window[this.platformName].createInterstitialAd)return;this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.load()}else{if("function"!=typeof window[this.platformName].createInsertAd)return;this.inter=window[this.platformName].createInsertAd({adUnitId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onShow(this._onInterOnShow.bind(this)),this.inter.load()}},ct.prototype.showInter=function(){this.inter?this.inter.show():this.interLoadedShow=!0},ct.prototype._onInterLoad=function(){this.interLoadedShow&&(this.inter?this.inter.show():this.interLoadedShow=!1)},ct.prototype._onInterOnShow=function(){this.inter&&this.inter.load()},ct.prototype.showAutoBanner=function(){console.log(" oppo 不支持自动")},ct.prototype.reportMonitor=function(t,o){window[this.platformName]&&window[this.platformName].reportMonitor&&window[this.platformName].reportMonitor("game_scene",0)},ct.prototype._prepareNative=function(){window[this.platformName]&&"function"==typeof window[this.platformName].createNativeAd&&(this.native=window[this.platformName].createNativeAd({adUnitId:parseInt(""+this.nativeId[this.nativeIdIndex])}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this)),this.nativeLoading=!0)},ct.prototype._onNativeLoad=function(t){this.nativeLoading=!1,console.log(F,t),t&&t.adList&&0<t.adList.length?(this.nativeAdResult=t.adList[0],m.isEmpty(this.nativeAdResult.adId)||(console.log(M),this.native.reportAdShow({adId:this.nativeAdResult.adId})),m.isFunction(this.nativeCb)&&this.nativeCb(m.deepCopy(this.nativeAdResult))):(console.log(V),m.isFunction(this.nativeCb)&&this.nativeCb(null))},ct.prototype._onNativeError=function(t){this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log(x,t),this.nativeIdIndex+=1,this._destroyNative(),this._prepareNative(),this.nativeCb(null)):(console.log(D),this.nativeIdIndex=0,m.isFunction(this.nativeCb)&&this.nativeCb(null)):(console.log(R,t),m.isFunction(this.nativeCb)&&this.nativeCb(null))},ct.prototype._destroyNative=function(){this.nativeLoading=!1,this.native.offLoad(),this.native.offError(),this.native.destroy(),console.log(H)},ct.prototype.showNativeAd=function(t){this.nativeCb=t,this.native&&this.native.load()},ct.prototype.clickNative=function(t){this.nativeAdResult&&!m.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log(D,this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},ct.prototype.onAppShow=function(){this.mIsClickedNative&&(this.mIsClickedNative=!1,m.isFunction(this.mClickedNativeCallback)&&this.mClickedNativeCallback())},ct.prototype.hasShortcutInstalled=function(o,e){window[this.platformName]&&window[this.platformName].hasShortcutInstalled&&window[this.platformName].hasShortcutInstalled({success:function(t){o&&o(!!t),t?console.log("已创建"):console.log("未创建")},fail:function(t){e&&e(t)}})},ct.prototype.installShortcut=function(o,t,e){void 0===t&&(t="方便下次快速启动"),window[this.platformName]&&window[this.platformName].installShortcut&&window[this.platformName].installShortcut({message:t,success:function(t){o&&o(t),console.log("创建成功")},fail:function(t){e&&e(t)}})},ct.prototype.exitApplication=function(){window[this.platformName]&&window[this.platformName].exitApplication&&window[this.platformName].exitApplication()},ct);function ct(){var t=st.call(this)||this;return t.platformName="qg",t.appSid="",t.bannerHeight=96,t.mBannerWidth=760,t.interLoadedShow=!1,t.prevNavigate=Date.now(),t.mIsClickedNative=!1,t._regisiterWXCallback(),t.initAdService(),t}var ht,dt=(t(pt,ht=p),pt.prototype.initCoin=function(t){null==moosnow.setting._getValue(this.COIN,null)&&moosnow.setting.setValue(this.COIN,t)},pt.prototype.getCoin=function(){return 0==this.mCoin&&(this.mCoin=moosnow.setting.getInt(this.COIN,0)),this.mCoin},pt.prototype.subCoin=function(t){this.mCoin-=t,moosnow.event.sendEventImmediately(b.COIN_CHANGED,this.mCoin)},pt.prototype.addCoin=function(t){this.mCoin+=t,moosnow.event.sendEventImmediately(b.COIN_CHANGED,this.mCoin)},pt.prototype.setCoin=function(t){this.mCoin=t,moosnow.event.sendEventImmediately(b.COIN_CHANGED,this.mCoin)},pt.prototype.saveCoin=function(){moosnow.setting.setValue(this.COIN,this.mCoin)},pt.prototype.getToken=function(){return m.isEmpty(this.mUserToken)&&(this.mUserToken=moosnow.setting.getString(this.TOKEN,"")),this.mUserToken},pt.prototype.setToken=function(t){moosnow.setting.setValue(this.TOKEN,t)},pt.prototype.getCurrentMisTouchCount=function(){return this.mCurrentMisTouchCount},pt.prototype.setCurrentMisTouchCount=function(t){this.mCurrentMisTouchCount=t},pt.prototype.getChannelId=function(){return this.mChannel_id},pt.prototype.setChannelId=function(t){this.mChannel_id=t},pt.prototype.getChannelAppId=function(){return this.mChannel_appid},pt.prototype.setChannelAppId=function(t){this.mChannel_appid=t},pt.prototype.getVibrateSetting=function(){return moosnow.setting.getBool(this.VIBRATE_SWITCH,!0)},pt.prototype.setVibrateSetting=function(t){moosnow.setting.setBool(this.VIBRATE_SWITCH,t),moosnow.event.sendEventImmediately(b.VIBRATESWITCH_CHANGED,t)},pt.prototype.getPrizeBox=function(){return this.mPrizeBox||(this.mPrizeBox={}),this.mPrizeBox},pt.prototype.clearPrizeBox=function(){this.mPrizeBox={}},pt.prototype.lockPrizeBox=function(t,o,e){void 0===e&&(e=0);var n=this.getPrizeBox();n[t]={prizeId:t,type:0==o?0:1,coinNum:e},this.mPrizeBox=n},pt.prototype.getUserPrizeBoxById=function(t){return this.getPrizeBox()[t]},pt.prototype.getPrizeKey=function(){return null==this.mPrizeKey&&(this.mPrizeKey=3),this.mPrizeKey},pt.prototype.addPrizeKey=function(t){this.mPrizeKey+=t},pt.prototype.clearPrizeKey=function(){this.mPrizeKey=null,moosnow.setting.setValue(this.USER_PRIZE_KEY,"")},pt);function pt(){var t=null!==ht&&ht.apply(this,arguments)||this;return t.TOKEN="MOOSNOW_SDK_TOKEN",t.COIN="MOOSNOW_SDK_COIN",t.mUserToken="",t.VIBRATE_SWITCH="MOOSNOW_VIBRATE_SWITCH",t.USER_PRIZE_KEY="MOOSNOW_USER_PRIZE_KEY",t.mCoin=0,t.mCurrentMisTouchCount=0,t.mChannel_id="0",t.mChannel_appid="0",t}var mt,ut=(t(ft,mt=p),ft.prototype.onEnable=function(){},ft.prototype.getInt=function(t,o){var e=this._getValue(t,o);return parseInt(e)},ft.prototype.getFloat=function(t,o){var e=this._getValue(t,o);return parseFloat(e)},ft.prototype.getBool=function(t,o){var e=1==o?"true":"false";return"true"==this.getString(t,e)},ft.prototype.getString=function(t,o){return this._getValue(t,o)},ft.prototype.getObject=function(t,o){var e=this._getValue(t,o);return e&&""!=e?JSON.parse(e):null},ft.prototype.setObject=function(t,o){var e="";o&&(e=JSON.stringify(o)),this.setValue(t,e)},ft.prototype.setBool=function(t,o){1==o?this.setValue(t,"true"):this.setValue(t,"false")},ft.prototype.setValue=function(t,o){window.localStorage.setItem(t,o)},ft.prototype.appendInt=function(t,o){var e=this.getInt(t,0),n=parseInt(o)+e;return this.setValue(t,n),n},ft.prototype.appendFloat=function(t,o){var e=this.getFloat(t,0),n=parseFloat(o)+e;this.setValue(t,n)},ft.prototype.removeValueOfKey=function(t){window.cc&&window.cc.sys&&window.cc.sys.localStorage?window.cc.sys.localStorage.removeItem(t):window.Laya&&window.Laya.LocalStorage?window.Laya.LocalStorage.removeItem(t):window.localStorage.removeItem(t)},ft.prototype.removeAll=function(){window.cc&&window.cc.sys&&window.cc.sys.localStorage||(window.Laya&&window.Laya.LocalStorage?Laya.LocalStorage.clear():window.localStorage.clear())},ft.prototype._getValue=function(t,o){var e="";return null!=(e=window.cc&&window.cc.sys&&window.cc.sys.localStorage?window.cc.sys.localStorage.getItem(t):window.Laya&&window.Laya.LocalStorage?window.Laya.LocalStorage.getItem(t):window.localStorage.getItem(t))&&""!=e||(e=o),e},ft);function ft(){return mt.call(this)||this}var wt,gt=(t(vt,wt=ot),vt.prototype.getRemoteAd=function(o){var t=this,e=it+"/exportConfig/"+m.config.moosnowAppId+".json?t="+Date.now();moosnow.http.request(e,{},"GET",function(t){o(t),console.log("WXAdModule getRemoteAd",t)},function(){wt.prototype.getRemoteAd.call(t,o),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},vt);function vt(){return null!==wt&&wt.apply(this,arguments)||this}var yt,bt=(t(Ct,yt=ot),Ct.prototype.getRemoteAd=function(o){var e=this,t=it+"/exportConfig/"+m.config.moosnowAppId+".json?t="+Date.now();moosnow.http.request(t,{},"GET",function(t){o(t),console.log("WXAdModule getRemoteAd",t)},function(t){e.mErrorNum++,e.mErrorNum<4?e.getRemoteAd(o):(e.mErrorNum=0,e.repairAd(o)),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},Ct.prototype.repairAd=function(o){var t=this.baseUrl+"wx_export/getExport",e={appid:m.config.moosnowAppId};moosnow.http.request(t,e,"POST",function(t){t.data.sort(function(){return.5<Math.random()?1:-1}),o&&o(t.data)},function(){o([]),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},Ct);function Ct(){var t=null!==yt&&yt.apply(this,arguments)||this;return t.mErrorNum=0,t}var Nt,At={ARTICLE:"article",VIDEO:"video",TOKEN:"token",LINK:""},St=function(){},It=(t(_t,Nt=X),Object.defineProperty(_t.prototype,"bannerWidth",{get:function(){return this.mBannerWidth},set:function(t){this.mBannerWidth=t},enumerable:!0,configurable:!0}),_t.prototype._registerTTCallback=function(){var o=this;window[this.platformName]&&(window[this.platformName].onMoreGamesModalClose&&window[this.platformName].onMoreGamesModalClose(function(t){console.log("modal closed",t),o.moreGameCb&&o.moreGameCb(0)}),window[this.platformName].onNavigateToMiniGameBox?window[this.platformName].onNavigateToMiniGameBox(function(t){console.log("onNavigateToMiniGameBox",t)}):window[this.platformName].onNavigateToMiniProgram&&window[this.platformName].onNavigateToMiniProgram(function(t){console.log("onNavigateToMiniProgram",t)}))},_t.prototype.showInter=function(){var t,o=this;window[this.platformName]&&window[this.platformName].createInterstitialAd&&(m.isEmpty(this.interId)?console.warn(U):(this.inter&&this.inter.destroy(),this.inter=window[this.platformName].createInterstitialAd({adUnitId:this.interId}),(t=this.inter.load())&&t.then(function(){o.inter.show()}).catch(function(t){console.log(t)})))},_t.prototype._onBannerResize=function(t,o){var e=this.getSystemInfoSync();e.windowWidth,e.windowHeight;this.bannerWidth=o.width,this.bannerHeigth=isNaN(o.height)?this.bannerWidth/16*9:o.height,this.bannerHeigth;var n=this._getBannerPosition();this.banner[t]&&(this.banner[t].style.top=n.top,this.banner[t].style.left=n.left)},_t.prototype.initRecord=function(){window[this.platformName]&&window[this.platformName].getGameRecorderManager&&(this.recordObj=window[this.platformName].getGameRecorderManager())},_t.prototype.clipRecord=function(t,o){void 0===t&&(t=[2,2]),this.recordObj&&(this.recordNumber++,console.log("clipRecord",this.recordNumber),this.recordObj.recordClip({timeRange:t,success:function(t){console.log("clipRecord 成功 ",t),m.isFunction(o)&&o(t)}}))},_t.prototype.startRecord=function(t,o){var e=this;void 0===t&&(t=300),void 0===o&&(o=null),console.log("record startRecord"),this.recordObj?(this.recordNumber=0,this.recordCb=null,this.recordRes=null,this.recordObj.onStart(function(t){console.log("record onStart"),o&&o(t)}),this.recordRes,this.recordObj.onStop(function(t){console.log("on stop ",t),1<=e.recordNumber?e.recordObj.clipVideo({path:t.videoPath,success:function(t){console.log("record clip succes:",t),e.recordRes=t,console.log("record clip recordRes :",e.recordRes),e.recordCb&&e.recordCb(t)},fail:function(){console.log("record clip fail:",t),e.recordRes=t,e.recordCb&&e.recordCb(t)}}):(e.recordRes=t,e.recordCb&&e.recordCb(t))}),this.recordObj.start({duration:t})):o&&o(!1)},_t.prototype.stopRecord=function(t){void 0===t&&(t=null),console.log(" stop Record  callback  ",!!t),this.recordObj?(console.log("record stop recordRes ",this.recordRes),this.recordRes?m.isFunction(t)&&t(this.recordRes):(this.recordCb=t,this.recordObj.stop(),console.log("record stop  ",this.recordRes))):t&&t(!1)},_t.prototype.pauseRecord=function(){this.recordObj&&this.recordObj.pause()},_t.prototype.resumeRecord=function(){this.recordObj&&this.recordObj.resume()},_t.prototype.share=function(t,o,e){void 0===t&&(t={}),this.currentShareCallback=o,this.currentShortCall=e,console.log("是否有回调：",e);var n=this._buildShareInfo(t);console.log("shareInfo:",n),window[this.platformName]&&window[this.platformName].shareAppMessage?window[this.platformName].shareAppMessage(n):this.currentShareCallback(!0)},_t.prototype._buildShareInfo=function(t){var o,e=this,n="",i="";0<this.shareInfoArr.length&&(n=(o=this.shareInfoArr[s.randomNumBoth(0,this.shareInfoArr.length-1)]).title,i=o.img);var r=At.LINK;t&&-1!=[At.LINK,At.ARTICLE,At.TOKEN,At.VIDEO].indexOf(t.channel)&&(r=t.channel);var a=this.recordRes&&this.recordRes.videoPath?this.recordRes.videoPath:"";return console.log("video path ",a),{channel:r,title:n,imageUrl:i,query:moosnow.http._object2Query(t),extra:{videoPath:a,videoTopics:[n],withVideoId:!0},success:function(t){console.log("share video success :",t),e.shareVideoId=t.videoId,e.currentShareCallback&&e.currentShareCallback(!0)},fail:function(t){if(console.log("share video fail ",t),console.log("index of : ",t.errMsg.indexOf("short")),t&&t.errMsg&&-1!=t.errMsg.indexOf("short")&&e.currentShortCall)return console.log("时间太短 执行回调",e.currentShortCall.toString()),void e.currentShortCall(t);e.currentShareCallback&&e.currentShareCallback(!1)}}},_t.prototype.navigate2Video=function(t){window[this.platformName]&&window[this.platformName].navigateToVideoView&&(console.log("navigate2Video id ",t||this.shareVideoId,t,this.shareVideoId),(t||this.shareVideoId)&&window[this.platformName].navigateToVideoView({videoId:t||this.shareVideoId,success:function(t){console.log("navigate2Video success ",t)},fail:function(t){console.log("navigate2Video err ",t),t.errCode}}))},_t.prototype._onBannerLoad=function(t){this.banner[t]&&!this.banner[t].isLoaded&&(this.banner[t].isLoaded=!0,this.banner[t].show())},_t.prototype._prepareBanner=function(){Nt.prototype._prepareBanner.call(this)},_t.prototype.showBanner=function(t,o,e,n,i,r){var a=this;void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=0),console.log(S),this.bannerCb=o,window[this.platformName]&&(this.bannerHorizontal=e,this.bannerVertical=n,this.bannerStyle=r,this.currentBannerId=this._createBannerAd(i),t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),a._showBanner(i)):console.log("后台关闭了banner，不执行显示")}):this._showBanner(i))},_t.prototype._showBanner=function(t){var o,e=this,n=this.banner[this.getBannerId(t)];n&&(n.hide(),this._resetBanenrStyle({banner:n,width:n.style.width,height:n.style.realHeight}),!n.isLoaded||(o=n.show())&&o.then(function(){e._resetBanenrStyle({banner:n,width:n.style.width,height:n.style.realHeight})}))},_t.prototype._resetBanenrStyle=function(t){var o;console.log("🚀 ~ file: TTModule.ts ~ line 376 ~ TTModule ~ _resetBanenrStyle ~ e",t),this.bannerStyle?this.applyCustomStyle(t):(o=this._getBannerPosition(),console.log("🚀 ~ file: TTModule.ts ~ line 384 ~ TTModule ~ _resetBanenrStyle ~ style",o),t.banner.style.top=o.top,t.banner.style.left=o.left)},_t.prototype.showAppBox=function(t,o){var e=this;void 0===o&&(o=!0),this.moreGameCb=t,window[this.platformName]&&window[this.platformName].showMoreGamesModal&&moosnow.http.getAllConfig(function(t){(!o||t&&1==t.showAppBox)&&e._showMoreGamesModal()})},_t.prototype._getAppLaunchOptions=function(o){var e=[];moosnow.ad.getAd(function(t){0!=t.indexLeft.length&&(t.indexLeft.forEach(function(t){var o=new St;o.appId=t.appid,o.query=t.path||"1=1",o.extraData=t.extraData||{},e.push(o)}),console.log("appLaunchOptions",e),o(e))})},_t.prototype._showMoreGamesModal=function(){var o=this;"ios"!=this.getSystemInfoSync().platform&&this._getAppLaunchOptions(function(t){console.log("_showMoreGamesModal appLaunchOption",t),window[o.platformName].showMoreGamesModal({appLaunchOptions:t,success:function(t){console.log("show app box success",t)},fail:function(t){console.log("show app box fail",t)}})})},_t.prototype.showMoreGameBanner=function(){var t,e,o;window[this.platformName]&&(!window[this.platformName].createMoreGamesBanner||"ios"!=(t=this.getSystemInfoSync()).platform&&"ios"!==t.platform&&(e=[],moosnow.ad.getAd(function(t){0!=t.indexLeft.length&&t.indexLeft.forEach(function(t){var o=new St;o.appId=t.appid,o.query=t.path||"1=1",o.extraData=t.extraData||{},e.push(o)})}),(o=window[this.platformName].createMoreGamesBanner({style:{left:20,top:0,width:150,height:40},appLaunchOptions:e,success:function(t){console.log("show app box success",t.errMsg)},fail:function(t){console.log("show app box fail",t.errMsg)}})).show(),o.onTap(function(){console.log("点击跳转游戏盒子")})))},_t.prototype.showMoreGameButton=function(t,n,o){var e,i,r=this;void 0===o&&(o=null),window[this.platformName]&&window[this.platformName].createMoreGamesButton&&(e={left:this.getSystemInfoSync().windowWidth-80-30,top:40,width:80,height:80,lineHeight:80,backgroundColor:"#ff0000",textColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:0,borderWidth:1,borderColor:"#ff0000"},i=c(c({},e),o),this._moreGameBotton?this._moreGameBotton.show():this._getAppLaunchOptions(function(e){cc.loader.loadRes("texture/game/more.png",cc.Texture2D,function(t,o){t||(r._moreGameBotton=window[r.platformName].createMoreGamesButton({type:"image",image:o.url,actionType:"box",style:i,appLaunchOptions:e,onNavigateToMiniGame:function(t){console.log("跳转其他小游戏",t),n&&n(1,t)}}),r._moreGameBotton.show(),r._moreGameBotton.onTap(function(){console.log("点击更多游戏"),n&&n(2,null)}))})}))},_t.prototype.hideMoreGameButton=function(){this._moreGameBotton&&this._moreGameBotton.hide()},_t.prototype.isIphone=function(){return!!window[this.platformName]&&"ios"==this.getSystemInfoSync().platform},_t.prototype.navigate2Mini=function(t,o,e,n){console.log("tt navigate2Mini "),this.showAppBox(function(){console.log("tt showAppBox close ")},!1)},_t.prototype.checkFollowAwemeSate=function(e,o){window[this.platformName]&&window[this.platformName].checkFollowAwemeState?window[this.platformName].checkFollowAwemeState({success:function(t){console.log("---- check success, res:",t);var o=t.hasFollowed;e(o)},fail:function(t){o(t)},complete:function(t){}}):e(!0)},_t.prototype.openAwemeUserProile=function(e,o){window[this.platformName]&&window[this.platformName].openAwemeUserProfile?window[this.platformName].openAwemeUserProfile({success:function(t){console.log("---- open success, res: ",t);var o=t.hasFollowed;e(o)},fail:function(t){o(t)},complete:function(t){}}):e(!0)},_t);function _t(){var t=Nt.call(this)||this;return t.platformName="tt",t.recordRes=null,t.recordCb=null,t.recordNumber=0,t.moreGameCb=null,t._regisiterWXCallback(),t._registerTTCallback(),t.initRecord(),t}var Tt,kt=(t(Et,Tt=X),Object.defineProperty(Et.prototype,"bannerWidth",{get:function(){var t=this.getSystemInfoSync(),o=t.windowWidth;return this.isLandscape(t.screenHeight,t.screenWidth)?this.mBannerWidth=o<320?o:320:this.mBannerWidth=o,this.mBannerWidth},set:function(t){this.mBannerWidth=t},enumerable:!0,configurable:!0}),Et.prototype._createBannerAd=function(t,o){if(void 0===o&&(o=!0),window[this.platformName]&&window[this.platformName].createBannerAd){var e=this.getBannerId(t);if(!m.isEmpty(e)){var n=this.bannerHeigth=Math.round(320/300*72.8071),i=this._getBannerPosition(),r={top:i.top,left:i.left,width:320,height:n};return this.hideBanner(),console.log(" QQModule ~ _createBannerAd ~ style",r,e),this.banner[e]=window[this.platformName].createBannerAd({adUnitId:e,style:r}),this.banner[e]&&(this.banner[e].onResize(this._onBannerResize),this.banner[e].onError(this._onBannerError),this.banner[e].onLoad(this._onBannerLoad.bind(this))),e}console.warn(A)}},Et.prototype.showBanner=function(t,o,e,n,i,r){var a=this;void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=-1),console.log(S),this.bannerCb=o,this.isBannerShow=!0,window[this.platformName]&&(this.bannerHorizontal=e,this.bannerVertical=n,this.bannerStyle=r,this.hideBanner(),t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),a.currentBannerId=a._createBannerAd(i),a._showBanner()):console.log("后台关闭了banner，不执行显示")}):(this.currentBannerId=this._createBannerAd(i),this._showBanner()))},Et.prototype._showBanner=function(){var o=this;setTimeout(function(){var t=o.banner[o.currentBannerId];t?t.show():console.log("banner 不存在"),console.log("延迟显示banner 250 ms")},250)},Et.prototype._onBannerLoad=function(){console.log("banner 加载结束 bannerId");var t=this.banner[this.currentBannerId];t?t.show():console.log("banner 不存在")},Et.prototype._onBannerResize=function(t){console.log("Resize后正式宽高:",t)},Et.prototype.showAppBox=function(t,o){var e=this;void 0===o&&(o=!0),window[this.platformName]&&window[this.platformName].createAppBox&&(this.mOnBoxCallback=t,console.log("showAppBox"),moosnow.http.getAllConfig(function(t){!o||t&&1==t.showAppBox?(e.box||(e.box=window[e.platformName].createAppBox({adUnitId:e.moosnowConfig.boxId}),e.box.onClose(e.onBoxClose.bind(e))),e.box.load().then(function(){e.box.show()})):(m.isFunction(e.mOnBoxCallback)&&e.mOnBoxCallback(-1),console.log("后台不允许显示Box，如有需要请联系运营"))}))},Et.prototype.hideBanner=function(){if(console.log(" hideBanner ~ this.banner",this.banner),this.banner)for(var t in this.banner)this.banner[t].hide(),this.banner[t].destroy(),delete this.banner[t]},Et.prototype.hideAppBox=function(t){var o,e=this;this.box&&(this.box.offClose(this.onBoxClose),o=this.box.destroy(),console.log("box destroy ",o),o&&o.then(function(){console.log("destroy successfully ",o),e.box=null,m.isFunction(t)&&t(!0)}).catch(function(){console.log("destroy fail ",o),e.box=null,m.isFunction(t)&&t(!1)}))},Et.prototype.onBoxClose=function(){m.isFunction(this.mOnBoxCallback)&&this.mOnBoxCallback(0)},Et.prototype.showBlock=function(t,o,e,n){var i;void 0===t&&(t=z.CENTER),void 0===o&&(o=G.TOP),void 0===e&&(e=1),void 0===n&&(n=5),window[this.platformName]&&window[this.platformName].createBlockAd&&(this.block&&this.block.destroy(),this.blockHorizontal=t,this.blockVertical=o,i=this._getBlockPosition(),console.log("QQModule -> showBlock -> style",i),this.block=window[this.platformName].createBlockAd({adUnitId:this.getBlockId(),orientation:1==e?"landscape":"vertical",size:n,style:{left:i.left,top:i.top}}),console.log("QQModule -> showBlock ->  this.block",this.block),this.block.onLoad(this._onBlockLoad.bind(this)),this.block.onError(this._onBlockError.bind(this)),this.block.onResize(this._onBlockResize.bind(this)))},Et.prototype.hideBlock=function(){this.block&&this.block.hide()},Et.prototype._onBlockLoad=function(t){console.log("QQModule -> _onBlockLoad -> res",t),this.block.show().then(function(t){console.log("QQModule -> _onBlockLoad -> showResult",t)})},Et.prototype._onBlockError=function(t){console.log("QQModule -> _onBlockError -> res",t)},Et.prototype._getBlockPosition=function(){var t=this.blockHorizontal,o=this.blockVertical,e=this.getSystemInfoSync(),n=e.windowWidth,i=e.windowHeight,r=0,a=0;return o==G.TOP?r=16:o==G.CENTER?r=(i-this.blockHeigth)/2:o==G.BOTTOM&&(r=i-this.blockHeigth-16),t==z.LEFT?a=16:t==z.RIGHT?a=n-this.blockWidth-16:t==z.CENTER&&(a=(n-this.blockWidth)/2),console.log("QQModule -> _getBlockPosition -> left",a,"top",r),{left:a,top:r}},Et.prototype._onBlockResize=function(t){var o=this._getBlockPosition();console.log("QQModule -> _onBlockResize -> style",o),this.block.style.top=o.top,this.block.style.left=o.left,console.log("重置block位置",o)},Et);function Et(){var t=Tt.call(this)||this;return t.platformName="qq",t.mBannerWidth=320,t.bannerHeigth=Math.round(t.bannerWidth/300*72.8071),t._regisiterWXCallback(),t.initBanner(),t}var Lt,Bt=function(){this.appid="",this.boxAppid="",this.desc="",this.img="",this.path="",this.title="",this.atlas="",this.pkgName="",this.extraData="",this.position="",this.onCancel=null,this.index=0,this.refresh=!1,this.showIds=null,this.source=null},Ot=(t(Ft,Lt=ot),Ft.prototype.getRemoteAd=function(a){var t={apk_id:moosnow.platform.moosnowConfig.moosnowAppId};moosnow.http.request("https://platform.qwpo2018.com/api/apk_ad/index",t,"POST",function(t){var o=t.data;if(o.sort(function(){return.5<Math.random()?1:-1}),console.log("接口数据",t.data),a){for(var e=[],n=0;n<o.length;n++){var i=o[n],r=new Bt;r.appid=i.link_appid,r.img=i.link_img,r.path=i.link_path,r.title=i.link_name,r.pkgName=i.link_page,r.desc=i.link_des,e.push(r)}a(e)}},function(){a([]),console.log("getRemoteAd fail")},function(){console.log("getRemoteAd complete")})},Ft);function Ft(){return null!==Lt&&Lt.apply(this,arguments)||this}var xt,Rt=(t(Dt,xt=lt),Dt.prototype.checkVersion=function(t,e){var n=this;moosnow.http.loadCfg(function(t){var o=xt.prototype.checkLog.call(n,t.zs_version);e(o)})},Dt.prototype.login=function(o,e){window[this.platformName]?window[this.platformName].login({success:function(t){moosnow.http.request("https://platform.qwpo2018.com/api/oppo_login/index",{apk_id:moosnow.platform.moosnowConfig.moosnowAppId,code:t.data.token},"POST",function(t){moosnow.data.setToken(t.data.user_id),o&&o(t.data),console.log("platformLogin success ",t)},function(t){o&&o(null),console.log("platformLogin fail ",t)})},fail:function(t){e&&e(t)}}):o&&o()},Dt.prototype.navigate2Mini=function(t,o,e,n){var i=this;xt.prototype.navigate2Mini.call(this,t,function(){i.navigateCallback(t.appid),m.isFunction(o)&&o()},e,n)},Dt.prototype.navigateCallback=function(t){var o={user_id:moosnow.data.getToken(),apk_id:moosnow.platform.moosnowConfig.moosnowAppId,appid:t,link_id:t};console.log("跳转数据上报",o),moosnow.http.request("https://platform.qwpo2018.com/api/apk_ad/click_log",o,"POST",function(t){console.log("跳转数据上报成功",t)},function(t){console.log("跳转数据上报失败",t)},function(){console.log("upload navigate complete")})},Dt);function Dt(){return null!==xt&&xt.apply(this,arguments)||this}var Pt,Mt=(t(Vt,Pt=X),Vt.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync(),o=t.screenWidth,e=t.screenHeight;if(!m.isEmpty(this.getBannerId()))return window[this.platformName].createBannerAd({adUnitId:this.getBannerId(),appSid:this.appSid,style:{top:e,width:o}});console.warn(A)}},Vt.prototype.createRewardAD=function(t){var o=this;this.videoLoading||window[this.platformName].createRewardedVideoAd&&(this.video?(this.video.offClose(this._onVideoClose),this.video.offError(this._onVideoError),this.video.offLoad(this._onVideoLoad)):this.video=window[this.platformName].createRewardedVideoAd({adUnitId:this.getVideoId(),appSid:this.appSid}),this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad),this.videoLoading=!0,this.video.load().then(function(){t&&o.video.show().then(function(){}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))},Vt.prototype.initRecord=function(){var t;window[this.platformName]&&(t=this.getSystemInfoSync().brand.toLowerCase(),/huawei/.test(t)||/honor/.test(t)||(this.recordObj=window[this.platformName].getVideoRecorderManager()))},Vt.prototype.startRecord=function(t,o){var e=this;void 0===t&&(t=120),void 0===o&&(o=null),console.log("record startRecord"),this.recordRes=null,this.recordCb=null,this.recordObj?(this.recordObj.onStart(function(t){console.log("record onStart"),o&&o(t)}),this.recordObj.onStop(function(t){e.recordRes=t,e.recordCb&&(console.log("stop 2"),e.recordCb(t))}),this.recordObj.start({duration:t})):o&&o(!1)},Vt.prototype.stopRecord=function(t){void 0===t&&(t=null),console.log("record stopRecord"),this.recordObj?this.recordRes?(console.log("stop 1"),t(this.recordRes)):(this.recordCb=t,this.recordObj.stop()):t&&t(!1)},Vt);function Vt(){var t=Pt.call(this)||this;return t.platformName="swan",t.appSid="",t.recordRes=null,t.recordCb=null,t}var Ht,Ut=(t(Wt,Ht=rt),Wt.prototype.getMisTouchNum=function(o){this.loadCfg(function(t){o(parseInt(t.mistouchNum))})},Wt.prototype.getMistouchPosNum=function(o){this.loadCfg(function(t){o(parseInt(t.mistouchPosNum))})},Wt.prototype.getBannerShowCountLimit=function(o){this.loadCfg(function(t){isNaN(t.bannerShowCountLimit)?o(5):o(parseInt(t.bannerShowCountLimit))})},Wt.prototype.getAllConfig=function(o){this.loadCfg(function(t){o(t)})},Wt.prototype.loadCfg=function(e){var t,n=this;this.cfgData?e(this.cfgData):(t=moosnow.platform.moosnowConfig.url+"?t="+Date.now(),console.log("appid ",moosnow.platform.moosnowConfig.moosnowAppId),this.request(t,{apk_id:moosnow.platform.moosnowConfig.moosnowAppId},"POST",function(t){var o=t.data.zs_version==moosnow.platform.moosnowConfig.version;n.cfgData=c(c({},m.deepCopy(t.data)),{mistouchNum:t.data.zs_switch,mistouchPosNum:t.data.zs_switch,showNative:o,showInter:o,showExportAd:o,mx_native_click_switch:1==t.zs_native_click_switch,mx_jump_switch:1==t.zs_jump_switch,bannerShowCountLimit:isNaN(t.data.bannerShowCountLimit)?1:t.data.bannerShowCountLimit}),moosnow.platform&&(moosnow.platform.bannerShowCountLimit=parseInt(t.data.bannerShowCountLimit)),e(n.cfgData)},function(){e({}),console.log("load config json fail")}))},Wt);function Wt(){return null!==Ht&&Ht.apply(this,arguments)||this}var Qt={FAIL:"请分享到群！"},zt={ERR:"视频正在加载中,请稍后",NOTEND:"请完整观看完视频！"},jt=(Gt.prototype.shuffle=function(t){for(var o,e,n=t.length,i=n;i--;)i!==(e=Math.floor(Math.random()*n))&&(o=t[i],t[i]=t[e],t[e]=o);return t},Gt.prototype.indexOf=function(t,o){for(var e=-1,n=0,i=t.length;n<i;n++)if(t[n]==o){e=n;break}return e},Gt.prototype.replace=function(t,o,e){var n=t[o],i=t[e];t[e]=n,t[o]=i},Gt.prototype.merge=function(t,o){for(var e=0,n=t.length;e<n;e++)o.push(t[e]);return o},Gt.clone=function(t){return new Array,t.slice(0)},Gt.remove=function(t,o){for(var e=0;e<t.length;e++)if(t[e]==o)return t.splice(e,1),void e--},Gt);function Gt(){}var qt,Kt=(t(Xt,qt=p),Xt.prototype.addListener=function(t,o,e){this._addListener(t,o,!1,e)},Xt.prototype.addToSendQueue=function(t,o){this._addToSendList(t,o)},Xt.prototype.sendEventImmediately=function(t,o){this._sendEvent(t,o),this.onUpdate()},Xt.prototype.removeListener=function(t,o){if(null!=t&&""!=t)for(var e=0;e<this._eventList.length;e++){var n=this._eventList[e];if(n.eventName===t){for(var i=0;i<n.listeners.length;i++){var r=n.listeners[i];if(r.target===o){jt.remove(n.listeners,r);break}}0==n.listeners.length&&jt.remove(this._eventList,n);break}}else console.error("eventName:"+t+"不合法！")},Xt.prototype.removeAllListener=function(){this._eventList.length=0,this._eventList=[],this._waitingForSendList.length=0,this._waitingForSendList=[]},Xt.prototype._addListener=function(t,o,e,n){if(null!=t&&""!=t){var i=new Yt;n instanceof Function?i.callback=n:console.error("callback不是一个方法"),o?i.target=o:console.error("target为空"),i.once=e;var r=!1;if(0<this._eventList.length){for(var a,s=0;s<this._eventList.length;s++){var l=this._eventList[s];if(t===l.eventName)return l.listeners.push(i),void(r=!0)}r||((a=new Jt).eventName=t,a.listeners.push(i),this._eventList.push(a))}else{var c=new Jt;c.eventName=t,c.listeners.push(i),this._eventList.push(c)}}else console.error("eventName:"+t+"不合法！")},Xt.prototype._addToSendList=function(t,o){var e;null!=t&&""!=t?(e={eventName:t,data:o},this._waitingForSendList.push(e)):console.error("eventName:"+t+"不合法！")},Xt.prototype._sendEvent=function(t,o){for(var e=this._eventList,n=0;n<e.length;n++){var i=e[n];if(i.eventName===t)for(var r=i.listeners,a=r.length-1;0<=a;a--){var s=r[a],l=s.callback,c=s.target;c?(l.call(c,o),s.once&&this._eventList[n].listeners[a]&&(jt.remove(this._eventList[n].listeners,s),n--)):(jt.remove(this._eventList[n].listeners,s),a--)}}},Xt.prototype.onUpdate=function(){if(0!=this._waitingForSendList.length)for(var t=0;t<this._waitingForSendList.length;t++){var o=this._waitingForSendList[t];this._sendEvent(o.eventName,o.data),jt.remove(this._waitingForSendList,o),t--}},Xt.prototype.onDisable=function(){},Xt);function Xt(){var t=qt.call(this)||this;return t._eventList=[],t._waitingForSendList=[],t._eventList=[],t._waitingForSendList=[],t}var Zt,Yt=function(){this.callback=null,this.target=[],this.once=!1,this.callback=null,this.target=null,this.once=!1},Jt=function(){this.eventName="",this.listeners=[],this.eventName="",this.listeners=[]},$t=(t(to,Zt=X),to.prototype.initAdService=function(){this._prepareNative(),moosnow.event.addListener(b.ON_PLATFORM_SHOW,this,this.onAppShow)},to.prototype.navigate2Mini=function(t,o,e,n){var i,r,a,s,l=this;console.log(T,t),Date.now()-this.prevNavigate<300?console.log(_):(this.prevNavigate=Date.now(),window[this.platformName]?(i=t.appid,r=t.path,s=t.extraData,a=t.pkgName,s=s||{},this.supportVersion(1044)?window[this.platformName].navigateToMiniGame({appId:i,path:r,pkgName:a||i,extraData:s,success:function(){window[l.platformName]&&window[l.platformName].aldSendEvent&&window[l.platformName].aldSendEvent("跳转",{position:t.position,appid:i,img:t.atlas||t.img}),moosnow.http.exportUser(),o&&o()},fail:function(t){console.log("navigateToMiniProgram error ",t),e&&e()},complete:function(){n&&n()}}):console.log(Q)):o&&o())},to.prototype.supportVersion=function(t){return this.getSystemInfoSync().platformVersionCode>=t},to.prototype._onBannerError=function(t){console.warn("banner___error:",t.errCode," msg ",t.errMsg)},to.prototype.getSystemInfoSync=function(){return null==this.systemInfo&&(window[this.platformName]&&window[this.platformName].getSystemInfoSync?this.systemInfo=window[this.platformName].getSystemInfoSync():this.systemInfo={},console.log(k,this.systemInfo)),this.systemInfo},to.prototype._getBannerPosition=function(){var t=this.bannerHorizontal,o=this.bannerVertical,e=this.getSystemInfoSync(),n=e.screenWidth,i=e.screenHeight,r=e.statusBarHeight,a=e.notchHeight||0;this.banner&&this.banner.style&&(isNaN(this.bannerWidth)||(this.banner.style.width=this.bannerWidth),isNaN(this.bannerHeight)||(this.banner.style.height=this.bannerHeight));var s=0,l=0;return o==g.TOP?s=this.isLandscape(e.screenHeight,e.screenWidth)?0:r+a:o==g.CENTER?s=(i-this.bannerHeigth)/2:o==g.BOTTOM&&(s=i-this.bannerHeigth),t==f.LEFT?l=0:t==f.RIGHT?l=n-this.bannerWidth:t==f.CENTER&&(l=(n-this.bannerWidth)/2),console.log("VIVOModule -> _getBannerPosition -> top,left",s,l),{left:l,top:s}},to.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=Date.now();if(this.mShowTime){if(this.mShowTime&&t-this.mShowTime<=1e3*this.mMinInterval)return void console.log("banner创建太频繁了 "+this.mMinInterval+"秒内只能显示一次")}else this.mShowTime=t;if(this.mShowTime=Date.now(),!m.isEmpty(this.getBannerId())){var o=this._getBannerPosition();return window[this.platformName].createBannerAd({posId:this.getBannerId(),style:{left:o.left,top:o.top,width:this.bannerWidth,height:this.bannerHeight}})}console.warn(A)}},to.prototype.getNotchHeight=function(){var t=0;return window[this.platformName].getNotchHeightSync&&(t=window[this.platformName].getNotchHeightSync().height),t},to.prototype._onBannerResize=function(t){this.bannerHeight=t.realHeight,this.bannerWidth=t.realWidth,console.log("onSize callback  ",t)},to.prototype._onBannerClose=function(){console.log("banner 已关闭 ")},to.prototype._onBannerHide=function(){console.log("banner 已隐藏 ")},to.prototype.showBanner=function(t,o,e,n,i,r){var a=this;void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=0),this.bannerCb=o,this.isBannerShow=!0,window[this.platformName]&&(this.bannerHorizontal=e,this.bannerVertical=n,this.bannerStyle=r,t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),a._showBanner()):console.log("后台关闭了banner，不执行显示")}):this._showBanner())},to.prototype._showBanner=function(){var t,o=this;this.banner&&this.banner.hide&&(this.banner.hide(),this.banner.destroy(),this.banner=null),this.banner=this._createBannerAd(),this.banner&&this.banner.show&&(t=this.banner.show())&&t.then(function(){console.log("banner广告展示成功")}).catch(function(t){switch(moosnow.http.getAllConfig(function(t){1==t.bannerErrorShowInter&&(console.log("banner加载出错，用插屏代替"),o.showInter())}),t.code){case 30003:console.log("新用户1天内不能曝光Banner，请将手机时间调整为1天后，退出游戏重新进入");break;case 30009:console.log("10秒内调用广告次数超过1次，10秒后再调用");break;case 30002:console.log("加载广告失败，重新加载广告");break;default:console.log("banner广告展示失败"),console.log(JSON.stringify(t))}})},to.prototype.hideBanner=function(){if(console.log(N),window[this.platformName]){var t=Date.now();if(this.mHideTime){if(this.mHideTime&&t-this.mHideTime<=1e3*this.mMinHideInterval)return void console.log("banner隐藏太频繁了 "+this.mMinHideInterval+"秒内只隐藏一次")}else this.mHideTime=t;this.mHideTime=t,this.banner&&this.banner.hide&&(console.log("隐藏和销毁banner"),this.banner.hide(),this.banner.destroy(),this.banner=null)}},to.prototype.createRewardAD=function(t,o){if(void 0===o&&(o=0),!moosnow.platform.videoLoading)if(window[this.platformName]){if(window[this.platformName].createRewardedVideoAd)if(m.isEmpty(this.getVideoId()))console.warn(E);else{if(this.mVideoTime){if(Date.now()-this.mVideoTime<1e4)return void(moosnow.platform.videoCb&&moosnow.platform.videoCb(y.ERR));this.mVideoTime=Date.now()}else this.mVideoTime=Date.now();var e=this.getVideoId(o);this.video[e]?this.video[e].load():(moosnow.platform.videoLoading=!0,this.video=window[this.platformName].createRewardedVideoAd({posId:e}),this.video.onError(this._onVideoError.bind(this)),this.video.onClose(this._onVideoClose.bind(this)),this.video.onLoad(this._onVideoLoad.bind(this)))}}else moosnow.platform.videoCb(y.END)},to.prototype._onVideoLoad=function(){var t=this;console.log(L),moosnow.platform.videoLoading=!1,this.video&&this.video.show().then(function(){t.videoPlaying=!0,moosnow.event.sendEventImmediately(b.ON_PLATFORM_HIDE,{}),console.log("激励视频广告展示完成")}).catch(function(t){console.log("激励视频广告展示失败",JSON.stringify(t)),moosnow.platform.videoCb&&moosnow.platform.videoCb(y.ERR)})},to.prototype._onVideoClose=function(t){var o;console.log(B,t.isEnded),moosnow.platform.videoLoading=!1,this.videoPlaying=!1,t.isEnded&&moosnow.http.clickVideo(),moosnow.event.sendEventImmediately(b.ON_PLATFORM_SHOW,{}),moosnow.platform.videoCb&&(o=t.isEnded?y.END:y.NOTEND,moosnow.platform.videoCb(o))},to.prototype.prepareInter=function(){m.isEmpty(this.interId)?console.warn(U):window[this.platformName]&&window[this.platformName].createInterstitialAd&&(this.inter&&(this.inter.offLoad(),this.inter.offClose(),this.inter.offError(),this.inter=null),console.log("创建插屏广告"),this.inter=window[this.platformName].createInterstitialAd({posId:this.interId}),this.inter.onLoad(this._onInterLoad.bind(this)),this.inter.onClose(this._onInterClose.bind(this)),this.inter.onError(this._onInterError.bind(this)),this.inter.load())},to.prototype.showInter=function(){this.prepareInter()},to.prototype._onInterLoad=function(){var t;!this.inter||(t=this.inter.show())&&t.then(function(){console.log("插屏广告展示完成")}).catch(function(t){console.log("插屏广告展示失败",t)})},to.prototype._onInterOnShow=function(){this.inter&&this.inter.load()},to.prototype.showAutoBanner=function(){console.log(" vivo 不支持自动")},to.prototype.reportMonitor=function(t,o){window[this.platformName]&&window[this.platformName].reportMonitor&&window[this.platformName].reportMonitor("game_scene",0)},to.prototype._prepareNative=function(t){void 0===t&&(t=!1),window[this.platformName]&&window[this.platformName].createNativeAd&&(this._destroyNative(),this.native=window[this.platformName].createNativeAd({posId:this.nativeId[this.nativeIdIndex]}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this)),this.nativeLoading=!0,t&&this.native.load())},to.prototype._onNativeLoad=function(t){var o=this;this.nativeLoading=!1,console.log(F,t),t&&t.adList&&0<t.adList.length?(this.nativeAdResult=t.adList[t.adList.length-1],m.isEmpty(this.nativeAdResult.adId)||(console.log(M),this.native.reportAdShow({adId:this.nativeAdResult.adId})),m.isFunction(this.nativeCb)&&this.nativeCb(m.deepCopy(this.nativeAdResult))):(console.log(V),m.isFunction(this.nativeCb)&&moosnow.http.getAllConfig(function(t){1==t.nativeErrorShowInter?(console.log("原生加载出错，用插屏代替"),o.showInter()):o.nativeCb(null)}))},to.prototype._onNativeError=function(t){var o=this;this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log(x,t),this.nativeIdIndex+=1,this._destroyNative()):(console.log(D),this.nativeIdIndex=0):console.log(R,t),moosnow.http.getAllConfig(function(t){1==t.nativeErrorShowInter?(console.log("原生加载出错，用插屏代替"),o.showInter()):o.nativeCb&&o.nativeCb(null)})},to.prototype._destroyNative=function(){this.nativeLoading=!1,this.native&&(this.native.offLoad(),this.native.offError(),this.native.destroy()),console.log(H)},to.prototype.showNativeAd=function(t){var o,e=this;this.nativeCb=t,this.native?(o=this.native.load())&&o.then(function(){console.log("原生广告加载完成")}).catch(function(t){console.log("原生广告加载失败"),moosnow.http.getAllConfig(function(t){1==t.nativeErrorShowInter?(console.log("原生加载出错，用插屏代替"),e.nativeCb(null),e.showInter()):e.nativeCb(null)})}):this._prepareNative(!0)},to.prototype.clickNative=function(t){this.nativeAdResult&&!m.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log(P,this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},to.prototype.onAppShow=function(){this.mIsClickedNative&&(this.mIsClickedNative=!1,m.isFunction(this.mClickedNativeCallback)&&this.mClickedNativeCallback())},to.prototype.hasShortcutInstalled=function(o,e){window[this.platformName]&&window[this.platformName].hasShortcutInstalled&&window[this.platformName].hasShortcutInstalled({success:function(t){o&&o(!!t),t?console.log("已创建"):console.log("未创建")},fail:function(t){e&&e(t)}})},to.prototype.installShortcut=function(o,t,e){void 0===t&&(t="方便下次快速启动"),window[this.platformName]&&window[this.platformName].installShortcut&&window[this.platformName].installShortcut({message:t,success:function(t){o&&o(t),console.log("创建成功")},fail:function(t){e&&e(t)}})},to.prototype.exitApplication=function(){window[this.platformName]&&window[this.platformName].exitApplication&&window[this.platformName].exitApplication()},to);function to(){var t=Zt.call(this)||this;return t.platformName="qg",t.appSid="",t.mBannerWidth=720,t.bannerHeight=114,t.interLoadedShow=!1,t.prevNavigate=Date.now(),t.mMinInterval=10,t.mMinHideInterval=5,t.mIsClickedNative=!1,t._regisiterWXCallback(),t.initAdService(),t}var oo,eo={NONE:0,BANNER:1,FLOAT:2,SIDE:4,CENTER:8,EXPORT:16,BACK:32,MASK:64,WAIT:128,LEFTRIGHT:256,EXPORT_FIXED:512,ROTATE:1024,EXTEND2:2048,EXTEND3:4096,EXTEND4:8192,TOP:32768,RECOVER:16384},no=(t(io,oo=p),io.prototype.onEnable=function(){},io.prototype.loadAsset=function(t,o,e){var n;if(m.getEngine()==a)cc.resources?cc.resources.load(t,o,function(t,o){t?console.log(" cc.resources.load ",t):e&&e(t,o)}):n=cc.loader.load(t,o,function(t,o){t?console.log(" cc.loader.load ",t):e&&e(null,n)});else if(m.getEngine()==h){var i=Laya.loader.getRes(t);if(i)return void(e&&e(null,i));Laya.loader.create(t,Laya.Handler.create(this,function(t){e(null,t)}),null,o)}},io.prototype.loadAssetDir=function(t,o,i,e){m.getEngine()==a?cc.loader.loadResDir(t,o,function(t,o,e){var n=t/o*100,n=Math.ceil(n);i&&i(n)},function(t,o){e&&e(t,o)}):console.warn("不支持loadAssetDir")},io.prototype.onDisable=function(){},io);function io(){return oo.call(this)||this}var ro,ao=(t(so,ro=p),Object.defineProperty(so.prototype,"btnSound",{get:function(){return this.mBtnSound},set:function(t){this.mBtnSound=t},enumerable:!0,configurable:!0}),so.prototype.playClickEffect=function(){this.mBtnSound?this.playSound(this.mBtnSound):console.log("没有点击音效")},Object.defineProperty(so.prototype,"isMuteSound",{get:function(){return this._isMuteSound},set:function(t){this._isMuteSound=t,this.save()},enumerable:!0,configurable:!0}),Object.defineProperty(so.prototype,"isMute",{get:function(){return this._isMute},set:function(t){this._isMute=t,this.save()},enumerable:!0,configurable:!0}),Object.defineProperty(so.prototype,"isMuteMusic",{get:function(){return this._isMuteMusic},set:function(t){this._isMuteMusic=t,this.save()},enumerable:!0,configurable:!0}),Object.defineProperty(so.prototype,"volumeSound",{get:function(){return this._volumeSound},set:function(t){this._volumeSound=t,this.save()},enumerable:!0,configurable:!0}),so.prototype.playSound=function(t,o,e,n,i){if(void 0===o&&(o=!1),void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=0),!this.isMute){var r=cc.audioEngine.playEffect(t,o);return cc.audioEngine.setFinishCallback(r,function(t){e&&e(t),o||cc.audioEngine.stop(r)}),r}},so.prototype._replayMusic=function(){this.playMusic(this._musicClip,this._musicLoops,this._musicComplete)},so.prototype.playMusic=function(t,o,e){if(void 0===o&&(o=!0),void 0===e&&(e=null),!this.isMute){if(this._musicClip=t,this._musicLoops=o,this._musicComplete=e,m.getEngine()==a){if(!cc.audioEngine)return;if(!cc.audioEngine.playMusic)return;var n=cc.audioEngine.playMusic(t,o);return cc.audioEngine.setFinishCallback(n,function(t){e&&e(t)}),n}m.getEngine()==h&&Laya.SoundManager.playMusic(""+t,1,new Laya.Handler(this,function(t){e&&e(t)}))}},so.prototype.stopMusic=function(){m.getEngine()==a?cc.audioEngine.stopMusic():m.getEngine()==h&&Laya.SoundManager.stopMusic()},so.prototype.save=function(){moosnow.setting.setValue(this.IS_MUTE,""+this.isMute),moosnow.setting.setValue(this.IS_MUTE_MUSIC,""+this.isMuteMusic),moosnow.setting.setValue(this.IS_MUTE_SOUND,""+this.isMuteSound)},so.prototype.getSave=function(){this.isMute="true"==moosnow.setting.getString(this.IS_MUTE,"false"),this.isMuteMusic="true"==moosnow.setting.getString(this.IS_MUTE_MUSIC,"false")},so);function so(){var t=ro.call(this)||this;return t.mBtnSound=null,t.IS_MUTE="isMute",t.IS_MUTE_MUSIC="isMuteMusic",t.IS_MUTE_SOUND="isMuteSound",t.VOLUME_MUSIC="volumeMusic",t.VOLUME_SOUND="volumeSound",t._volumeMusic=1,t._volumeSound=1,t._isMuteMusic=!1,t._isMuteSound=!1,t._isMute=!1,t}var lo,co=(t(ho,lo=X),ho.prototype._prepareBanner=function(){},ho.prototype._createBannerAd=function(){if(window[this.platformName]&&window[this.platformName].createBannerAd){var t=this.getSystemInfoSync();t.windowWidth;t.windowHeight,this.bannerWidth,this.bannerShowTime=Date.now();var o=this.mGravity[this.bannerHorizontal+"_"+this.bannerVertical];return isNaN(o)&&(o=7),window[this.platformName].createBannerAd({style:{gravity:o,width:this.bannerWidth}})}},ho.prototype.showBanner=function(t,o,e,n,i,r){var a=this;void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=0),console.log(S),this.bannerCb=o,this.isBannerShow=!0,window[this.platformName]&&(this.bannerHorizontal=e,this.bannerVertical=n,this.bannerStyle=r,this.mTimeoutId&&(clearTimeout(this.mTimeoutId),this.mTimeoutId=null),t?moosnow.http.getAllConfig(function(t){0!=t.mistouchNum?(console.log("后台开启了banner，执行显示"),a._showBanner()):console.log("后台关闭了banner，不执行显示")}):this._showBanner())},ho.prototype._showBanner=function(){var t,o;window[this.platformName].createBannerAd&&(o=(t=this.getSystemInfoSync()).windowWidth,t.windowHeight<t.windowWidth&&!(o<this.bannerWidth)||(this.bannerWidth=o),this.banner&&(this.banner.hide(),this.banner.destroy(),this.banner=null),this.banner=this._createBannerAd(),this.banner&&(this.banner.onError(this._onBannerError.bind(this)),this.banner.onLoad(this._onBannerLoad.bind(this)),this.banner.show()))},ho.prototype.hideBanner=function(){this.banner&&(this.banner.hide(),this.banner.destroy(),this.banner=null)},ho.prototype.createRewardAD=function(t){var o=this;if(!this.videoLoading)if(window[this.platformName])if(window[this.platformName].createRewardedVideoAd){var e=this.getVideoId();if(m.isEmpty(e))return console.warn(E),void(moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END));if(!this.video){if(this.video=window[this.platformName].createRewardVideoAd(),!this.video)return void console.warn("创建视频广告失败");this.video.onError(this._onVideoError),this.video.onClose(this._onVideoClose),this.video.onLoad(this._onVideoLoad)}moosnow.platform.videoLoading=!0,moosnow.platform.videoPlaying=!1,this.video.load().then(function(){t&&(moosnow.platform.videoPlaying=!0,o.video.show().then(function(){}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)}))}).catch(function(t){o._onVideoError(t.errMsg,t.errCode),console.log(t.errMsg)})}else moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END);else moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END)},ho);function ho(){var t,o=lo.call(this)||this;return o.platformName="uc",o.mGravity=((t={})[f.CENTER+"_"+g.TOP]=1,t[f.CENTER+"_"+g.CENTER]=4,t[f.CENTER+"_"+g.BOTTOM]=7,t[f.LEFT+"_"+g.BOTTOM]=6,t[f.RIGHT+"_"+g.BOTTOM]=8,t),window[o.platformName]&&window[o.platformName].setEnableDebug?(window[o.platformName].setEnableDebug({enableDebug:1==m.config.enableDebug,complete:function(t){console.log("uc.setEnableDebug openDebug. ")}}),window[o.platformName].requestScreenOrientation&&window[o.platformName].requestScreenOrientation({orientaiton:"portrait"==m.config.orientaiton?1:2,success:function(t){console.log(t)},fail:function(t){console.error(t)}}),o):o}var po=(mo.parse=function(t){return c(c({},new mo),t)},mo.convertStr2Enum=function(t,o,e){return t.hasOwnProperty(o)?t[o]:e},mo);function mo(){this.x=0,this.y=0,this.width="canvasWidth",this.height="canvasHeight",this.url="",this.isMask=!1,this.maskUrl="",this.child=null,this.event=[],this.type="",this.active=!0,this.widget=null,this.grid=null,this.zIndex=0,this.stopPropagation=!1}var uo=function(){this.formNode=null,this.formLogic=null},fo=(Object.defineProperty(wo.prototype,"quene",{get:function(){return this.mQuene},set:function(t){this.mQuene=t},enumerable:!0,configurable:!0}),wo);function wo(){this.formName="",this.mQuene=[]}var go=(Object.defineProperty(vo.prototype,"layoutQuene",{get:function(){return this.mFormQuene},set:function(t){this.mFormQuene=t},enumerable:!0,configurable:!0}),Object.defineProperty(vo.prototype,"cachedLayoutQuene",{get:function(){return this.mCachedLayoutQuene},set:function(t){this.mCachedLayoutQuene=t},enumerable:!0,configurable:!0}),vo.prototype.destory=function(){this.cachedLayoutQuene=[],this.layoutQuene=[]},vo.prototype.addFrom2Cached=function(t,o){for(var e,n=-1,i=0;i<this.cachedLayoutQuene.length;i++)if((e=this.cachedLayoutQuene[i]).formName==t){n=i;break}-1!=n?this.cachedLayoutQuene[n].quene.push(o):((e=new fo).formName=t,e.quene.push(o),this.cachedLayoutQuene.push(e))},vo.prototype.getFormFromCached=function(t){for(var o=0;o<this.cachedLayoutQuene.length;o++){var e=this.cachedLayoutQuene[o];if(e.formName==t){var n=0;if(n<e.quene.length)return e.quene.splice(n,1),0==e.quene.length&&this.cachedLayoutQuene.splice(o,1),e.quene[n];break}}return null},vo.prototype.addForm2Quene=function(t,o,e){for(var n,i,r=-1,a=0;a<this.layoutQuene.length;a++)if(this.layoutQuene[a].formName==t){r=a;break}-1!=r?((i=new uo).formNode=o,i.formLogic=e,this.layoutQuene[r].quene.push(i)):((n=new fo).formName=t,(i=new uo).formNode=o,i.formLogic=e,n.quene.push(i),this.layoutQuene.push(n))},vo.prototype.hasFormInQuene=function(t){for(var o=-1,e=0;e<this.layoutQuene.length;e++)if(this.layoutQuene[e].formName==t){o=e;break}return-1!=o},vo.prototype.recoverFormLogic=function(o,t,e,n){var i=this;void 0===n&&(n=1);var r=o.quene.splice(t,n);if(0==o.quene.length)for(var a=0;a<this.layoutQuene.length;a++)if(o==this.layoutQuene[a]){this.layoutQuene.splice(a,1);break}r.forEach(function(t){i.addFrom2Cached(o.formName,t)}),e&&(1==r.length?e(r[0]):e(r))},vo.prototype.removeFormByLogic=function(t,o){for(var e=0;e<this.layoutQuene.length;e++)for(var n=this.layoutQuene[e],i=0;i<n.quene.length;i++)if(n.quene[i].formLogic==t){this.recoverFormLogic(n,i,o);break}},vo.prototype.removeFormFromQuene=function(t,o,e){for(var n=0;n<this.layoutQuene.length;n++){var i=this.layoutQuene[n];if(i.formName==t){for(var r=0;r<i.quene.length;r++)if(i.quene[r]==o){this.recoverFormLogic(i,r,e);break}break}}},vo.prototype.removeAllFormFromQuene=function(t,o){for(var e=0;e<this.layoutQuene.length;e++){var n=this.layoutQuene[e];if(n.formName==t){for(var i=0;i<n.quene.length;i++)this.recoverFormLogic(n,i,o),i--;break}}},vo.prototype.getKVByName=function(t,o){var e=this.getKVsByName(t);if(e)for(var n=0;n<e.length;n++)if(e[n].formNode==o)return e[n]},vo.prototype.getKVsByName=function(t){for(var o=-1,e=0;e<this.layoutQuene.length;e++)if(this.layoutQuene[e].formName==t){o=e;break}return-1!=o?this.layoutQuene[o].quene:[]},vo.prototype.setLayout=function(t){this.mCachedLayout=t},vo.prototype.getLayout=function(t){var e=this;this.mCachedLayout?t(this.mCachedLayout):(this.mLayoutQuene.push(t),1==this.mLayoutQuene.length&&moosnow.http.request(this.layoutUrl,{},"GET",function(o){e.mCachedLayout=o,console.log("getLayout call num ",e.mLayoutQuene.length),e.mLayoutQuene.forEach(function(t){t(o)}),e.mLayoutQuene=[]}))},vo.prototype.setTemplates=function(t){this.mCachedTemplates=t},vo.prototype.getTemplates=function(t){var e=this;this.mCachedTemplates?t(this.mCachedTemplates):(this.mTemplatesQuene.push(t),1==this.mTemplatesQuene.length&&moosnow.http.request(this.templatesUrl,{},"GET",function(o){e.mCachedTemplates=o,e.mTemplatesQuene.forEach(function(t){t(o)}),e.mTemplatesQuene=[]}))},vo.prototype.getTemplate=function(n,i){this.getTemplates(function(t){var o,e=t[n];e&&(o=po.parse(e),i(o))})},vo.prototype.showForm=function(t){},vo.prototype.hideFormByLogic=function(t,o){},vo.prototype.hideForm=function(t,o,e){},vo.prototype.createNodeByTemplate=function(t,o,e,n,i,r){void 0===i&&(i=!0),void 0===r&&(r=null)},vo.prototype.hideNodeByTemplate=function(t,o,e){},vo);function vo(){this.layoutUrl=it+"/layout/"+m.config.moosnowAppId+"/layout.json",this.templatesUrl=it+"/layout/"+m.config.moosnowAppId+"/templates.json",this.maskUrl=it+"/layout/"+m.config.moosnowAppId+"/img_mask.png",this.mFormQuene=[],this.mCachedLayoutQuene=[],this.mLayoutQuene=[],this.mTemplatesQuene=[]}var yo,bo=(t(Co,yo=p),Object.defineProperty(Co,"canvasNode",{get:function(){return cc.Canvas.instance.node},enumerable:!0,configurable:!0}),Co.getNodeName=function(){return this.nodeNum++,"createNode"+this.nodeNum},Co.createNode=function(){},Co.createImage=function(t,o){},Co.createText=function(t,o){},Co.changeSrc=function(t,o){},Co.createMask=function(t){},Co.nodeNum=0,Co);function Co(){return null!==yo&&yo.apply(this,arguments)||this}var No,Ao=(t(So,No=p),Object.defineProperty(So.prototype,"node",{get:function(){return this.mOwner?this.mOwner:{}},set:function(t){this.mOwner=t},enumerable:!0,configurable:!0}),So.prototype.start=function(){},Object.defineProperty(So.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),So.prototype.initForm=function(t){for(var o in this.node=t,this){var e;m.isFunction(this[o])||((e=this.findNodeByName(t,o))&&(this[o]=e),this.mNodeMap.push(o))}for(var n=0;n<this.formComponents.length;n++)this.formComponents[n].initForm(t)},So.prototype.disable=function(){var o=this;this.node=null,this.mNodeMap.forEach(function(t){o[t]=null}),this.formComponents.forEach(function(t){t.disable()}),this.formComponents=[]},So.prototype.findNodeByName=function(t,o){return null},So.prototype.willShow=function(o){(this.mFormData=o)&&this.node&&(o.x&&(this.node.x=o.x),o.y&&(this.node.y=o.y),o.zIndex&&(this.node.zIndex=o.zIndex)),this.formComponents.forEach(function(t){t.willShow(o)})},So.prototype.onShow=function(o){this.formComponents.forEach(function(t){t.onShow(o)})},So.prototype.willHide=function(o){this.formComponents.forEach(function(t){t.willHide(o)})},So.prototype.onHide=function(o){this.formComponents.forEach(function(t){t.onHide(o)})},So.prototype.hideForm=function(){moosnow.form.formFactory.hideFormByLogic(this)},So);function So(){var t=null!==No&&No.apply(this,arguments)||this;return t.mOwner=null,t.formComponents=[],t.mNodeMap=[],t}var Io,_o=(t(To,Io=Ao),Object.defineProperty(To,"TOUCH_START",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(To,"TOUCH_END",{get:function(){return""},enumerable:!0,configurable:!0}),To);function To(){return null!==Io&&Io.apply(this,arguments)||this}var ko,Eo=(t(Lo,ko=_o),Object.defineProperty(Lo,"TOUCH_START",{get:function(){return cc.Node.EventType.TOUCH_START},enumerable:!0,configurable:!0}),Object.defineProperty(Lo,"TOUCH_END",{get:function(){return cc.Node.EventType.TOUCH_END},enumerable:!0,configurable:!0}),Object.defineProperty(Lo,"TOUCH_CANCEL",{get:function(){return cc.Node.EventType.TOUCH_CANCEL},enumerable:!0,configurable:!0}),Lo);function Lo(){return null!==ko&&ko.apply(this,arguments)||this}var Bo,Oo=(t(Fo,Bo=po),Fo.parse=function(t){var o=c(c({},new Fo),t);return o.layoutType=po.convertStr2Enum(cc.Layout.Type,t.layoutType,cc.Layout.Type.GRID),o.resizeMode=po.convertStr2Enum(cc.Layout.ResizeMode,t.resizeMode,cc.Layout.ResizeMode.CONTAINER),o.startAxis=po.convertStr2Enum(cc.Layout.AxisDirection,t.startAxis,cc.Layout.AxisDirection.HORIZONTAL),o},Fo);function Fo(){var t=null!==Bo&&Bo.apply(this,arguments)||this;return t.layoutType=cc.Layout.Type.GRID,t.resizeMode=cc.Layout.ResizeMode.CONTAINER,t.startAxis=cc.Layout.AxisDirection.HORIZONTAL,t.left=30,t.top=30,t.right=30,t.bottom=30,t.spacingX=30,t.spacingY=30,t}var xo,Ro=(t(Do,xo=po),Do.parse=function(t){return c(c({},new Do),t)},Do);function Do(t,o,e,n,i,r,a,s){void 0===t&&(t=!1),void 0===o&&(o=!1),void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=0);var l=xo.call(this)||this;return l.isAlignLeft=!1,l.isAlignTop=!1,l.isAlignRight=!1,l.isAlignBottom=!1,l.left=0,l.top=0,l.right=0,l.bottom=0,l.isAlignLeft=t,l.isAlignTop=o,l.isAlignRight=e,l.isAlignBottom=n,l.left=i,l.top=r,l.right=a,l.bottom=s,l}var Po,Mo=(t(Vo,Po=bo),Object.defineProperty(Vo,"canvasNode",{get:function(){return this.mRootNode||(this.mRootNode=cc.Canvas.instance.node),cc.Canvas.instance.node},set:function(t){this.mRootNode=t},enumerable:!0,configurable:!0}),Vo.createNode=function(t,o){t=t||this.getNodeName();var e=new cc.Node;return e.name=t,o&&(e.active=o.active,e.zIndex=this.convertIndex(o.zIndex),o.stopPropagation&&this.addStopPropagation(e)),e},Vo.createImage=function(t,o){var e=this.createNode(o.name,o),n=e.addComponent(cc.Sprite);return n.type=cc.Sprite.Type.SIMPLE,n.sizeMode=cc.Sprite.SizeMode.TRIMMED,n.trim=!0,e.width=this.convertWidth(o.width),e.height=this.convertHeight(o.height),this.changeSrc(e,o,function(){}),e.x=o.x,e.y=o.y,t.addChild(e),e},Vo.colorHex2RGB=function(t){"#"==t.substr(0,1)&&(t=t.substring(1)),t=t.toLowerCase();for(var o=new Array,e=0;e<3;e++)o[0]=t.substr(2*e,2),o[3]="0123456789abcdef",o[1]=o[0].substr(0,1),o[2]=o[0].substr(1,1),o[20+e]=16*o[3].indexOf(o[1])+o[3].indexOf(o[2]);return new cc.Color(o[20],o[21],o[22])},Vo.createText=function(t,o){var e=this.createNode(o.name,o);e.color=this.colorHex2RGB(o.color);var n=e.addComponent(cc.Label);n.enableWrapText=!1,n.overflow=cc.Label.Overflow.SHRINK,n.fontSize=o.fontSize,n.lineHeight=o.lineHeight;var i=cc.Label.HorizontalAlign[o.horizontalAlign.toUpperCase()];return n.horizontalAlign=i||cc.Label.HorizontalAlign.CENTER,n.verticalAlign=cc.Label.VerticalAlign.CENTER,n.useSystemFont=!0,o.text&&(n.string=o.text),e.x=o.x,e.y=o.y,e.width=this.convertWidth(o.width),e.height=this.convertWidth(o.height),t.addChild(e),e},Vo.createLayout=function(t,o){var e=this.createNode(o.name,o),n=e.addComponent(cc.Layout);return n.paddingLeft=o.left,n.paddingTop=o.top,n.paddingRight=o.right,n.paddingBottom=o.bottom,n.spacingX=o.spacingX,n.spacingY=o.spacingY,n.startAxis=o.startAxis,e.x=o.x,e.y=o.y,e.width=this.convertWidth(o.width),e.height=this.convertWidth(o.height),t.addChild(e),e},Vo.createProgressBar=function(t,o){var e,n=this.createNode(o.name,o),i=n.addComponent(cc.ProgressBar);return n.addComponent(cc.Sprite),this.changeSrc(n,o),i.mode=cc.ProgressBar.Mode.HORIZONTAL,i.totalLength=300,i.progress=.1,n.x=o.x,n.y=o.y,n.width=this.convertWidth(o.width),n.height=this.convertWidth(o.height),o.child&&0<o.child.length&&(e=this.createImage(n,po.parse(o.child[0])),i.barSprite=e.getComponent(cc.Sprite)),t.addChild(n),n},Vo.createScroll=function(t,o){},Vo.createView=function(t,o){var e=this.createImage(t,o);e.width=this.convertWidth(o.scroll.width),e.height=this.convertHeight(o.scroll.height),o.widget&&this.createWidget(e,Ro.parse(o.widget));var n=this.createNode(o.name+"_scroll",o),i=n.addComponent(cc.ScrollView);i.horizontal=!!o.scroll.horizontal,i.vertical=!!o.scroll.vertical,i.horizontalScrollBar=null,i.verticalScrollBar=null,n.width=this.convertWidth(o.scroll.width),n.height=this.convertHeight(o.scroll.height),e.addChild(n),o.layout.widget&&this.createWidget(n,o.layout.widget);var r=this.createNode(o.name+"_view");r.addComponent(cc.Mask),this.createWidget(r,new Ro(!0,!0,!0,!0,0,0,0,0)),n.addChild(r),o.layout.name=o.name+"_layout";var a=this.createLayout(r,Oo.parse(o.layout));return a.width=this.convertWidth(o.layout.width),a.height=this.convertHeight(o.layout.height),{viewContainer:e,layoutNode:i.content=a}},Vo.createWidget=function(t,o){var e=t.addComponent(cc.Widget);return e.isAlignLeft=o.isAlignLeft,e.isAlignTop=o.isAlignTop,e.isAlignRight=o.isAlignRight,e.isAlignBottom=o.isAlignBottom,e.left=o.left,e.top=o.top,e.right=o.right,e.bottom=o.bottom,e.updateAlignment(),t},Vo.addToSrcQuene=function(t,o,e){for(var n=!1,i=0;i<this.srcQuene.length;i++)if(this.srcQuene[i].node==t){n=!0,this.srcQuene[i]={node:t,imgCfg:o,callback:e};break}n||this.srcQuene.push({node:t,imgCfg:o,callback:e})},Vo.getSrcQuene=function(t){for(var o=null,e=0;e<this.srcQuene.length;e++)if(this.srcQuene[e].node==t){o=this.srcQuene[e];break}return o},Vo.applySrcQuene=function(t,o,e){var n=this.getSrcQuene(t);n&&n.imgCfg==e&&(this.updateSprite(t,o),this.checkSize(t,this.convertWidth(n.imgCfg.width),this.convertHeight(n.imgCfg.height)),this.setSpriteGrid(n.imgCfg,t),this.clearSrcQuene(t))},Vo.clearSrcQuene=function(t){for(var o=0;o<this.srcQuene.length;o++)this.srcQuene[o].node==t&&(this.srcQuene.splice(o,1),o--)},Vo.changeSrc=function(t,e,o){var n=this,i=t instanceof cc.Node?t.getComponent(cc.Sprite):t;if(this.addToSrcQuene(i,e,o),e.url)if(-1!=e.url.indexOf("http"))cc.loader.load(e.url,function(t,o){t?console.log(" cc.loader.load ",t):n.applySrcQuene(i,o,e)});else{var r=cc.loader.getRes(e.url);if(r)return void this.applySrcQuene(i,r,e);cc.loader.loadRes(e.url,cc.Texture2D,function(t,o){n.applySrcQuene(i,o,e)})}},Vo.updateSprite=function(t,o){var e=new cc.SpriteFrame(o);t.spriteFrame=e},Vo.checkSize=function(t,o,e){t.node.width!=o||t.node.height!=e?(t.node.width=o,t.node.height=e):this.unschedule(this.checkSize)},Vo.setSpriteGrid=function(t,o){t.grid&&(o.type=cc.Sprite.Type.SLICED,o.spriteFrame.insetLeft=t.grid.left,o.spriteFrame.insetTop=t.grid.top,o.spriteFrame.insetRight=t.grid.right,o.spriteFrame.insetBottom=t.grid.bottom)},Vo.changeText=function(t,o){var e;!t||(e=t.getComponent(cc.Label))&&(e.string=o)},Vo.createMask=function(t,o){void 0===o&&(o=void 0);var e=moosnow.form.formFactory.maskUrl,n=this.createNode("img_mask");n.addComponent(cc.Sprite),this.changeSrc(n,{url:e},function(){}),t.addChild(n),n.zIndex=-1,this.addStopPropagation(n)},Vo.addStopPropagation=function(t){m.isOnlyUI&&m.isPC||t&&t.on(Eo.TOUCH_START,this.onMaskMouseDown,this)},Vo.removeStopPropagation=function(t){t&&t.on(Eo.TOUCH_START,this.onMaskMouseDown,this)},Vo.onMaskMouseDown=function(t){console.log("阻止事件传递, node name ",t.getCurrentTarget().name),t.stopPropagation()},Vo.findNodeByName=function(t,o){for(var e=null,n=0;n<t.childrenCount;n++){var i=t.children[n];if(i.name==o){e=i;break}var r=this.findNodeByName(i,o);if(r){e=r;break}}return e},Vo.convertWidth=function(t){var o=this.canvasNode.width;return isNaN(t)?o:parseInt(""+t)},Vo.convertHeight=function(t){var o=this.canvasNode.height;return isNaN(t)?o:parseInt(""+t)},Vo.convertIndex=function(t){return isNaN(t)?0:parseInt(""+t)},Vo.srcQuene=[],Vo);function Vo(){return null!==Po&&Po.apply(this,arguments)||this}var Ho,Uo=(t(Wo,Ho=po),Wo.parse=function(t){return c(c({},new Wo),t)},Wo);function Wo(){var t=null!==Ho&&Ho.apply(this,arguments)||this;return t.horizontalAlign="center",t.color="#ffffff",t.fontSize=32,t.lineHeight=32,t.text="",t}var Qo,zo=(t(jo,Qo=po),jo.parse=function(t){return c(c({},new jo),t)},jo);function jo(){var t=null!==Qo&&Qo.apply(this,arguments)||this;return t.mode=cc.ProgressBar.Mode.HORIZONTAL,t}var Go,qo=(t(Ko,Go=po),Ko);function Ko(){var t=null!==Go&&Go.apply(this,arguments)||this;return t.horizontal=!0,t.vertical=!0,t}var Xo,Zo=(t(Yo,Xo=po),Yo.parse=function(t){return c(c({},new Yo),t)},Yo);function Yo(){var t=null!==Xo&&Xo.apply(this,arguments)||this;return t.scroll=new qo,t.layout=new Oo,t}var Jo=($o.image="image",$o.progressBar="progressBar",$o.text="text",$o.layout="layout",$o.view="view",$o.widget="widget",$o);function $o(){}var te,oe=(t(ee,te=go),ee.prototype._createChild=function(t,o){for(var e=0;e<o.length;e++){var n=o[e];this.createNode(t,n)}},ee.prototype.createNode=function(t,o){var e=null,n=null;return o.type==Jo.progressBar?(n=zo.parse(o),e=Mo.createProgressBar(t,n),n.child&&1<n.child.length&&(n.child.splice(0,1),this._createChild(e,n.child))):(o.type==Jo.view?(n=Zo.parse(o),e=Mo.createView(t,n).viewContainer):(e=o.type==Jo.text?(n=Uo.parse(o),Mo.createText(t,n)):o.type==Jo.layout?(n=Oo.parse(o),Mo.createLayout(t,n)):o.type==Jo.widget?(n=Ro.parse(o),Mo.createWidget(t,n)):(n=po.parse(o),Mo.createImage(t,n)),o.widget&&Mo.createWidget(e,Ro.parse(o.widget))),n.child&&0<n.child.length&&this._createChild(e,n.child)),e},ee.prototype._createUINode=function(t,o,e,n){n=n||Mo.canvasNode;var i=this.createNode(n,t);t.isMask&&Mo.createMask(i,t.maskUrl);var r=new o;return r.initForm(i),this.logicShow(r,i,e),this.addForm2Quene(t.name,i,r),i},ee.prototype.hideFormByLogic=function(t,o){var e=this;this.removeFormByLogic(t,function(t){t instanceof Array?t.forEach(function(t){e.logicHide(t.formLogic,t.formNode,o)}):e.logicHide(t.formLogic,t.formNode,o)})},ee.prototype.logicShow=function(t,o,e){m.isOnlyUI&&m.isPC?console.warn("UI编辑模式，取消业务逻辑"):(t.willShow(e),o.active=!0,t.onShow(e))},ee.prototype.logicHide=function(t,o,e){m.isOnlyUI&&m.isPC?console.warn("UI编辑模式，取消业务逻辑"):(t.willHide(e),o.active=!0,t.onHide(e),o.x=0,o.y=0,o.removeFromParent())},ee.prototype.hideForm=function(t,o,e){var n=this;o?this.removeFormFromQuene(t,o,function(t){n.logicHide(t.formLogic,t.formNode,e)}):this.removeAllFormFromQuene(t,function(t){n.logicHide(t.formLogic,t.formNode,e)})},ee.prototype.showForm=function(n){var t,o,i=this;n.showOnce&&this.hasFormInQuene(n.name)||(n.parent||(n.parent=Mo.canvasNode),(t=this.getFormFromCached(n.name))?(n.parent.addChild(t.formNode),this.logicShow(t.formLogic,t.formNode,n.formData),this.addForm2Quene(n.name,t.formNode,t.formLogic)):n.remoteLayout?this.getLayout(function(t){var o,e;t[n.name]&&((o=t[n.name]).name=n.name,e=i._createUINode(o,n.formLogic,n.formData,n.parent),n.callback&&n.callback(e))}):(o=this._createUINode(n.layoutOptions,n.formLogic,n.formData),n.callback&&n.callback(o)))},ee.prototype.createNodeByTemplate=function(n,i,r,a,t,o){var s=this;void 0===t&&(t=!0),void 0===o&&(o=null),a=a||Mo.canvasNode;var e=this.getFormFromCached(n);e?(a.addChild(e.formNode),this.logicShow(e.formLogic,e.formNode,r),this.addForm2Quene(n,e.formNode,e.formLogic)):t?this.getTemplates(function(t){var o,e=t[n];e&&((o=po.parse(e)).name=n,s._createUINode(o,i,r,a))}):this._createUINode(o,i,r)},ee.prototype.hideNodeByTemplate=function(t,o,e){var n=this;o?this.removeFormFromQuene(t,o,function(t){n.logicHide(t.formLogic,t.formNode,e)}):this.removeAllFormFromQuene(t,function(t){n.logicHide(t.formLogic,t.formNode,e)})},ee.prototype.getTemplate=function(t,o){te.prototype.getTemplate.call(this,t,function(t){t.width=Mo.convertWidth(t.width),t.height=Mo.convertHeight(t.height),o&&o(t)})},ee);function ee(){return null!==te&&te.apply(this,arguments)||this}var ne,ie=(t(re,ne=Ao),re.prototype.downAnim=function(t){t.scale=1,t.runAction(cc.sequence(cc.scaleTo(.1,.7,.7),cc.callFunc(function(){},this)))},re.prototype.upAnim=function(t,o){var e=this;t.stopAllActions(),t.scale=.7,t.runAction(cc.sequence(cc.scaleTo(.1,1,1),cc.callFunc(function(){e.mDowning=!1,o&&o()},this)))},re.prototype.getClickQueneItem=function(t){var o=t.getCurrentTarget().uuid,e=this.mClickQuene[o];return e||null},re.prototype.setClickQueneItem=function(t,o){var e=t.getCurrentTarget().uuid;this.mClickQuene[e]&&(this.mClickQuene[e].clicking=o)},re.prototype.onTouchStart=function(t){var o=this.getClickQueneItem(t);o&&(o.once&&o.clicking||(moosnow.audio.playClickEffect(),this.downAnim(o.node),this.mDowning||(this.mDowning=!0)))},re.prototype.onTouchEnd=function(t){var o=this,e=this.getClickQueneItem(t);e&&(e.once&&e.clicking||(this.setClickQueneItem(t,!0),console.log("onTouchEnd"),this.upAnim(e.node,function(){e&&e.callback&&e.callback(),o.setClickQueneItem(t,!1)}),e&&e.stopPropagation&&t.stopPropagation()))},re.prototype.onTouchCancel=function(t){var o=this,e=this.getClickQueneItem(t);e&&(console.log("onTouchCancel"),this.upAnim(e.node,function(){o.setClickQueneItem(t,!1)}))},re.prototype.applyClickAnim=function(t,o,e,n){void 0===e&&(e=!1),void 0===n&&(n=!0),m.isOnlyUI&&m.isPC||(t&&t.uuid?(this.mClickQuene[t.uuid]={node:t,stopPropagation:e,callback:o,once:n,clicking:!1},t.on(Eo.TOUCH_START,this.onTouchStart,this),t.on(Eo.TOUCH_END,this.onTouchEnd,this),t.on(Eo.TOUCH_CANCEL,this.onTouchCancel,this)):console.log("缺少对象，无法绑定事件"))},re.prototype.removeClickAnim=function(t){t&&t.uuid&&(this.mClickQuene[t.uuid]=null,delete this.mClickQuene[t.uuid],t.off(Eo.TOUCH_START,this.onTouchStart,this),t.off(Eo.TOUCH_END,this.onTouchEnd,this),t.off(Eo.TOUCH_CANCEL,this.onTouchCancel,this))},re.prototype.findNodeByName=function(t,o){return Mo.findNodeByName(t,o)},re);function re(){var t=null!==ne&&ne.apply(this,arguments)||this;return t.mDowning=!1,t.mClickQuene={},t}var ae,se=(t(le,ae=ie),Object.defineProperty(le.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),le.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnBack,function(){t.onBack()}),this.applyClickAnim(this.btnContinue,function(){t.onBack()})},le.prototype.removeListener=function(){this.removeClickAnim(this.btnBack)},le.prototype.willShow=function(t){ae.prototype.willShow.call(this,t),moosnow.platform.stopRecord(function(){var o=moosnow.platform.getSystemInfoSync();moosnow.http.getAllConfig(function(t){moosnow.platform.showShareButton({left:o.windowWidth-t.shareBtnWidth,top:o.windowHeight-70})}),moosnow.platform.hideBanner(),moosnow.platform.hideShareButton()})},le.prototype.onShow=function(t){this.addListener()},le.prototype.willHide=function(){this.removeListener()},le.prototype.onBack=function(){this.hideForm(),this.FormData.callback&&this.FormData.callback()},le);function le(){var t=null!==ae&&ae.apply(this,arguments)||this;return t.btnBack=null,t.btnContinue=null,t}var ce,he=(t(de,ce=ie),Object.defineProperty(de.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),de.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnContinue,function(){t.onContinue()}),this.applyClickAnim(this.btnHome,function(){t.onToHome()}),this.applyClickAnim(this.btnReplay,function(){t.onReplay()})},de.prototype.removeListener=function(){this.removeClickAnim(this.btnContinue),this.removeClickAnim(this.btnHome),this.removeClickAnim(this.btnReplay)},de.prototype.willShow=function(t){ce.prototype.willShow.call(this,t),this.addListener(),moosnow.platform.hideBanner()},de.prototype.willHide=function(t){ce.prototype.willHide.call(this,t),this.removeListener()},de.prototype.onShow=function(t){ce.prototype.onShow.call(this,t),moosnow.platform.pauseRecord()},de.prototype.onContinue=function(){this.hideForm(),this.FormData.callback&&this.FormData.callback()},de.prototype.onToHome=function(){this.hideForm(),moosnow.platform.stopRecord(),this.FormData.homeCallback&&this.FormData.homeCallback()},de.prototype.onReplay=function(){this.hideForm(),moosnow.platform.stopRecord(function(){moosnow.platform.startRecord()}),this.FormData.replayCallback&&this.FormData.replayCallback()},de);function de(){var t=null!==ce&&ce.apply(this,arguments)||this;return t.btnContinue=null,t.btnHome=null,t.btnReplay=null,t.isMask=!1,t}var pe,me=(t(ue,pe=ie),ue);function ue(){return null!==pe&&pe.apply(this,arguments)||this}var fe,we=(t(ge,fe=me),ge.prototype.addListener=function(){var t=this;this[this.uncheckedName]&&this.applyClickAnim(this[this.uncheckedName],function(){t.checkToggle()}),this[this.checkedName]&&this.applyClickAnim(this[this.checkedName],function(){t.checkToggle()})},ge.prototype.removeListener=function(){this[this.checkedName]&&this.removeClickAnim(this[this.checkedName]),this[this.uncheckedName]&&this.removeClickAnim(this[this.uncheckedName])},ge.prototype.onReceive=function(){var o=this;this.mCheckedVideo?moosnow.platform.showVideo(function(t){t==y.END?o.FormData.videoCallback&&o.FormData.videoCallback():t==y.ERR?moosnow.form.showToast(zt.ERR):moosnow.form.showToast(zt.NOTEND)}):this.FormData.callback&&this.FormData.callback()},ge.prototype.checkToggle=function(){if(this.mCheckBoxMistouch)return this.mClickNum++,this.mClickNum==this.mCheckBoxVideoNum&&moosnow.platform.showVideo(function(){}),this.mClickNum>=this.mCanNum&&(this.mCheckedVideo=!this.mCheckedVideo,this.updateCheckbox()),void this.checkCallback();this.mCheckedVideo=!this.mCheckedVideo,this.updateCheckbox(),this.checkCallback()},ge.prototype.onShow=function(t){var o=this;fe.prototype.onShow.call(this,t),moosnow.http.getAllConfig(function(t){o.mCanNum=s.probabilitys(t.checkBoxProbabilitys)+1,o.mCheckBoxVideoNum=t&&!isNaN(t.checkBoxVideoNum)?t.checkBoxVideoNum:3,o.mCheckBoxMistouch=1==t.checkBoxMistouch}),this.addListener(),this.updateCheckbox(),this.checkCallback()},ge.prototype.updateCheckbox=function(){this[this.checkedName]&&(this[this.checkedName].active=this.mCheckedVideo),this[this.uncheckedName]&&(this[this.uncheckedName].active=!this.mCheckedVideo)},ge.prototype.checkCallback=function(){this.toggleCallback&&this.toggleCallback(this.mCheckedVideo)},ge.prototype.willHide=function(){this.removeListener()},ge);function ge(t,o,e,n){void 0===t&&(t=!0);var i=fe.call(this)||this;return i.checkedName="checked",i.uncheckedName="unchecked",i.mCheckedVideo=!0,i.mCanNum=0,i.mCheckBoxMistouch=!1,i.mClickNum=0,i.mCheckBoxVideoNum=3,i.toggleCallback=o,i.mCheckedVideo=t,e&&(i.checkedName=e),n&&(i.uncheckedName=n),i[i.checkedName]=null,i[i.uncheckedName]=null,i}var ve,ye=(t(be,ve=ie),Object.defineProperty(be.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),be.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnContinue,function(){t.onReceive()})},be.prototype.removeListener=function(){this.removeClickAnim(this.btnContinue)},be.prototype.onReceive=function(){var o=this;this.mCheckedVideo?moosnow.platform.showVideo(function(t){t==moosnow.VIDEO_STATUS.END?(o.hideForm(),o.FormData.videoCallback&&o.FormData.videoCallback()):t==moosnow.VIDEO_STATUS.ERR?moosnow.form.showToast(zt.ERR):moosnow.form.showToast(zt.NOTEND)}):this.FormData.callback&&this.FormData.callback()},be.prototype.onShow=function(t){ve.prototype.onShow.call(this,t),this.mLevelCoinNum=this.FormData.coinNum,this.mLevelShareCoinNum=this.FormData.coinNum,this.videoText.getComponent(cc.Label).string=""+this.FormData.videoText,this.coinNum.getComponent(cc.Label).string=""+m.formatMoney(this.mLevelCoinNum),this.addListener(),moosnow.platform.stopRecord(),moosnow.platform.showBanner()},be.prototype.willHide=function(t){ve.prototype.willHide.call(this,t),this.removeListener(),moosnow.platform.hideBanner()},be);function be(){var o=null!==ve&&ve.apply(this,arguments)||this;return o.checked=null,o.unchecked=null,o.btnContinue=null,o.coinNum=null,o.videoText=null,o.mCheckedVideo=!1,o.formComponents=[new we(o.mCheckedVideo,function(t){o.mCheckedVideo=t})],o.mLevelCoinNum=0,o.mLevelShareCoinNum=0,o}var Ce,Ne=(t(Ae,Ce=ie),Ae.prototype.onMaskMouseDown=function(t){t.stopPropagation()},Ae.prototype.willShow=function(t){Ce.prototype.willShow.call(this),this.node.on(Eo.TOUCH_START,this.onMaskMouseDown,this),this.node.zIndex=cc.macro.MAX_ZINDEX,this.msgText.getComponent(cc.Label).string=t,this.node.active=!0,this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))),this.scheduleOnce(this.hide,1)},Ae.prototype.willHide=function(t){Ce.prototype.willHide.call(this,t),this.node.off(Eo.TOUCH_START,this.onMaskMouseDown,this)},Ae.prototype.hide=function(){this.hideForm()},Ae);function Ae(){var t=null!==Ce&&Ce.apply(this,arguments)||this;return t.msgText=null,t}var Se,Ie=(t(_e,Se=ie),Object.defineProperty(_e.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),_e.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnVideo,function(){t.onVideoTry()}),this.applyClickAnim(this.btnNext,function(){t.onNext()}),this.applyClickAnim(this.btnTry,function(){t.onTextTry()})},_e.prototype.removeListener=function(){this.removeClickAnim(this.btnVideo),this.removeClickAnim(this.btnNext),this.removeClickAnim(this.btnTry)},_e.prototype.onShow=function(t){Se.prototype.onShow.call(this,t),Mo.changeSrc(this.logo,{url:this.FormData.skinUrl,width:this.logo.width,height:this.logo.height}),this.addListener()},_e.prototype.onHide=function(t){Se.prototype.onHide.call(this,t),this.removeListener()},_e.prototype.onVideoTry=function(){var o=this;moosnow.platform.showVideo(function(t){t==y.END?(o.hideForm(),o.FormData.videoCallback&&o.FormData.videoCallback()):t==y.ERR?moosnow.form.showToast(zt.ERR):t==y.NOTEND&&moosnow.form.showToast(zt.NOTEND)})},_e.prototype.onNext=function(){this.hideForm(),this.FormData.callback&&this.FormData.callback()},_e.prototype.onTextTry=function(){this.mCheckedVideo?this.onVideoTry():this.onNext()},_e);function _e(){var o=null!==Se&&Se.apply(this,arguments)||this;return o.logo=null,o.btnVideo=null,o.btnNext=null,o.btnTry=null,o.mCheckedVideo=!1,o.formComponents=[new we(o.mCheckedVideo,function(t){o.mCheckedVideo=t,o.btnNext&&(o.btnNext.active=t),o.btnTry&&(o.btnTry.active=!t)})],o}var Te,ke=(t(Ee,Te=ie),Object.defineProperty(Ee.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Ee.prototype.addListener=function(){this.node.on(Eo.TOUCH_START,this.hideForm,this),Mo.addStopPropagation(this.bg)},Ee.prototype.removeListener=function(){this.node.off(Eo.TOUCH_START,this.hideForm,this),Mo.removeStopPropagation(this.bg)},Ee.prototype.willShow=function(t){Te.prototype.willShow.call(this,t),this.addListener()},Ee.prototype.willHide=function(t){Te.prototype.willShow.call(this,t),this.removeListener()},Ee.prototype.vibrateSwitch=function(t){moosnow.data.setVibrateSetting(t),this.FormData.vibrateCallback&&this.FormData.vibrateCallback(t)},Ee.prototype.musicSwitch=function(t){moosnow.audio.isMute=t,this.FormData.musicCallback&&this.FormData.musicCallback(t)},Ee);function Ee(){var o=null!==Te&&Te.apply(this,arguments)||this;return o.bg=null,o.formComponents=[new we(moosnow.data.getVibrateSetting(),function(t){o.vibrateSwitch(t)},"vibrateOn","vibrateOff"),new we(moosnow.audio.isMute,function(t){o.musicSwitch(t)},"musicOn","musicOff")],o}var Le,Be=(t(Oe,Le=ie),Object.defineProperty(Oe.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Oe.prototype.willShow=function(t){Le.prototype.willShow.call(this,t),this.initItem(t),this.addListener()},Oe.prototype.willHide=function(t){Le.prototype.willHide.call(this,t),this.removeListener()},Oe.prototype.addListener=function(){var t=this;this.applyClickAnim(this.node,function(){t.onCheck()}),moosnow.event.addListener(b.PRIZE_BOX_UNLOCAK,this,this.onCheckChange)},Oe.prototype.removeListener=function(){this.removeClickAnim(this.node),moosnow.event.removeListener(b.PRIZE_BOX_UNLOCAK,this)},Oe.prototype.initItem=function(t){this.coinNum.active=0<t.coinNum;var o=moosnow.data.getUserPrizeBoxById(t.idx);o?(this.coinNum.getComponent(cc.Label).string=""+m.formatMoney(o.coinNum),this.opend.active=!0,this.lockd.active=!1,this.video.active=!1):(this.opend.active=!1,this.lockd.active=!0,this.video.active=this.FormData.isVideo),this.checkdBg.active=!1},Oe.prototype.onCheckChange=function(t){var o=moosnow.data.getUserPrizeBoxById(this.FormData.idx);o?(this.coinNum.active=!0,this.coinNum.getComponent(cc.Label).string=""+m.formatMoney(o.coinNum),this.opend.active=!0,this.lockd.active=!1,this.video.active=!1):(this.coinNum.active=!1,this.video.active=this.FormData.isVideo,this.opend.active=!1,this.lockd.active=!0)},Oe.prototype.onCheck=function(){var o=this;this._opening||(this._opening=!0,this.FormData.videoNum?moosnow.platform.showVideo(function(t){switch(o._opening=!1,t){case y.NOTEND:moosnow.form.showToast(zt.NOTEND);break;case y.ERR:moosnow.form.showToast(zt.ERR);break;case y.END:moosnow.data.lockPrizeBox(o.FormData.idx,1,o.FormData.coinNum),moosnow.event.sendEventImmediately(b.PRIZE_BOX_UNLOCAK,o.FormData)}}):(0<moosnow.data.getPrizeKey()?(moosnow.data.addPrizeKey(-1),moosnow.data.lockPrizeBox(this.FormData.idx,0,this.FormData.coinNum)):(this._opening=!1,moosnow.form.showToast("钥匙不足")),moosnow.event.sendEventImmediately(b.PRIZE_BOX_UNLOCAK,this.FormData)))},Oe);function Oe(){var t=null!==Le&&Le.apply(this,arguments)||this;return t.checkdBg=null,t.opend=null,t.lockd=null,t.video=null,t.coinNum=null,t._opening=!1,t}var Fe,xe=(t(Re,Fe=ie),Object.defineProperty(Re.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Re.prototype.onShow=function(t){console.log("this.mTryFromVideo 1 ",this.mTryFromVideo),Fe.prototype.onShow.call(this,t),this.boxLayout.getComponent(cc.Layout).type=cc.Layout.Type.GRID,console.log("this.mTryFromVideo 2 ",this.mTryFromVideo),this.btnNext.active=!this.mTryFromVideo,this.btnReceive.active=this.mTryFromVideo;for(var o=0,e=0;e<this.FormData.rowNum;e++)for(var n=0;n<this.FormData.colNum;n++){var i=m.randomNumBoth(this.FormData.coinNum[0],this.FormData.coinNum[1]),r=m.randomNumBoth(this.FormData.videoCoinNum[0],this.FormData.videoCoinNum[1]),a=this.FormData.videoNum&&-1!=this.FormData.videoNum.indexOf(o);moosnow.form.formFactory.createNodeByTemplate("boxItem",Be,{coinNum:i,videoCoinNum:r,isVideo:a,idx:o},this.boxLayout),o++}this.addListener(),this.updateKeyNum()},Re.prototype.onHide=function(t){Fe.prototype.onHide.call(this,t),moosnow.form.formFactory.hideNodeByTemplate("boxItem",null),this.removeListener()},Re.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnNext,function(){t.nextForm()}),this.applyClickAnim(this.btnReceive,function(){t.onReceive()}),moosnow.event.addListener(b.PRIZE_BOX_UNLOCAK,this,this.onPrizeBoxUnLock)},Re.prototype.removeListener=function(){this.removeClickAnim(this.btnNext),this.removeClickAnim(this.btnReceive),moosnow.event.removeListener(b.PRIZE_BOX_UNLOCAK,this)},Re.prototype.onPrizeBoxUnLock=function(t){this.btnReceive.active=!0,this.updateKeyNum(),this.FormData.openCallback&&this.FormData.openCallback(t.coinNum)},Re.prototype.onReceive=function(){var o=this;this._Receiveing||(this._Receiveing=!0,this.mTryFromVideo?(this._Receiveing=!1,moosnow.platform.showVideo(function(t){switch(t){case y.NOTEND:moosnow.form.showToast(zt.NOTEND);break;case y.ERR:moosnow.form.showToast(zt.ERR);break;case y.END:moosnow.data.addPrizeKey(3),o.updateKeyNum()}})):this.nextForm())},Re.prototype.nextForm=function(){moosnow.data.clearPrizeBox(),moosnow.data.clearPrizeKey(),this._Receiveing=!1,this.hideForm(),this.FormData.callback&&this.FormData.callback()},Re.prototype.updateKeyNum=function(){this.keyNum.getComponent(cc.Label).string=""+moosnow.data.getPrizeKey()},Re);function Re(){var o=null!==Fe&&Fe.apply(this,arguments)||this;return o.boxLayout=null,o.btnReceive=null,o.btnNext=null,o.keyNum=null,o.mTryFromVideo=!0,o.formComponents=[new we(o.mTryFromVideo,function(t){o.mTryFromVideo=t,o.btnNext.active=!t,o.btnReceive.active=t})],o._Receiveing=!1,o}var De,Pe=(t(Me,De=ie),Object.defineProperty(Me.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Me.prototype.onShow=function(t){De.prototype.onShow.call(this,t),this.addListener(),this.coinNum.getComponent(cc.Label).string=""+m.formatMoney(this.FormData.shareCoinNum)},Me.prototype.onHide=function(t){De.prototype.onHide.call(this,t),this.removeListener()},Me.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnShare,function(){t.onShareVideo()}),this.applyClickAnim(this.btnNext,function(){t.onNext()})},Me.prototype.removeListener=function(){this.removeClickAnim(this.btnShare),this.removeClickAnim(this.btnNext)},Me.prototype.onNext=function(){this.hideForm(),this.FormData.callback&&this.FormData.callback()},Me.prototype.onShareVideo=function(){var e=this;moosnow.http.getAllConfig(function(t){var o;t&&1!=t.shareFormVideo?2==t.shareFormVideo?e.onShare():(o=t&&t.shareFormVideoPrecent?parseFloat(t.shareFormVideoPrecent):.5,m.randomNumBoth(0,100)/100<o?e.onVideo():e.onShare()):e.onVideo()})},Me.prototype.onVideo=function(){var o=this;moosnow.platform.showVideo(function(t){t==moosnow.VIDEO_STATUS.END?(o.hideForm(),o.FormData.shareCallback&&o.FormData.shareCallback(!0)):t==moosnow.VIDEO_STATUS.NOTEND?moosnow.form.showToast(moosnow.VIDEO_MSG.NOTEND):moosnow.form.showToast(moosnow.VIDEO_MSG.ERR)})},Me.prototype.onShare=function(){var o=this;moosnow.platform.share({channel:moosnow.SHARE_CHANNEL.VIDEO},function(t){o.hideForm(),o.FormData.shareCallback&&o.FormData.shareCallback(t),console.log("分享结束",t)},function(t){o.hideForm(),o.FormData.shareCallback&&o.FormData.shareCallback(t)})},Me);function Me(){var t=null!==De&&De.apply(this,arguments)||this;return t.btnShare=null,t.btnNext=null,t.coinNum=null,t}var Ve,He=(t(Ue,Ve=ie),Ue.prototype.addEvent=function(){this.btnReceive.on(Eo.TOUCH_START,this.onLogoUp,this),this.btnReceive.on(Eo.TOUCH_END,this.onBannerClick,this)},Ue.prototype.removeEvent=function(){this.btnReceive.off(Eo.TOUCH_START,this.onLogoUp,this),this.btnReceive.off(Eo.TOUCH_END,this.onBannerClick,this),moosnow.event.removeListener(b.ON_PLATFORM_SHOW,this)},Ue.prototype.onLogoUp=function(){this.logo.position=this.mEndPos},Ue.prototype.onLogoDown=function(){this.logo.position=this.mBeginPos},Ue.prototype.initPos=function(){this.mBeginPos=this.logo.position.clone(),this.mEndPos=this.mBeginPos.add(new cc.Vec2(0,50))},Object.defineProperty(Ue.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),Ue.prototype.willShow=function(t){var o=this;Ve.prototype.willShow.call(this,t),this.btnReceive.active=!0,this.initPos(),this.mCurrentNum=0,this.mNavigateIndex=m.randomNumBoth(3,this.mMaxNum-2),this.addEvent(),this.schedule(this.subProgress,.1),moosnow.form.showAd(eo.NONE,null),Mo.changeSrc(this.logo,{url:this.FormData.url,width:this.logo.width,height:this.logo.height}),this.mBannerShow=!1,moosnow.http.getAllConfig(function(t){o.mBannerClickType=t.bannerClickType}),this.schedule(this.onFwUpdate,.16)},Ue.prototype.willHide=function(){this.unschedule(this.subProgress),this.unschedule(this.resetProgress),this.removeEvent(),this.unschedule(this.onFwUpdate)},Ue.prototype.subProgress=function(){this.mCurrentNum-=.1,this.mCurrentNum<0&&(this.mCurrentNum=0)},Ue.prototype.bannerClickCallback=function(t){t&&(this.unschedule(this.onHideBanner),this.unschedule(this.resetProgress),moosnow.platform.hideBanner(),this.mBannerShow=!1,this.hideForm(),this.FormData&&this.FormData.callback&&this.FormData.callback())},Ue.prototype.onBannerClick=function(){var o=this;this.onLogoDown(),this.mCurrentNum+=1,this.mCurrentNum>=this.mNavigateIndex&&(this.mBannerShow||(this.mShowTime=Date.now(),this.mBannerShow=!0,moosnow.platform.showBanner(!0,function(t){console.log("banner click callback ",t),o.bannerClickCallback(t)}),1==this.mBannerClickType?(this.unschedule(this.onHideBanner),this.scheduleOnce(this.onHideBanner,2)):2==this.mBannerClickType&&(this.unschedule(this.resetProgress),this.scheduleOnce(this.resetProgress,2)))),this.mCurrentNum>=this.mMaxNum&&(moosnow.platform.hideBanner(),this.mBannerShow=!1,this.hideForm(),this.FormData&&this.FormData.callback&&this.FormData.callback(!0))},Ue.prototype.resetProgress=function(){this.mCurrentNum=0,moosnow.platform.hideBanner(),this.mBannerShow=!1},Ue.prototype.onHideBanner=function(){moosnow.platform.hideBanner()},Ue.prototype.onFwUpdate=function(){this.clickProgress.getComponent(cc.ProgressBar).progress=this.mCurrentNum/this.mMaxNum},Ue);function Ue(){var t=null!==Ve&&Ve.apply(this,arguments)||this;return t.clickProgress=null,t.btnReceive=null,t.logo=null,t.mMaxNum=10,t.mCurrentNum=0,t.mNavigateIndex=0,t.mBannerShow=!1,t.mShowTime=0,t.mBannerClickType=0,t}var We,Qe=(t(ze,We=ie),ze.prototype.addListener=function(){this.logo.on(Eo.TOUCH_END,this.onClickAd,this)},ze.prototype.removeListener=function(){this.logo.off(Eo.TOUCH_END,this.onClickAd,this)},ze.prototype.initPosition=function(t){},ze.prototype.willShow=function(t){We.prototype.willShow.call(this,t),this.mAdItem=t,this.addListener()},ze.prototype.refreshImg=function(t){this.mAdItem=t,this.updateUI()},ze.prototype.updateUI=function(){var t=this,o=this.logo,e=o.width,n=o.height;Mo.changeSrc(this.logo,{url:this.mAdItem.img,width:e,height:n},function(){t.logo.width=e,t.logo.height=n}),Mo.changeText(this.title,this.mAdItem.title)},ze.prototype.onClickAd=function(){var t,o=this,e=this.mAdItem;this.FormData&&this.FormData.refresh&&(t=this.findNextAd())&&(t.refresh&&moosnow.event.sendEventImmediately(b.AD_VIEW_REFRESH,{current:e,next:t}),this.refreshImg(t)),moosnow.platform.navigate2Mini(e,function(){},function(){o.mAdItem&&o.mAdItem.onCancel&&o.mAdItem.onCancel(e)})},ze.prototype.findNextAd=function(){if(!this.FormData.source)return null;if(!this.FormData.showIds)return null;for(var t=0;t<this.FormData.source.length;t++){for(var o=!1,e=0;e<this.FormData.showIds.length;e++)this.FormData.showIds[e].appid==this.FormData.source[t].appid&&this.FormData.showIds[e].position==this.FormData.source[t].position&&(o=!0);if(!o)return this.FormData.source[t]}return null},ze.prototype.onAdViewChange=function(t){if(this.FormData.showIds&&this.FormData.source){for(var o=t.current,e=t.next,n=this.FormData.showIds,i=this.FormData.source,r=0;r<n.length;r++)o.appid==n[r].appid&&o.position==n[r].position&&(this.FormData.showIds[r]=e.appid);for(r=0;r<i.length;r++)if(e.appid==i[r].appid){this.FormData.source.splice(r,1),this.FormData.source.push(o);break}}},ze.prototype.onShow=function(t){We.prototype.onShow.call(this,t),this.updateUI(),moosnow.event.addListener(b.AD_VIEW_REFRESH,this,this.onAdViewChange)},ze.prototype.onHide=function(t){We.prototype.onHide.call(this,t),this.mAdItem&&(this.mAdItem.onCancel=null),this.removeListener(),moosnow.event.removeListener(b.AD_VIEW_REFRESH,this)},ze);function ze(){var t=null!==We&&We.apply(this,arguments)||this;return t.logo=null,t.title=null,t.animLogo=null,t.nameBg=null,t}var je,Ge=(t(qe,je=ie),qe.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnBack,function(){t.onBack()}),this.applyClickAnim(this.exportClose,function(){t.onNavigate()}),this.applyClickAnim(this.btnSideShow,function(){t.sideOut()}),this.applyClickAnim(this.btnSideHide,function(){t.sideIn()}),moosnow.event.addListener(b.AD_VIEW_CHANGE,this,this.onAdChange)},qe.prototype.removeListener=function(){this.removeClickAnim(this.btnBack),this.removeClickAnim(this.exportClose),this.removeClickAnim(this.btnSideShow),this.removeClickAnim(this.btnSideHide),moosnow.event.removeListener(b.AD_VIEW_CHANGE,this)},qe.prototype.onAdChange=function(t){this.displayAd(!1),this.mTempPoints=t&&t.points?t.points:null,this.mTempTempletes=t&&t.templetes?t.templetes:null,this.mShowAd||(this.mShowAd=t.showAd,this.mBackCall=t.callback),t.showAd!=eo.RECOVER&&(this.mPrevShowAd=this.mShowAd,this.mPrevBackCall=this.mBackCall),t.showAd==eo.RECOVER&&(t.showAd=this.mPrevShowAd,t.callback=this.mPrevBackCall),this.displayChange(t.showAd,t.callback),isNaN(t.zIndex)?this.node.zIndex=cc.macro.MAX_ZINDEX:this.node.zIndex=t.zIndex},qe.prototype.onBack=function(){this.mBackCall&&this.mBackCall()},Object.defineProperty(qe.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),qe.prototype.loadAd=function(o){var e=this;this.mAdData?o(this.mAdData.indexLeft):(this.loadNum=0,moosnow.form.formFactory.getLayout(function(){e.checkLoad(o)}),moosnow.form.formFactory.getTemplates(function(){e.checkLoad(o)}),moosnow.ad.getAd(function(t){e.mAdData=t,e.checkLoad(o)}))},qe.prototype.onAdCancel=function(){moosnow.form.showAd(eo.EXPORT|eo.MASK|eo.BACK,function(){moosnow.form.showAd(eo.RECOVER,function(){})})},qe.prototype.checkLoad=function(t){this.loadNum++,this.loadNum==this.loadManNum&&t(this.mAdData.indexLeft)},qe.prototype.onRandomNavigate=function(){var t=this.mAdData.indexLeft[m.randomNumBoth(0,this.mAdData.indexLeft.length-1)];moosnow.platform.navigate2Mini(t,function(){},function(){})},qe.prototype.onNavigate=function(){var o=this;moosnow.http.getAllConfig(function(t){t&&1==t.exportBtnNavigate?o.onRandomNavigate():o.onBack()})},qe.prototype.sideOut=function(){var t=this,o=moosnow.platform.getSystemInfoSync(),e=0,n=0;o&&(e=o.statusBarHeight||0,n=o.notchHeight||0),this.sideView.node.runAction(cc.sequence(cc.moveTo(1,e+n+this.sideView.node.width+20,0),cc.callFunc(function(){t.btnSideShow.active=!1,t.btnSideHide.active=!0})))},qe.prototype.sideIn=function(){var t=this;this.sideView.node.runAction(cc.sequence(cc.moveTo(1,0,0),cc.callFunc(function(){t.btnSideShow.active=!0,t.btnSideHide.active=!1})))},qe.prototype.pushScroll=function(t,o){o.type==cc.Layout.Type.GRID?t.vertical?this.mScrollVec.push({scrollView:t,move2Up:!1}):this.mScrollVec.push({scrollView:t,move2Left:!1}):o.type==cc.Layout.Type.HORIZONTAL?this.mScrollVec.push({scrollView:t,move2Left:!1}):o.type==cc.Layout.Type.VERTICAL&&this.mScrollVec.push({scrollView:t,move2Up:!1})},qe.prototype.addAd=function(t){this.mShowAd|=t},qe.prototype.removeAd=function(t){this.hasAd(t)&&(this.mShowAd^=t)},qe.prototype.hasAd=function(t){return(this.mShowAd&t)==t},qe.prototype.showClose=function(t){this.exportClose.active=!1,this.exportCloseTxt.active=!1,this.btnBack.active=!1,this.unschedule(this.onWaitShow),t&&this.hasAd(eo.BACK)?this.hasAd(eo.WAIT)?(this.mSecond=3,this.onWaitShow(),this.schedule(this.onWaitShow,1)):(this.exportClose.active=!0,this.btnBack.active=!0,this.exportCloseTxt.active=!1):(this.exportClose.active=!1,this.btnBack.active=!1,this.exportCloseTxt.active=!1)},qe.prototype.onWaitShow=function(){if(--this.mSecond,this.exportCloseTxt.active=!0,this.mSecond<=0)return this.exportClose.active=!0,this.btnBack.active=!0,this.exportCloseTxt.active=!1,void this.unschedule(this.onWaitShow);Mo.changeText(this.exportCloseTxt,"剩余"+this.mSecond+"秒可关闭")},qe.prototype.setPosition=function(t,o,e,n){void 0===o&&(o=""),void 0===n&&(n=!1);var i=m.deepCopy(t);return i.forEach(function(t){t.position=o,t.onCancel=e,t.refresh=n}),i},qe.prototype.initFloatAd=function(t){var r,a,o,s,l,c=this;0!=this.mAdData.indexLeft.length&&(r=this.setPosition(this.mAdData.indexLeft,"浮动ICON",t,!0),a=[],o=this.mTempPoints||this.FormData.floatPositon,s=this.mTempTempletes||this.FormData.floatTempletes,l=m.randomNumBoth(0,r.length-1),o.forEach(function(t,o){var e=(l+o)%(r.length-1),n=r[e];a.push({appid:n.appid,position:n.position,index:e});var i=s.length-1>o?s[o]:s[0];console.log("initFloatAd",t.x,t.y),n.x=t.x,n.y=t.y,n.source=r,n.showIds=a,n.index=o,moosnow.form.formFactory.createNodeByTemplate(i,Qe,n,c.floatContainer)}),this.updateFloat(r),this.schedule(this.updateFloat,this.mFloatRefresh,[r]),this.floatRuning=!1)},qe.prototype.removeFloatAd=function(){this.floatContainer.children.forEach(function(t){t.stopAllActions()});var t=this.FormData.floatTempletes;this.mTempTempletes&&(t=t.concat(this.mTempTempletes)),t.forEach(function(t){moosnow.form.formFactory.hideNodeByTemplate(t,null)}),this.unschedule(this.updateFloat)},qe.prototype.floatAnim=function(){var t;this.floatRuning||(t=this.mTempTempletes||this.FormData.floatTempletes,this.floatContainer.childrenCount>=t.length&&(this.floatRuning=!0),this.floatContainer.children.forEach(function(t){t.stopAllActions(),t.runAction(cc.sequence(cc.rotateTo(.3,10),cc.rotateTo(.6,-10),cc.rotateTo(.3,0),cc.scaleTo(.3,.8),cc.scaleTo(.3,1)).repeatForever())}))},qe.prototype.updateFloat=function(t){var e=this,n=this.mTempTempletes||this.FormData.floatTempletes;this.floatContainer.children.forEach(function(o){n.forEach(function(t){moosnow.form.formFactory.getKVsByName(t).forEach(function(t){t.formNode==o&&(t.formLogic.FormData.index=(t.formLogic.FormData.index+e.floatContainer.childrenCount)%(e.mAdData.indexLeft.length-1),t.formLogic.refreshImg(c(c({},e.mAdData.indexLeft[t.formLogic.FormData.index]),{onCancel:t.formLogic.FormData.onCancel})))})})})},qe.prototype.initFiexdView=function(e,t,n,o){if(this.mAdData){e.removeAllChildren();for(var i=this.setPosition(this.mAdData.indexLeft,t,o,!0),r=[],a=[],s=0;s<8;s++){var l=i.length>s?i[s]:i[0];a.push({appid:l.appid,position:l.position,index:s}),r.push(l)}r.forEach(function(t){var o=c(c({},t),{showIds:a,source:i});moosnow.form.formFactory.createNodeByTemplate(n,Qe,o,e)})}},qe.prototype.initView=function(t,e,o,n,i,r){this.hideAllAdNode(n,e),(r=r||this.setPosition(this.mAdData.indexLeft,o,i)).forEach(function(t,o){moosnow.form.formFactory.createNodeByTemplate(n,Qe,t,e)}),this.pushScroll(t,e.getComponent(cc.Layout))},qe.prototype.hideAllAdNode=function(t,o){if(o)for(var e=0;e<o.childrenCount;e++)moosnow.form.formFactory.hideNodeByTemplate(t,o.children[e]),e--},qe.prototype.onFwUpdate=function(){this.floatAnim(),this.scrollMove()},qe.prototype.scrollMove=function(){for(var t=0;t<this.mScrollVec.length;t++){var o,e,n,i,r=this.mScrollVec[t],a=r.scrollView;a.isScrolling()||(e=(o=a.getMaxScrollOffset()).y/2+20,n=o.x/2+20,i=a.getContentPosition(),1==r.move2Up?(i.y>e&&(r.move2Up=!1),r.scrollView.setContentPosition(new cc.Vec2(i.x,i.y+this.mMoveSpeed))):0==r.move2Up&&(i.y<-e&&(r.move2Up=!0),r.scrollView.setContentPosition(new cc.Vec2(i.x,i.y-this.mMoveSpeed))),1==r.move2Left?(i.x>n&&(r.move2Left=!1),r.scrollView.setContentPosition(new cc.Vec2(i.x+this.mMoveSpeed,i.y))):0==r.move2Left&&(i.x<-n&&(r.move2Left=!0),r.scrollView.setContentPosition(new cc.Vec2(i.x-this.mMoveSpeed,i.y))))}},qe.prototype.willShow=function(t){je.prototype.willShow.call(this,t),this.floatRuning=!1,this.addListener(),this.mAdItemList=[],this.mScrollVec=[],this.displayChange(t.showAd,t.callback)},qe.prototype.willHide=function(){je.prototype.willShow.call(this),this.removeListener(),this.unschedule(this.onFwUpdate)},qe.prototype.displayChange=function(t,o){void 0===o&&(o=null),this.mShowAd=t,this.displayAd(!0),this.mBackCall=o},qe.prototype.displayAd=function(t){var o=this;this.endContainer.active=t&&this.hasAd(eo.EXPORT_FIXED),this.endContainer.active&&this.initEnd(),this.bannerContainer.active=t&&this.hasAd(eo.BANNER),this.topContainer.active=t&&this.hasAd(eo.TOP),this.floatContainer.active=t&&this.hasAd(eo.FLOAT),this.floatContainer.active&&this.initFloatAd(this.onAdCancel),this.floatContainer.active||this.removeFloatAd(),this.leftContainer.active=this.rightContainer.active=t&&this.hasAd(eo.LEFTRIGHT),this.exportContainer.active=t&&this.hasAd(eo.EXPORT),this.rotateContainer.active=t&&this.hasAd(eo.ROTATE),this.rotateContainer.active&&this.initRotate(this.initRotate),this.rotateContainer.active||this.disableRotate(),this.formMask.active=t&&this.hasAd(eo.MASK),t&&this.hasAd(eo.EXPORT)&&moosnow.http.getAllConfig(function(t){1==t.exportAutoNavigate&&moosnow.platform.navigate2Mini(o.mAdData.indexLeft[m.randomNumBoth(0,o.mAdData.indexLeft.length-1)])}),this.showClose(t)},qe.prototype.onShow=function(t){var o=this;je.prototype.onShow.call(this,t),moosnow.http.getAllConfig(function(t){t&&(isNaN(t.adScrollViewSpeed)||(o.mMoveSpeed=parseFloat(t.adScrollViewSpeed)))}),this.loadAd(function(){o.schedule(o.onFwUpdate,.016),o.initBanner(),o.initExport(),o.initTop(),o.initLeftRight(),o.FormData&&o.FormData.callback&&o.FormData.callback()})},qe.prototype.initBanner=function(){var t=this.bannerContainer_layout.getComponent(cc.Layout),o=this.bannerContainer_scroll.getComponent(cc.ScrollView);t.type=cc.Layout.Type.HORIZONTAL,t.resizeMode=cc.Layout.ResizeMode.CONTAINER,this.initView(o,this.bannerContainer_layout,"banner","bannerAdItem",this.onAdCancel)},qe.prototype.initTop=function(){var t=this.topContainer_layout.getComponent(cc.Layout),o=this.topContainer_scroll.getComponent(cc.ScrollView);t.type=cc.Layout.Type.HORIZONTAL,t.resizeMode=cc.Layout.ResizeMode.CONTAINER,this.initView(o,this.topContainer_layout,"top","bannerAdItem",this.onAdCancel)},qe.prototype.initLeftRight=function(){var t=m.deepCopy(this.mAdData.indexLeft),o=t.length/2,e=t.slice(0,o),n=t.slice(o,t.length),i=this.leftContainer_layout.getComponent(cc.Layout);i.type=cc.Layout.Type.VERTICAL,i.resizeMode=cc.Layout.ResizeMode.CONTAINER;var r=this.rightContainer_layout.getComponent(cc.Layout);r.type=cc.Layout.Type.VERTICAL,r.resizeMode=cc.Layout.ResizeMode.CONTAINER;var a=this.leftContainer_scroll.getComponent(cc.ScrollView);a.horizontal=!1,a.vertical=!0;var s=this.rightContainer_scroll.getComponent(cc.ScrollView);s.horizontal=!1,s.vertical=!0;var l=this.setPosition(n,"left",this.onAdCancel),c=this.setPosition(e,"right",this.onAdCancel);this.initView(a,this.leftContainer_layout,"left","leftAdItem",this.onAdCancel,l),this.initView(s,this.rightContainer_layout,"right","leftAdItem",this.onAdCancel,c)},qe.prototype.initEnd=function(){var t=this.endContainer_layout.getComponent(cc.Layout);t.type=cc.Layout.Type.GRID,t.resizeMode=cc.Layout.ResizeMode.NONE,this.initFiexdView(this.endContainer_layout,"8个固定大导出","fiexdAdItem",this.onAdCancel)},qe.prototype.initExport=function(){var t=this.exportContainer_layout.getComponent(cc.Layout),o=this.exportContainer_scroll.getComponent(cc.ScrollView);t.type=cc.Layout.Type.GRID,t.resizeMode=cc.Layout.ResizeMode.CONTAINER,this.initView(o,this.exportContainer_layout,"大导出","exportAdItem")},qe.prototype.disableRotate=function(){moosnow.form.formFactory.hideNodeByTemplate("rotateAdItem",null)},qe.prototype.initRotate=function(t){var h,d,p=this;this.mAdData&&(h=this.setPosition(this.mAdData.indexLeft,"旋转导出",t,!0),m.randomNumBoth(0,h.length-1),d="rotateAdItem",moosnow.form.formFactory.getTemplate(d,function(t){for(var o=t.width/2,e=t.height/2,n=[{x:-o-15,y:15+e},{x:15+o,y:15+e},{x:-o-15,y:-e-15},{x:15+o,y:-e-15}],i=[],r=[],a=0;a<4&&0!=h.length;a++){var s=m.randomNumBoth(0,h.length-1),l=h.splice(s,1)[0];l.x=n[a].x,l.y=n[a].y,i.push({appid:l.appid,position:l.position,index:a}),r.push(l)}r.forEach(function(t){t.source=h,t.showIds=i,moosnow.form.formFactory.createNodeByTemplate(d,Qe,t,p.rotateContainer_layout)});var c=Mo.canvasNode.width/2/800;p.rotateContainer_layout.children.forEach(function(t,o){t.x=n[o].x-Mo.canvasNode.width/2,t.stopAllActions(),t.runAction(cc.spawn(cc.moveTo(c,new cc.Vec2(n[o].x,n[o].y)),cc.rotateBy(c,360)))})}))},qe.prototype.disableAd=function(){this.unschedule(this.onFwUpdate)},qe);function qe(){var t=null!==je&&je.apply(this,arguments)||this;return t.endContainer=null,t.endContainer_layout=null,t.exportContainer=null,t.exportContainer_scroll=null,t.exportContainer_layout=null,t.exportClose=null,t.formMask=null,t.exportCloseTxt=null,t.btnBack=null,t.floatContainer=null,t.floatFull=null,t.bannerContainer=null,t.bannerContainer_scroll=null,t.bannerContainer_layout=null,t.topContainer=null,t.topContainer_scroll=null,t.topContainer_layout=null,t.leftContainer=null,t.leftContainer_scroll=null,t.leftContainer_layout=null,t.rightContainer=null,t.rightContainer_scroll=null,t.rightContainer_layout=null,t.rotateContainer=null,t.rotateContainer_layout=null,t.sideContainer=null,t.sideView=null,t.sideLayout=null,t.btnSideShow=null,t.btnSideHide=null,t.mShowAd=eo.NONE,t.mPrevShowAd=eo.NONE,t.mScrollVec=[],t.mEndLogic=[],t.mMoveSpeed=2,t.mFloatIndex=0,t.mFloatRefresh=3,t.mFloatCache={},t.loadNum=0,t.loadManNum=3,t.mSecond=3,t.mAdItemList=[],t.floatRuning=!1,t}var Ke=(Xe.create=function(t){return new t},Object.defineProperty(Xe.prototype,"hideForm",{get:function(){return this._hideForm},set:function(t){this._hideForm=t},enumerable:!0,configurable:!0}),Xe);function Xe(){this._hideForm=!0,this.extraData={},this.zIndex=0}var Ze,Ye=(t(Je,Ze=Ke),Je);function Je(){var t=null!==Ze&&Ze.apply(this,arguments)||this;return t.floatPositon=[],t.floatTempletes=["floatAdItem1"],t}var $e,tn=(t(on,$e=Ye),on);function on(){var t=null!==$e&&$e.apply(this,arguments)||this;return t.floatPositon=[],t.floatTempletes=["floatAdItem1"],t.adType=eo.NONE,t.zIndex=cc.macro.MAX_ZINDEX,t.pointName="",t.formName="loadingForm",t}var en,nn=(t(rn,en=ie),Object.defineProperty(rn.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),rn.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnCancel,function(){t.hideForm()}),this.applyClickAnim(this.btnVideo,function(){t.onVideo()}),this.applyClickAnim(this.btnReceive,function(){t.onReceive()}),this.applyClickAnim(this.btnShare,function(){t.onShare()})},rn.prototype.removeListener=function(){this.removeClickAnim(this.btnCancel),this.removeClickAnim(this.btnVideo),this.removeClickAnim(this.btnReceive),this.removeClickAnim(this.btnShare)},rn.prototype.willShow=function(t){en.prototype.willShow.call(this,t),this.addListener(),this.mTotalSecond=10,this.mCurrentSecond=0,this.FormData&&this.FormData.logo&&Mo.changeSrc(this.logo,{url:this.FormData.logo,width:this.logo.width,height:this.logo.height}),this.resumeCountdown(),moosnow.platform.showBanner(!1)},rn.prototype.willHide=function(t){en.prototype.willShow.call(this,t),this.removeListener()},rn.prototype.onCountdown=function(){this.mCurrentSecond+=1;var t=this.mTotalSecond-this.mCurrentSecond;if(t<0)return this.unschedule(this.onCountdown),void this.hideForm();Mo.changeText(this.txtCountdown,t+"秒")},rn.prototype.stopCountdown=function(){this.unschedule(this.onCountdown)},rn.prototype.resumeCountdown=function(){this.schedule(this.onCountdown,1)},rn.prototype.onShare=function(){var o=this;this.stopCountdown(),moosnow.platform.share({channel:""},function(t){o.resumeCountdown()})},rn.prototype.onVideo=function(){var o=this;this.stopCountdown(),moosnow.platform.showVideo(function(t){t!=y.END&&(t==moosnow.VIDEO_STATUS.ERR?moosnow.form.showToast(zt.ERR):moosnow.form.showToast(zt.NOTEND),o.resumeCountdown())})},rn.prototype.onReceive=function(){this.mChecked&&this.onVideo()},rn);function rn(){var o=null!==en&&en.apply(this,arguments)||this;return o.btnCancel=null,o.txtCountdown=null,o.btnVideo=null,o.btnShare=null,o.btnReceive=null,o.logo=null,o.mChecked=!0,o.formComponents=[new we(o.mChecked,function(t){o.mChecked=t})],o.mTotalSecond=10,o.mCurrentSecond=0,o}var an=(sn.ToastForm="toastForm",sn.AdForm="adForm",sn.MistouchForm="mistouchForm",sn.PrizeForm="prizeForm",sn.TotalForm="totalForm",sn.EndForm="endForm",sn.RespawnForm="respawnForm",sn.FailForm="failForm",sn.PauseForm="pauseForm",sn.ShareForm="shareForm",sn.TryForm="tryForm",sn.SetForm="setForm",sn.BoxForm="boxForm",sn.NativeForm="nativeForm",sn);function sn(){}var ln,cn=(t(hn,ln=ie),Object.defineProperty(hn.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),hn.prototype.onShow=function(t){var o=this;ln.prototype.onShow.call(this,t),this.node.zIndex=cc.macro.MAX_ZINDEX,this.addListener(),console.log("显示原生广告"),moosnow.platform.hideBanner(),moosnow.platform.showNativeAd(function(t){console.log("原生广告",t),t&&t.imgUrlList&&0<t.imgUrlList.length?(o.node.active=!0,6==t.creativeType?o.baseBox.height=o.baseBox.width/2:o.baseBox.height=.65625*o.baseBox.width,Mo.changeText(o.txtMemo,t.desc),Mo.changeSrc(o.logo,{url:t.imgUrlList[0],width:o.logo.width,height:o.logo.height})):(o.FormData&&o.FormData.nullCallback&&o.FormData.nullCallback(),moosnow.platform.showBanner(!1))}),moosnow.http.getAllConfig(function(t){t&&1==t.smallNativeAdClose&&(o.btnTopClose.scale=.7),t&&1==t.zs_native_click_switch?(o.btnOpen.active=!0,o.btnClose.active=!1):(o.btnOpen.active=!1,o.btnClose.active=!0)})},hn.prototype.willHide=function(t){this.remoteListener(),ln.prototype.willHide.call(this,t)},hn.prototype.addListener=function(){var t=this;this.applyClickAnim(this.logo,function(){t.onOpenAd()}),this.applyClickAnim(this.btnOpen,function(){t.onOpenAd()}),this.applyClickAnim(this.btnTopClose,function(){t.onCloseAd()}),this.applyClickAnim(this.btnClose,function(){t.onCloseAd()})},hn.prototype.remoteListener=function(){this.removeClickAnim(this.logo),this.removeClickAnim(this.btnOpen),this.removeClickAnim(this.btnTopClose),this.removeClickAnim(this.btnClose)},hn.prototype.onCloseAd=function(){this.FormData&&this.FormData.callback&&this.FormData.callback(),this.hideForm()},hn.prototype.onOpenAd=function(){var t=this;moosnow.platform.clickNative(function(){t.hideForm()})},hn);function hn(){var t=null!==ln&&ln.apply(this,arguments)||this;return t.baseBox=null,t.logo=null,t.btnTopClose=null,t.btnClose=null,t.btnOpen=null,t.txtMemo=null,t}var dn,pn=(t(mn,dn=ie),Object.defineProperty(mn.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),mn.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnVideo,function(){t.onVideoTry()}),this.applyClickAnim(this.btnHome,function(){t.onHome()})},mn.prototype.removeListener=function(){this.removeClickAnim(this.btnVideo),this.removeClickAnim(this.btnHome)},mn.prototype.onShow=function(t){dn.prototype.onShow.call(this,t),this.addListener()},mn.prototype.onHide=function(t){dn.prototype.onHide.call(this,t),this.removeListener()},mn.prototype.onVideoTry=function(){var o=this;moosnow.platform.showVideo(function(t){t==y.END?(o.hideForm(),o.FormData.videoCallback&&o.FormData.videoCallback()):t==y.ERR?moosnow.form.showToast(zt.ERR):t==y.NOTEND&&moosnow.form.showToast(zt.NOTEND)})},mn.prototype.onHome=function(){this.hideForm(),this.FormData.callback&&this.FormData.callback()},mn);function mn(){var t=null!==dn&&dn.apply(this,arguments)||this;return t.btnVideo=null,t.btnHome=null,t}var un,fn=(t(wn,un=ie),Object.defineProperty(wn.prototype,"FormData",{get:function(){return this.mFormData},enumerable:!0,configurable:!0}),wn.prototype.addListener=function(){var t=this;this.applyClickAnim(this.btnBack,function(){t.onBack()}),this.applyClickAnim(this.btnVideo,function(){t.onVideo()})},wn.prototype.removeListener=function(){this.removeClickAnim(this.btnBack)},wn.prototype.onVideo=function(){var o=this;moosnow.platform.showVideo(function(t){t==y.END?(o.hideForm(),o.FormData.videoCallback&&o.FormData.videoCallback()):t==y.ERR?moosnow.form.showToast(zt.ERR):t==y.NOTEND&&moosnow.form.showToast(zt.NOTEND)})},wn.prototype.onShow=function(t){this.addListener()},wn.prototype.willHide=function(){this.removeListener()},wn.prototype.onBack=function(){this.hideForm(),this.FormData.callback&&this.FormData.callback()},wn);function wn(){var t=null!==un&&un.apply(this,arguments)||this;return t.btnBack=null,t.btnVideo=null,t}var gn=function(t,o,e){this.name="",this.formData=null,this.parent=null,this.remoteLayout=!0,this.layoutOptions=null,this.showOnce=!0,this.name=t,this.formLogic=o,this.formData=e},vn=(yn.prototype.initCheckboxState=function(t,o){void 0===t&&(t=!0),this.mCheckbox=new we(t,o),this.mCheckbox.onShow(null)},yn.prototype.checkboxToggle=function(){this.mCheckbox.checkToggle()},yn.prototype.applyClickAnim=function(t,o,e,n){void 0===e&&(e=!1),void 0===n&&(n=!0),this.mBaseForm.applyClickAnim(t,o,e,n)},yn.prototype.removeClickAnim=function(t){this.mBaseForm.removeClickAnim(t)},yn.prototype.showToast=function(t){this.formFactory.showForm(new gn(an.ToastForm,Ne,t))},yn.prototype.showNativeAd=function(t){this.formFactory.showForm(new gn(an.NativeForm,cn,t))},yn.prototype.loadAd=function(t){var o=new gn(an.AdForm,Ge,c(c({},new Ye),t));o.callback=function(t){console.log("create ad form")},this.formFactory.showForm(o)},yn.prototype.showAd=function(t,o,e,n,i,r,a){void 0===t&&(t=eo.NONE),void 0===i&&(i=cc.macro.MAX_ZINDEX),void 0===r&&(r=""),void 0===a&&(a="loadingForm");var s=new tn;s.adType=t,s.zIndex=i,s.floatPositon=e,s.floatTempletes=n,s.pointName=r,s.formName=a,s.callback=o,this.showAd2(s)},yn.prototype.showAd2=function(t){moosnow.event.sendEventImmediately(b.AD_VIEW_CHANGE,{showAd:t.adType,zIndex:t.zIndex,points:t.floatPositon,templetes:t.floatTempletes,pointName:t.pointName,formName:t.formName,callback:t.callback})},yn.prototype.hideAd=function(t){moosnow.event.sendEventImmediately(b.AD_VIEW_CHANGE,{showAd:eo.NONE,callback:t})},yn.prototype.showCoin=function(t){},yn.prototype.showMistouch=function(t){this.formFactory.showForm(new gn(an.MistouchForm,He,t))},yn.prototype.showPrize=function(t){this.formFactory.showForm(new gn(an.PrizeForm,nn,t))},yn.prototype.showTotal=function(t){this.formFactory.showForm(new gn(an.TotalForm,ye,t))},yn.prototype.showEnd=function(t){this.formFactory.showForm(new gn(an.EndForm,se,t))},yn.prototype.showRespawn=function(t){this.formFactory.showForm(new gn(an.RespawnForm,pn,t))},yn.prototype.showFail=function(t){this.formFactory.showForm(new gn(an.FailForm,fn,t))},yn.prototype.showPause=function(t){this.formFactory.showForm(new gn(an.PauseForm,he,t))},yn.prototype.showShare=function(t){this.formFactory.showForm(new gn(an.ShareForm,Pe,t))},yn.prototype.showTry=function(t){this.formFactory.showForm(new gn(an.TryForm,Ie,t))},yn.prototype.showSet=function(t){this.formFactory.showForm(new gn(an.SetForm,ke,t))},yn.prototype.showBox=function(t){this.formFactory.showForm(new gn(an.BoxForm,xe,t))},yn.prototype.createForm=function(t){this.formFactory.showForm(new gn(t,ie,{}))},yn.prototype.hideForm=function(t){this.formFactory.hideForm(t,null)},yn);function yn(){this.mBaseForm=new ie,this.formFactory=new oe}var bn,Cn=(t(Nn,bn=X),Nn.prototype.showBanner=function(t,o,e,n,i,r){void 0===t&&(t=!0),void 0===e&&(e=f.CENTER),void 0===n&&(n=g.BOTTOM),void 0===i&&(i=-1)},Nn.prototype.createRewardAD=function(t,o){var e=this;if(void 0===o&&(o=0),!this.videoLoading)if(window[this.platformName])if(window[this.platformName].createRewardedVideoAd){var n=this.getVideoId(o);if(m.isEmpty(n))return console.warn(E),void(moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END));if(!this.video[n]){if(console.log(" HWModule ~ createRewardAD ~ videoId",n),this.video[n]=window[this.platformName].createRewardedVideoAd({adUnitId:n}),!this.video[n])return void console.warn("创建视频广告失败");this.video[n].onError(this._onVideoError),this.video[n].onClose(this._onVideoClose),this.video[n].onLoad(function(){moosnow.platform.videoLoading=!1,e.video[n]&&e.video[n].show()})}moosnow.platform.videoLoading=!0,moosnow.platform.videoPlaying=!1,this.video[n].load()}else moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END);else moosnow.platform.videoCb&&moosnow.platform.videoCb(y.END)},Nn.prototype._onVideoError=function(t){console.warn(O,JSON.stringify(t))},Nn.prototype.showNativeAd=function(t){var o,e=this;this.native||this._prepareNative(!0),this.nativeCb=t,!this.native||(o=this.native.load())&&o.then(function(){console.log("原生广告加载完成")}).catch(function(t){console.log("原生广告加载失败"),moosnow.http.getAllConfig(function(t){1==t.nativeErrorShowInter?(console.log("原生加载出错，用插屏代替"),e.nativeCb(null),e.showInter()):e.nativeCb(null)})})},Nn.prototype._prepareNative=function(t){var o;void 0===t&&(t=!1),window[this.platformName]&&window[this.platformName].createNativeAd&&(this.native||(o=this.nativeId[this.nativeIdIndex],console.log(" HWModule ~ _prepareNative ~ adUnitId",o),this.native=window[this.platformName].createNativeAd({adUnitId:o,success:function(t){console.log("_prepareNative loadNativeAd : success",t)},fail:function(t,o){console.log("_prepareNative loadNativeAd fail: "+t+","+o)}}),this.native.onLoad(this._onNativeLoad.bind(this)),this.native.onError(this._onNativeError.bind(this))))},Nn.prototype._onNativeLoad=function(t){var o=this;console.log(" HWModule ~ _onNativeLoad ~ res",JSON.stringify(t)),this.nativeLoading=!1,console.log(F,t),t&&t.adList&&0<t.adList.length?(this.nativeAdResult=t.adList[t.adList.length-1],m.isEmpty(this.nativeAdResult.adId)||(console.log(M),console.log("HWModule ~ _onNativeLoad ~ reportAdShow ",this.nativeAdResult.adId),this.native.reportAdShow({adId:this.nativeAdResult.adId})),m.isFunction(this.nativeCb)&&this.nativeCb(m.deepCopy(this.nativeAdResult))):(console.log(V),m.isFunction(this.nativeCb)&&moosnow.http.getAllConfig(function(t){1==t.nativeErrorShowInter?(console.log("原生加载出错，用插屏代替"),o.showInter()):o.nativeCb(null)}))},Nn.prototype._onNativeError=function(t){var o=this;this.nativeLoading=!1,this.nativeAdResult=null,20003==t.code?this.nativeIdIndex<this.nativeId.length-1?(console.log(x,t),this.nativeIdIndex+=1,this._destroyNative()):(console.log(D),this.nativeIdIndex=0):console.log(R,t),moosnow.http.getAllConfig(function(t){1==t.nativeErrorShowInter?(console.log("原生加载出错，用插屏代替"),o.showInter()):o.nativeCb&&o.nativeCb(null)})},Nn.prototype.clickNative=function(t){this.nativeAdResult&&!m.isEmpty(this.nativeAdResult.adId)&&(this.mClickedNativeCallback=t,this.mIsClickedNative=!0,console.log(P,this.nativeAdResult.adId),this.native.reportAdClick({adId:this.nativeAdResult.adId}))},Nn);function Nn(){var t=null!==bn&&bn.apply(this,arguments)||this;return t.platformName="hbs",t.mIsClickedNative=!1,t}var An=(Sn.getAppPlatform=function(){return m.platform},Sn.appConfig=function(){return m.config},Object.defineProperty(Sn,"platform",{get:function(){return this.mPlatform||(m.platform==r.WX?this.mPlatform=new J:m.platform==r.OPPO?this.mPlatform=new lt:m.platform==r.VIVO?this.mPlatform=new $t:m.platform==r.OPPO_ZS?this.mPlatform=new Rt:m.platform==r.BYTEDANCE?this.mPlatform=new It:m.platform==r.QQ?this.mPlatform=new kt:m.platform==r.BAIDU?this.mPlatform=new Mt:m.platform==r.UC?this.mPlatform=new co:m.platform==r.HW?this.mPlatform=new Cn:this.mPlatform=new X),this.mPlatform},enumerable:!0,configurable:!0}),Object.defineProperty(Sn,"ad",{get:function(){return Sn.mAd||(m.platform==r.WX||m.platform==r.PC||m.platform==r.BYTEDANCE?Sn.mAd=new bt:m.platform==r.OPPO?Sn.mAd=new gt:m.platform==r.OPPO_ZS?Sn.mAd=new Ot:Sn.mAd=new ot),Sn.mAd},enumerable:!0,configurable:!0}),Object.defineProperty(Sn,"http",{get:function(){return this.mHttp||(m.platform!=r.WX&&m.platform==r.OPPO_ZS?this.mHttp=new Ut:this.mHttp=new rt),this.mHttp},enumerable:!0,configurable:!0}),Sn.VIDEO_STATUS=y,Sn.VIDEO_MSG=zt,Sn.SHARE_MSG=Qt,Sn.BANNER_HORIZONTAL=f,Sn.BANNER_VERTICAL=g,Sn.BLOCK_HORIZONTAL=z,Sn.BLOCK_VERTICAL=G,Sn.SHARE_CHANNEL=At,Sn.APP_PLATFORM=r,Sn.PLATFORM_EVENT=b,Sn.Common=m,Sn.AD_POSITION=eo,Sn.data=new dt,Sn.resource=new no,Sn.setting=new ut,Sn.event=new Kt,Sn.audio=new ao,Sn.form=new vn,Sn.nodeHelper=Mo,Sn);function Sn(){}return window.moosnow=An}();
